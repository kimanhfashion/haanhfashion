!function(){var e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(t){function n(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=Object.create(e.prototype);for(var a in n)i[a]=n[a];return i.constructor=t,t.prototype=i,t}function i(e){e=e||{},this.defaultProtocol=e.hasOwnProperty("defaultProtocol")?e.defaultProtocol:c.defaultProtocol,this.events=e.hasOwnProperty("events")?e.events:c.events,this.format=e.hasOwnProperty("format")?e.format:c.format,this.formatHref=e.hasOwnProperty("formatHref")?e.formatHref:c.formatHref,this.nl2br=e.hasOwnProperty("nl2br")?e.nl2br:c.nl2br,this.tagName=e.hasOwnProperty("tagName")?e.tagName:c.tagName,this.target=e.hasOwnProperty("target")?e.target:c.target,this.validate=e.hasOwnProperty("validate")?e.validate:c.validate,this.ignoreTags=[],this.attributes=e.attributes||e.linkAttributes||c.attributes,this.className=e.hasOwnProperty("className")?e.className:e.linkClass||c.className;for(var t=e.hasOwnProperty("ignoreTags")?e.ignoreTags:c.ignoreTags,n=0;n<t.length;n++)this.ignoreTags.push(t[n].toUpperCase())}function a(e){return e}function o(e,t,n,i){for(var a=0,o=e.length,s=t,r=[],c=void 0;a<o&&(c=s.next(e[a]));)s=c,a++;if(a>=o)return[];for(;a<o-1;)c=new d(i),r.push(c),s.on(e[a],c),s=c,a++;return c=new d(n),r.push(c),s.on(e[o-1],c),r}function s(e){return n(f,(function(e){e&&(this.v=e)}),e?{v:e}:{})}function r(e){return e instanceof p||e instanceof N}var c={defaultProtocol:"http",events:null,format:a,formatHref:a,nl2br:!1,tagName:"a",target:function(e,t){return"url"===t?"_blank":null},validate:!0,ignoreTags:[],attributes:null,className:"linkified"};i.prototype={resolve:function(e){var t=e.toHref(this.defaultProtocol);return{formatted:this.get("format",e.toString(),e),formattedHref:this.get("formatHref",t,e),tagName:this.get("tagName",t,e),className:this.get("className",t,e),target:this.get("target",t,e),events:this.getObject("events",t,e),attributes:this.getObject("attributes",t,e)}},check:function(e){return this.get("validate",e.toString(),e)},get:function(t,n,i){var a=void 0,o=this[t];if(!o)return o;switch(void 0===o?"undefined":e(o)){case"function":return o(n,i.type);case"object":return"function"==typeof(a=o.hasOwnProperty(i.type)?o[i.type]:c[t])?a(n,i.type):a}return o},getObject:function(e,t,n){var i=this[e];return"function"==typeof i?i(t,n.type):i}};var l=Object.freeze({defaults:c,Options:i,contains:function(e,t){for(var n=0;n<e.length;n++)if(e[n]===t)return!0;return!1}}),h=function(e){this.j=[],this.T=e||null};h.prototype={defaultTransition:!1,on:function(e,t){if(e instanceof Array){for(var n=0;n<e.length;n++)this.j.push([e[n],t]);return this}return this.j.push([e,t]),this},next:function(e){for(var t=0;t<this.j.length;t++){var n=this.j[t],i=n[0],a=n[1];if(this.test(e,i))return a}return this.defaultTransition},accepts:function(){return!!this.T},test:function(e,t){return e===t},emit:function(){return this.T}};var d=n(h,(function(e){this.j=[],this.T=e||null}),{test:function(e,t){return e===t||t instanceof RegExp&&t.test(e)}}),u=n(h,(function(e){this.j=[],this.T=e||null}),{jump:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=this.next(new e(""));return n===this.defaultTransition?(n=new this.constructor(t),this.on(e,n)):t&&(n.T=t),n},test:function(e,t){return e instanceof t}}),f=function(e){e&&(this.v=e)};f.prototype={toString:function(){return this.v+""}};var p=s(),g=s("@"),m=s(":"),_=s("."),C=s(),y=s(),v=s("\n"),b=s(),w=s("+"),k=s("#"),E=s(),L=s("mailto:"),x=s("?"),S=s("/"),T=s("_"),A=s(),N=s(),O=s(),M=s("{"),I=s("["),R=s("<"),P=s("("),D=s("}"),j=s("]"),B=s(">"),F=s(")"),H=s("&"),q=Object.freeze({Base:f,DOMAIN:p,AT:g,COLON:m,DOT:_,PUNCTUATION:C,LOCALHOST:y,NL:v,NUM:b,PLUS:w,POUND:k,QUERY:x,PROTOCOL:E,MAILTO:L,SLASH:S,UNDERSCORE:T,SYM:A,TLD:N,WS:O,OPENBRACE:M,OPENBRACKET:I,OPENANGLEBRACKET:R,OPENPAREN:P,CLOSEBRACE:D,CLOSEBRACKET:j,CLOSEANGLEBRACKET:B,CLOSEPAREN:F,AMPERSAND:H}),U="aaa|aarp|abarth|abb|abbott|abbvie|abc|able|abogado|abudhabi|ac|academy|accenture|accountant|accountants|aco|active|actor|ad|adac|ads|adult|ae|aeg|aero|aetna|af|afamilycompany|afl|africa|ag|agakhan|agency|ai|aig|aigo|airbus|airforce|airtel|akdn|al|alfaromeo|alibaba|alipay|allfinanz|allstate|ally|alsace|alstom|am|americanexpress|americanfamily|amex|amfam|amica|amsterdam|analytics|android|anquan|anz|ao|aol|apartments|app|apple|aq|aquarelle|ar|arab|aramco|archi|army|arpa|art|arte|as|asda|asia|associates|at|athleta|attorney|au|auction|audi|audible|audio|auspost|author|auto|autos|avianca|aw|aws|ax|axa|az|azure|ba|baby|baidu|banamex|bananarepublic|band|bank|bar|barcelona|barclaycard|barclays|barefoot|bargains|baseball|basketball|bauhaus|bayern|bb|bbc|bbt|bbva|bcg|bcn|bd|be|beats|beauty|beer|bentley|berlin|best|bestbuy|bet|bf|bg|bh|bharti|bi|bible|bid|bike|bing|bingo|bio|biz|bj|black|blackfriday|blanco|blockbuster|blog|bloomberg|blue|bm|bms|bmw|bn|bnl|bnpparibas|bo|boats|boehringer|bofa|bom|bond|boo|book|booking|boots|bosch|bostik|boston|bot|boutique|box|br|bradesco|bridgestone|broadway|broker|brother|brussels|bs|bt|budapest|bugatti|build|builders|business|buy|buzz|bv|bw|by|bz|bzh|ca|cab|cafe|cal|call|calvinklein|cam|camera|camp|cancerresearch|canon|capetown|capital|capitalone|car|caravan|cards|care|career|careers|cars|cartier|casa|case|caseih|cash|casino|cat|catering|catholic|cba|cbn|cbre|cbs|cc|cd|ceb|center|ceo|cern|cf|cfa|cfd|cg|ch|chanel|channel|chase|chat|cheap|chintai|chloe|christmas|chrome|chrysler|church|ci|cipriani|circle|cisco|citadel|citi|citic|city|cityeats|ck|cl|claims|cleaning|click|clinic|clinique|clothing|cloud|club|clubmed|cm|cn|co|coach|codes|coffee|college|cologne|com|comcast|commbank|community|company|compare|computer|comsec|condos|construction|consulting|contact|contractors|cooking|cookingchannel|cool|coop|corsica|country|coupon|coupons|courses|cr|credit|creditcard|creditunion|cricket|crown|crs|cruise|cruises|csc|cu|cuisinella|cv|cw|cx|cy|cymru|cyou|cz|dabur|dad|dance|data|date|dating|datsun|day|dclk|dds|de|deal|dealer|deals|degree|delivery|dell|deloitte|delta|democrat|dental|dentist|desi|design|dev|dhl|diamonds|diet|digital|direct|directory|discount|discover|dish|diy|dj|dk|dm|dnp|do|docs|doctor|dodge|dog|doha|domains|dot|download|drive|dtv|dubai|duck|dunlop|duns|dupont|durban|dvag|dvr|dz|earth|eat|ec|eco|edeka|edu|education|ee|eg|email|emerck|energy|engineer|engineering|enterprises|epost|epson|equipment|er|ericsson|erni|es|esq|estate|esurance|et|etisalat|eu|eurovision|eus|events|everbank|exchange|expert|exposed|express|extraspace|fage|fail|fairwinds|faith|family|fan|fans|farm|farmers|fashion|fast|fedex|feedback|ferrari|ferrero|fi|fiat|fidelity|fido|film|final|finance|financial|fire|firestone|firmdale|fish|fishing|fit|fitness|fj|fk|flickr|flights|flir|florist|flowers|fly|fm|fo|foo|food|foodnetwork|football|ford|forex|forsale|forum|foundation|fox|fr|free|fresenius|frl|frogans|frontdoor|frontier|ftr|fujitsu|fujixerox|fun|fund|furniture|futbol|fyi|ga|gal|gallery|gallo|gallup|game|games|gap|garden|gb|gbiz|gd|gdn|ge|gea|gent|genting|george|gf|gg|ggee|gh|gi|gift|gifts|gives|giving|gl|glade|glass|gle|global|globo|gm|gmail|gmbh|gmo|gmx|gn|godaddy|gold|goldpoint|golf|goo|goodhands|goodyear|goog|google|gop|got|gov|gp|gq|gr|grainger|graphics|gratis|green|gripe|grocery|group|gs|gt|gu|guardian|gucci|guge|guide|guitars|guru|gw|gy|hair|hamburg|hangout|haus|hbo|hdfc|hdfcbank|health|healthcare|help|helsinki|here|hermes|hgtv|hiphop|hisamitsu|hitachi|hiv|hk|hkt|hm|hn|hockey|holdings|holiday|homedepot|homegoods|homes|homesense|honda|honeywell|horse|hospital|host|hosting|hot|hoteles|hotels|hotmail|house|how|hr|hsbc|ht|htc|hu|hughes|hyatt|hyundai|ibm|icbc|ice|icu|id|ie|ieee|ifm|ikano|il|im|imamat|imdb|immo|immobilien|in|industries|infiniti|info|ing|ink|institute|insurance|insure|int|intel|international|intuit|investments|io|ipiranga|iq|ir|irish|is|iselect|ismaili|ist|istanbul|it|itau|itv|iveco|iwc|jaguar|java|jcb|jcp|je|jeep|jetzt|jewelry|jio|jlc|jll|jm|jmp|jnj|jo|jobs|joburg|jot|joy|jp|jpmorgan|jprs|juegos|juniper|kaufen|kddi|ke|kerryhotels|kerrylogistics|kerryproperties|kfh|kg|kh|ki|kia|kim|kinder|kindle|kitchen|kiwi|km|kn|koeln|komatsu|kosher|kp|kpmg|kpn|kr|krd|kred|kuokgroup|kw|ky|kyoto|kz|la|lacaixa|ladbrokes|lamborghini|lamer|lancaster|lancia|lancome|land|landrover|lanxess|lasalle|lat|latino|latrobe|law|lawyer|lb|lc|lds|lease|leclerc|lefrak|legal|lego|lexus|lgbt|li|liaison|lidl|life|lifeinsurance|lifestyle|lighting|like|lilly|limited|limo|lincoln|linde|link|lipsy|live|living|lixil|lk|loan|loans|locker|locus|loft|lol|london|lotte|lotto|love|lpl|lplfinancial|lr|ls|lt|ltd|ltda|lu|lundbeck|lupin|luxe|luxury|lv|ly|ma|macys|madrid|maif|maison|makeup|man|management|mango|map|market|marketing|markets|marriott|marshalls|maserati|mattel|mba|mc|mckinsey|md|me|med|media|meet|melbourne|meme|memorial|men|menu|meo|merckmsd|metlife|mg|mh|miami|microsoft|mil|mini|mint|mit|mitsubishi|mk|ml|mlb|mls|mm|mma|mn|mo|mobi|mobile|mobily|moda|moe|moi|mom|monash|money|monster|mopar|mormon|mortgage|moscow|moto|motorcycles|mov|movie|movistar|mp|mq|mr|ms|msd|mt|mtn|mtr|mu|museum|mutual|mv|mw|mx|my|mz|na|nab|nadex|nagoya|name|nationwide|natura|navy|nba|nc|ne|nec|net|netbank|netflix|network|neustar|new|newholland|news|next|nextdirect|nexus|nf|nfl|ng|ngo|nhk|ni|nico|nike|nikon|ninja|nissan|nissay|nl|no|nokia|northwesternmutual|norton|now|nowruz|nowtv|np|nr|nra|nrw|ntt|nu|nyc|nz|obi|observer|off|office|okinawa|olayan|olayangroup|oldnavy|ollo|om|omega|one|ong|onl|online|onyourside|ooo|open|oracle|orange|org|organic|origins|osaka|otsuka|ott|ovh|pa|page|panasonic|panerai|paris|pars|partners|parts|party|passagens|pay|pccw|pe|pet|pf|pfizer|pg|ph|pharmacy|phd|philips|phone|photo|photography|photos|physio|piaget|pics|pictet|pictures|pid|pin|ping|pink|pioneer|pizza|pk|pl|place|play|playstation|plumbing|plus|pm|pn|pnc|pohl|poker|politie|porn|post|pr|pramerica|praxi|press|prime|pro|prod|productions|prof|progressive|promo|properties|property|protection|pru|prudential|ps|pt|pub|pw|pwc|py|qa|qpon|quebec|quest|qvc|racing|radio|raid|re|read|realestate|realtor|realty|recipes|red|redstone|redumbrella|rehab|reise|reisen|reit|reliance|ren|rent|rentals|repair|report|republican|rest|restaurant|review|reviews|rexroth|rich|richardli|ricoh|rightathome|ril|rio|rip|rmit|ro|rocher|rocks|rodeo|rogers|room|rs|rsvp|ru|rugby|ruhr|run|rw|rwe|ryukyu|sa|saarland|safe|safety|sakura|sale|salon|samsclub|samsung|sandvik|sandvikcoromant|sanofi|sap|sapo|sarl|sas|save|saxo|sb|sbi|sbs|sc|sca|scb|schaeffler|schmidt|scholarships|school|schule|schwarz|science|scjohnson|scor|scot|sd|se|search|seat|secure|security|seek|select|sener|services|ses|seven|sew|sex|sexy|sfr|sg|sh|shangrila|sharp|shaw|shell|shia|shiksha|shoes|shop|shopping|shouji|show|showtime|shriram|si|silk|sina|singles|site|sj|sk|ski|skin|sky|skype|sl|sling|sm|smart|smile|sn|sncf|so|soccer|social|softbank|software|sohu|solar|solutions|song|sony|soy|space|spiegel|spot|spreadbetting|sr|srl|srt|st|stada|staples|star|starhub|statebank|statefarm|statoil|stc|stcgroup|stockholm|storage|store|stream|studio|study|style|su|sucks|supplies|supply|support|surf|surgery|suzuki|sv|swatch|swiftcover|swiss|sx|sy|sydney|symantec|systems|sz|tab|taipei|talk|taobao|target|tatamotors|tatar|tattoo|tax|taxi|tc|tci|td|tdk|team|tech|technology|tel|telecity|telefonica|temasek|tennis|teva|tf|tg|th|thd|theater|theatre|tiaa|tickets|tienda|tiffany|tips|tires|tirol|tj|tjmaxx|tjx|tk|tkmaxx|tl|tm|tmall|tn|to|today|tokyo|tools|top|toray|toshiba|total|tours|town|toyota|toys|tr|trade|trading|training|travel|travelchannel|travelers|travelersinsurance|trust|trv|tt|tube|tui|tunes|tushu|tv|tvs|tw|tz|ua|ubank|ubs|uconnect|ug|uk|unicom|university|uno|uol|ups|us|uy|uz|va|vacations|vana|vanguard|vc|ve|vegas|ventures|verisign|versicherung|vet|vg|vi|viajes|video|vig|viking|villas|vin|vip|virgin|visa|vision|vista|vistaprint|viva|vivo|vlaanderen|vn|vodka|volkswagen|volvo|vote|voting|voto|voyage|vu|vuelos|wales|walmart|walter|wang|wanggou|warman|watch|watches|weather|weatherchannel|webcam|weber|website|wed|wedding|weibo|weir|wf|whoswho|wien|wiki|williamhill|win|windows|wine|winners|wme|wolterskluwer|woodside|work|works|world|wow|ws|wtc|wtf|xbox|xerox|xfinity|xihuan|xin|xn--11b4c3d|xn--1ck2e1b|xn--1qqw23a|xn--2scrj9c|xn--30rr7y|xn--3bst00m|xn--3ds443g|xn--3e0b707e|xn--3hcrj9c|xn--3oq18vl8pn36a|xn--3pxu8k|xn--42c2d9a|xn--45br5cyl|xn--45brj9c|xn--45q11c|xn--4gbrim|xn--54b7fta0cc|xn--55qw42g|xn--55qx5d|xn--5su34j936bgsg|xn--5tzm5g|xn--6frz82g|xn--6qq986b3xl|xn--80adxhks|xn--80ao21a|xn--80aqecdr1a|xn--80asehdb|xn--80aswg|xn--8y0a063a|xn--90a3ac|xn--90ae|xn--90ais|xn--9dbq2a|xn--9et52u|xn--9krt00a|xn--b4w605ferd|xn--bck1b9a5dre4c|xn--c1avg|xn--c2br7g|xn--cck2b3b|xn--cg4bki|xn--clchc0ea0b2g2a9gcd|xn--czr694b|xn--czrs0t|xn--czru2d|xn--d1acj3b|xn--d1alf|xn--e1a4c|xn--eckvdtc9d|xn--efvy88h|xn--estv75g|xn--fct429k|xn--fhbei|xn--fiq228c5hs|xn--fiq64b|xn--fiqs8s|xn--fiqz9s|xn--fjq720a|xn--flw351e|xn--fpcrj9c3d|xn--fzc2c9e2c|xn--fzys8d69uvgm|xn--g2xx48c|xn--gckr3f0f|xn--gecrj9c|xn--gk3at1e|xn--h2breg3eve|xn--h2brj9c|xn--h2brj9c8c|xn--hxt814e|xn--i1b6b1a6a2e|xn--imr513n|xn--io0a7i|xn--j1aef|xn--j1amh|xn--j6w193g|xn--jlq61u9w7b|xn--jvr189m|xn--kcrx77d1x4a|xn--kprw13d|xn--kpry57d|xn--kpu716f|xn--kput3i|xn--l1acc|xn--lgbbat1ad8j|xn--mgb9awbf|xn--mgba3a3ejt|xn--mgba3a4f16a|xn--mgba7c0bbn0a|xn--mgbaakc7dvf|xn--mgbaam7a8h|xn--mgbab2bd|xn--mgbai9azgqp6j|xn--mgbayh7gpa|xn--mgbb9fbpob|xn--mgbbh1a|xn--mgbbh1a71e|xn--mgbc0a9azcg|xn--mgbca7dzdo|xn--mgberp4a5d4ar|xn--mgbgu82a|xn--mgbi4ecexp|xn--mgbpl2fh|xn--mgbt3dhd|xn--mgbtx2b|xn--mgbx4cd0ab|xn--mix891f|xn--mk1bu44c|xn--mxtq1m|xn--ngbc5azd|xn--ngbe9e0a|xn--ngbrx|xn--node|xn--nqv7f|xn--nqv7fs00ema|xn--nyqy26a|xn--o3cw4h|xn--ogbpf8fl|xn--p1acf|xn--p1ai|xn--pbt977c|xn--pgbs0dh|xn--pssy2u|xn--q9jyb4c|xn--qcka1pmc|xn--qxam|xn--rhqv96g|xn--rovu88b|xn--rvc1e0am3e|xn--s9brj9c|xn--ses554g|xn--t60b56a|xn--tckwe|xn--tiq49xqyj|xn--unup4y|xn--vermgensberater-ctb|xn--vermgensberatung-pwb|xn--vhquv|xn--vuq861b|xn--w4r85el8fhu5dnra|xn--w4rs40l|xn--wgbh1c|xn--wgbl6a|xn--xhq521b|xn--xkc2al3hye2a|xn--xkc2dl3a5ee0h|xn--y9a3aq|xn--yfro4i67o|xn--ygbi2ammx|xn--zfr164b|xperia|xxx|xyz|yachts|yahoo|yamaxun|yandex|ye|yodobashi|yoga|yokohama|you|youtube|yt|yun|za|zappos|zara|zero|zip|zippo|zm|zone|zuerich|zw".split("|"),z="0123456789".split(""),G="0123456789abcdefghijklmnopqrstuvwxyz".split(""),W=[" ","\f","\r","\t","\v"," "," ","᠎"],V=[],$=function(e){return new d(e)},K=$(),J=$(b),Y=$(p),Z=$(),X=$(O);K.on("@",$(g)).on(".",$(_)).on("+",$(w)).on("#",$(k)).on("?",$(x)).on("/",$(S)).on("_",$(T)).on(":",$(m)).on("{",$(M)).on("[",$(I)).on("<",$(R)).on("(",$(P)).on("}",$(D)).on("]",$(j)).on(">",$(B)).on(")",$(F)).on("&",$(H)).on([",",";","!",'"',"'"],$(C)),K.on("\n",$(v)).on(W,X),X.on(W,X);for(var Q=0;Q<U.length;Q++){var ee=o(U[Q],K,N,p);V.push.apply(V,ee)}var te=o("file",K,p,p),ne=o("ftp",K,p,p),ie=o("http",K,p,p),ae=o("mailto",K,p,p);V.push.apply(V,te),V.push.apply(V,ne),V.push.apply(V,ie),V.push.apply(V,ae);var oe=te.pop(),se=ne.pop(),re=ie.pop(),ce=ae.pop(),le=$(p),he=$(E),de=$(L);se.on("s",le).on(":",he),re.on("s",le).on(":",he),V.push(le),oe.on(":",he),le.on(":",he),ce.on(":",de);var ue=o("localhost",K,y,p);V.push.apply(V,ue),K.on(z,J),J.on("-",Z).on(z,J).on(G,Y),Y.on("-",Z).on(G,Y);for(var fe=0;fe<V.length;fe++)V[fe].on("-",Z).on(G,Y);Z.on("-",Z).on(z,Y).on(G,Y),K.defaultTransition=$(A);var pe=function(e){for(var t=e.replace(/[A-Z]/g,(function(e){return e.toLowerCase()})),n=e.length,i=[],a=0;a<n;){for(var o=K,s=null,r=0,c=null,l=-1;a<n&&(s=o.next(t[a]));)(o=s).accepts()?(l=0,c=o):l>=0&&l++,r++,a++;if(!(l<0)){a-=l,r-=l;var h=c.emit();i.push(new h(e.substr(a-r,r)))}}return i},ge=K,me=Object.freeze({State:d,TOKENS:q,run:pe,start:ge}),_e=function(e){e&&(this.v=e)};_e.prototype={type:"token",isLink:!1,toString:function(){for(var e=[],t=0;t<this.v.length;t++)e.push(this.v[t].toString());return e.join("")},toHref:function(){return this.toString()},toObject:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"http";return{type:this.type,value:this.toString(),href:this.toHref(e)}}};var Ce=n(_e,(function(e){e&&(this.v=e)}),{type:"email",isLink:!0}),ye=n(_e,(function(e){e&&(this.v=e)}),{type:"email",isLink:!0,toHref:function(){return"mailto:"+this.toString()}}),ve=n(_e,(function(e){e&&(this.v=e)}),{type:"text"}),be=n(_e,(function(e){e&&(this.v=e)}),{type:"nl"}),we=n(_e,(function(e){e&&(this.v=e)}),{type:"url",isLink:!0,toHref:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"http",t=!1,n=!1,i=this.v,a=[],o=0;i[o]instanceof E;)t=!0,a.push(i[o].toString().toLowerCase()),o++;for(;i[o]instanceof S;)n=!0,a.push(i[o].toString()),o++;for(;r(i[o]);)a.push(i[o].toString().toLowerCase()),o++;for(;o<i.length;o++)a.push(i[o].toString());return a=a.join(""),t||n||(a=e+"://"+a),a},hasProtocol:function(){return this.v[0]instanceof E}}),ke=Object.freeze({Base:_e,MAILTOEMAIL:Ce,EMAIL:ye,NL:be,TEXT:ve,URL:we}),Ee=function(e){return new u(e)},Le=Ee(),xe=Ee(),Se=Ee(),Te=Ee(),Ae=Ee(),Ne=Ee(),Oe=Ee(),Me=Ee(we),Ie=Ee(),Re=Ee(we),Pe=Ee(we),De=Ee(),je=Ee(),Be=Ee(),Fe=Ee(),He=Ee(),qe=Ee(we),Ue=Ee(we),ze=Ee(we),Ge=Ee(we),We=Ee(),Ve=Ee(),$e=Ee(),Ke=Ee(),Je=Ee(),Ye=Ee(),Ze=Ee(ye),Xe=Ee(),Qe=Ee(ye),et=Ee(Ce),tt=Ee(),nt=Ee(),it=Ee(),at=Ee(),ot=Ee(be);Le.on(v,ot).on(E,xe).on(L,Se).on(S,Te),xe.on(S,Te),Te.on(S,Ae),Le.on(N,Ne).on(p,Ne).on(y,Me).on(b,Ne),Ae.on(N,Pe).on(p,Pe).on(b,Pe).on(y,Pe),Ne.on(_,Oe),Je.on(_,Ye),Oe.on(N,Me).on(p,Ne).on(b,Ne).on(y,Ne),Ye.on(N,Ze).on(p,Je).on(b,Je).on(y,Je),Me.on(_,Oe),Ze.on(_,Ye),Me.on(m,Ie).on(S,Pe),Ie.on(b,Re),Re.on(S,Pe),Ze.on(m,Xe),Xe.on(b,Qe);var st=[p,g,y,b,w,k,E,S,N,T,A,H],rt=[m,_,x,C,D,j,B,F,M,I,R,P];Pe.on(M,je).on(I,Be).on(R,Fe).on(P,He),De.on(M,je).on(I,Be).on(R,Fe).on(P,He),je.on(D,Pe),Be.on(j,Pe),Fe.on(B,Pe),He.on(F,Pe),qe.on(D,Pe),Ue.on(j,Pe),ze.on(B,Pe),Ge.on(F,Pe),We.on(D,Pe),Ve.on(j,Pe),$e.on(B,Pe),Ke.on(F,Pe),je.on(st,qe),Be.on(st,Ue),Fe.on(st,ze),He.on(st,Ge),je.on(rt,We),Be.on(rt,Ve),Fe.on(rt,$e),He.on(rt,Ke),qe.on(st,qe),Ue.on(st,Ue),ze.on(st,ze),Ge.on(st,Ge),qe.on(rt,qe),Ue.on(rt,Ue),ze.on(rt,ze),Ge.on(rt,Ge),We.on(st,qe),Ve.on(st,Ue),$e.on(st,ze),Ke.on(st,Ge),We.on(rt,We),Ve.on(rt,Ve),$e.on(rt,$e),Ke.on(rt,Ke),Pe.on(st,Pe),De.on(st,Pe),Pe.on(rt,De),De.on(rt,De),Se.on(N,et).on(p,et).on(b,et).on(y,et),et.on(st,et).on(rt,tt),tt.on(st,et).on(rt,tt);var ct=[p,b,w,k,x,T,A,H,N];Ne.on(ct,nt).on(g,it),Me.on(ct,nt).on(g,it),Oe.on(ct,nt),nt.on(ct,nt).on(g,it).on(_,at),at.on(ct,nt),it.on(N,Je).on(p,Je).on(y,Ze);var lt=function(e){for(var t=e.length,n=0,i=[],a=[];n<t;){for(var o=Le,s=null,r=null,c=0,l=null,h=-1;n<t&&!(s=o.next(e[n]));)a.push(e[n++]);for(;n<t&&(r=s||o.next(e[n]));)s=null,(o=r).accepts()?(h=0,l=o):h>=0&&h++,n++,c++;if(h<0)for(var d=n-c;d<n;d++)a.push(e[d]);else{a.length>0&&(i.push(new ve(a)),a=[]),n-=h,c-=h;var u=l.emit();i.push(new u(e.slice(n-c,n)))}}return a.length>0&&i.push(new ve(a)),i},ht=Object.freeze({State:u,TOKENS:ke,run:lt,start:Le});Array.isArray||(Array.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)});var dt=function(e){return lt(pe(e))};t.find=function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=dt(e),i=[],a=0;a<n.length;a++){var o=n[a];!o.isLink||t&&o.type!==t||i.push(o.toObject())}return i},t.inherits=n,t.options=l,t.parser=ht,t.scanner=me,t.test=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=dt(e);return 1===n.length&&n[0].isLink&&(!t||n[0].type===t)},t.tokenize=dt}(self.linkify=self.linkify||{})}();class BaseHelper{easeInOutQuad(e,t,n,i){return(e/=i/2)<1?n/2*e*e+t:-n/2*(--e*(e-2)-1)+t}generateText(e){const t=["a","s","d","f","g","h","j","k","l","z","x","c","v","b","n","m","q","w","e","r","t","y","u","i","o","p","1","2","3","4","5","6","7","8","9","0","_","-","Z","X","C","V","B","N","M","L","K","J","H","G","F","D","S","A","Q","W","E","R","T","Y","U","I","O","P"];let n="";for(let i=0;i<e;i++)n+=t[Math.floor(Math.random()*t.length)];return n}pasteHtmlAtCaret(e){var t,n;if(window.getSelection){if((t=window.getSelection()).getRangeAt&&t.rangeCount){(n=t.getRangeAt(0)).deleteContents();var i=document.createElement("div");i.innerHTML=e;for(var a,o,s=document.createDocumentFragment();a=i.firstChild;)o=s.appendChild(a);n.insertNode(s),o&&((n=n.cloneRange()).setStartAfter(o),n.collapse(!0),t.removeAllRanges(),t.addRange(n))}}else document.selection&&"Control"!==document.selection.type&&document.selection.createRange().pasteHTML(e)}scrollTo(e,t,n){try{var i=e.scrollTop,a=t-i,o=0;!function t(){o+=20;var s=Math.easeInOutQuad(o,i,a,n);e.scrollTop=s,o<n&&setTimeout(t,20)}()}catch(e){console.log(e)}}validateEmail(e){return/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(String(e).toLowerCase())}validPhone(e){return/^[\+]?[(]?[0-9]{3}[)]?[-\s\.]?[0-9]{3}[-\s\.]?[0-9]{4,6}$/im.test(String(e).toLowerCase())}openInNewTab(e){window.open(e,"_blank").focus()}isElementInViewport(e){if(!e||!e.getBoundingClientRect())return!1;var t=e.getBoundingClientRect();return t.top>=0&&t.left>=0&&t.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&t.right<=(window.innerWidth||document.documentElement.clientWidth)}getFormDataUpload(e,t){const n=new FormData;if(e.length>LadiChat_Config.SHARE_MEDIA.IMAGE_COUNT_ALLOW)return LadiChat.toastr("error","",LadiChat_Config.MESSAGE_CONFIG.IMAGE_OVER_COUNT),!1;for(let t=0;t<e.length;t++){const i=e[t];if(i.size/1024/1024>LadiChat_Config.SHARE_MEDIA.IMAGE_SIZE_ALLOW)return LadiChat.toastr("error","",LadiChat_Config.MESSAGE_CONFIG.IMAGE_OVER_SIZE),!1;n.append("files",i,i.name)}return n.append("json_data",JSON.stringify({ladi_app:"LADICHAT",file_type:t})),n}async sendRequest(e,t,n,i,a){try{return new Promise((function(o,s){const r=new XMLHttpRequest;try{r.onreadystatechange=function(){4==r.readyState&&o(r.responseText)},r.open(e,t,i),"function"!=typeof a&&!(a instanceof Array)&&a instanceof Object&&Object.keys(a).forEach((function(e){r.setRequestHeader(e,a[e])})),r.send(n)}catch(e){s(e)}}))}catch(e){console.log(e)}}getApplyStyle(e){const t=e.header_color,n=e.text_color,i=t.split(", rgb");let a=`\n        .fab {\n            background: ${t} !important;\n        }\n        .ladichat-widget-header {\n            background: ${t} !important;\n            color: ${n} !important;\n        }\n        .header-welcome .intro-text p{ \n            color: ${n} !important;\n        }\n        #slider span{\n            color: ${n} !important;\n        }\n        .button-new-conversation {\n            background: ${("rgb"+i[2]).replace("))",")")} !important;\n            color: ${n} !important;\n        }\n        `,o=t.replace("),",", 0.05),");o=o.replace("))",", 0.1))"),a+=`.conversation-item.selected ,.conversation-item:hover  {\n            background: ${o}\n        }`,a+=`.ladichat-startpage .header-welcome{\n            background: ${t}\n        }`;let s=t.replace("),",", 0.6),");return s=s.replace("))",", 0.6))"),a+=`.module-border-wrap{\n            background: ${t}\n        }`,a+=`.ladichat-msg-recieve-text {\n            background: ${("rgb"+i[2]).replace("))",", 0.15)")}  !important;\n        }`,a+=`.ladichat-msg-sent-text{\n            background: ${("rgb"+i[2]).replace("))",", 0.8)")}  !important;\n            color: ${n} !important;\n        }`,a+="right"==e.widget_position?".ladichat-widget {\n                right: 0;\n            }\n            .ladichat-widget-container {\n                left: calc(100vw - 410px);\n            }\n            ":".ladichat-widget {\n                left: 0px;\n            }\n            .ladichat-widget-container {\n                left: 0px;\n            }\n            ",a}getBlobURL(e,t){const n=new Blob([e],{type:t});return URL.createObjectURL(n)}getGeneratedPageURL({html:e,cssURL:t}){return getBlobURL(`\n            <html>\n                <head>\n                ${t&&`<link rel="stylesheet" type="text/css" href="${t}" />`}\n                </head>\n                <body>\n                ${e||""}\n                </body>\n            </html>\n            `,"text/html")}getDisplayName(e){return e?(e=this.capitalize(e)).match(/\b(\w)/g).slice(0,2).join(""):""}capitalize(e){return e.toLowerCase().replace(/\b./g,(function(e){return e.toUpperCase()}))}setCookie(e,t,n){var i="";if(n){var a=new Date;a.setTime(a.getTime()+24*n*60*60*1e3),i="; expires="+a.toUTCString()}t=encodeURIComponent(t),document.cookie=e+"="+(t||"")+i+"; path=/"}getCookie(e){for(var t=e+"=",n=document.cookie.split(";"),i=0;i<n.length;i++){for(var a=n[i];" "===a.charAt(0);)a=a.substring(1,a.length);if(0===a.indexOf(t))return decodeURIComponent(a.substring(t.length,a.length))}return null}uuidv4(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)}))}diffDateSecond(e,t){return(e.getTime()-t.getTime())/1e3}diffDateMinute(e,t){return(e.getTime()-t.getTime())/1e3/60}diffDateHour(e,t){return(e.getTime()-t.getTime())/1e3/60/60}diffDateDay(e,t){return(e.getTime()-t.getTime())/1e3/84600}diffDateWeek(e,t){return(e.getTime()-t.getTime())/1e3/84600/7}diffDateMonth(e,t){return(e.getTime()-t.getTime())/1e3/84600/7/30}getPrettyDate(e){const t=new Date(e),n=new Date;let i=Math.floor(this.diffDateSecond(n,t));if(i<60)return i<=10?"Mới gửi":i+" giây";let a=Math.floor(this.diffDateMinute(n,t));if(a<60)return i=a%60,a+" phút";let o=Math.floor(this.diffDateHour(n,t));if(o<24)return a%=60,o+" giờ";let s=Math.floor(this.diffDateDay(n,t));if(s<7)return o%=24,s+" ngày";let r=Math.floor(this.diffDateWeek(n,t));return r<4?(s=r%7,r+" tuần"):Math.floor(this.diffDateMonth(n,t))<=0?s+" ngày":Math.floor(this.diffDateMonth(n,t))+" tháng"}async sendPOSTRequest(e,t,n,i=!1){var a=JSON.stringify(n),o=e+t;return i||(i={"Content-Type":"application/json"}),new Promise((function(e,t){var n=new XMLHttpRequest;try{n.onreadystatechange=function(){if(4==n.readyState){var t={};200==n.status&&(t=JSON.parse(n.responseText)),e(t,n.status)}},n.open("POST",o,!0),"function"!=typeof i&&!(i instanceof Array)&&i instanceof Object&&Object.keys(i).forEach((function(e){n.setRequestHeader(e,i[e])})),n.send(a)}catch(e){t(e)}}))}}class ConfigWidget{constructor(){this.defaultStaffAvatar="https://w.ladicdn.com/ladichat/big-avatar.png",this.defaultLogo="https://w.ladicdn.com/ladichat/ladipage-logo-color.svg",this.defaultStartPageConfig={is_enable:!0,survey_title:"Hãy giới thiệu về bạn:",survey_enable:!0,survey_data:{name:{is_selected:!0,label:"Tên",place_holder:"Nhập tên"},email:{is_selected:!0,label:"Email",place_holder:"Nhập email"},phone:{is_selected:!0,label:"Số điện thoại",place_holder:"Nhập số điện thoại"}},introduce_text:"Nền tảng thiết kế LandingPage hàng đầu thế giới",logo_img:"https://w.ladicdn.com/ladichat/ladipage-logo-color.svg",article_enable:!1,article_data:[]},this.defaultConversationPageConfig={button_create_conversation:"Tạo hội thoại mới",header_name:"Cuộc trò chuyện của bạn"},this.SHARE_MEDIA={CND_URL_IMAGE:"https://w.ladicdn.com/",CND_URL_DOCUMENT:"https://s.ladicdn.com/",IMAGE:"IMAGE",VIDEO:"VIDEO",DOCUMENT:"DOCUMENT",EMOJI:"EMOJI",GIFS:"GIFS",IMAGE_SIZE_ALLOW:5,IMAGE_COUNT_ALLOW:10},this.API_VERSION="1.0",this.API_ROUTE={NEW_SESSION:`/${this.API_VERSION}/auth/new-session`,MY_INFO:`/${this.API_VERSION}/auth/my-info`,SEND_SURVEY_DATA:`/${this.API_VERSION}/auth/survey`,LIST_CONVERSATION:`/${this.API_VERSION}/conversation/list-by-user`,LIST_MESSAGE:`/${this.API_VERSION}/message/list-by-user`,UNREAD_MESSAGE:`/${this.API_VERSION}/message/user-unread`,USER_READ_MESSAGE:`/${this.API_VERSION}/message/user-read`,GET_CONFIG:`/${this.API_VERSION}/store/get-config`,SEND_MESSAGE:`/${this.API_VERSION}/message/create`,CUSTOM_COMMAND:`/${this.API_VERSION}/auth/sdk-command`},this.EXPRIRE_TOKEN=30,this.SOCKET_EVENT={SUBSCRIBE_CONVERSATION:"SUBSCRIBE_CONVERSATION",ON_TYPING:"ON_TYPING",ON_TYPING_CHANGE_MSG:"ON_TYPING_CHANGE_MSG",END_TYPING:"END_TYPING",READ_MESSAGE:"READ_MESSAGE",NEW_MESSAGE:"NEW_MESSAGE",NEW_CONVERSATION:"NEW_CONVERSATION"},this.MESSAGE_CONFIG={IMAGE_OVER_SIZE:"Hãy chọn ảnh hoặc file có kích thước tối hơn 5MB",IMAGE_OVER_COUNT:"Vui lòng chọn dưới 10 file."},this.SESSION_KEY="s_key_",this.USER_INFO_COOKIE="u_inf_",this.STORE_CONFIG_COOKIE="s_conf_",this.SCREEN_NAME={SURVEY_PAGE:"SURVEY",LIST_CONVERSATION_PAGE:"LIST_CONVERSATION_PAGE",MESSENGER_PAGE:"MESSENGER_PAGE"},this.USER_EVENT={PAGE_VIEW:"PAGE_VIEW",SUBMIT_SURVEY:"SUBMIT_SURVEY",START_CONVERSATION:"START_CONVERSATION",PURCHASED:"PURCHASED"}}getStaffInfo(e,t){const{staffs:n}=t;if(n&&n.length>0)for(let t=0;t<n.length;t++)if(n[t].ladi_uid==e)return n[t];return null}}class ConversationItem{init(e,t,n,i){this.storeConfig=e;const a=this.generateHTMLContent(t,n,i),o=document.createElement("div");o.innerHTML=a.trim();const s=o.firstChild;this.doom_element=s}generateHTMLContent(e,t,n){const i=n?"selected":"";let a=t.lastMsg?t.lastMsg.message:"";a=a.replace(/<div>/gi,"&nbsp;"),a=a.replace(/<br>/gi,"&nbsp;");let o="<div></div>";const s=document.createElement("div");s.innerHTML=a,o=s.innerText,""==s.innerText&&a.indexOf("<img")>=0&&(o="[Hình ảnh]");let r="";t.lastMsg&&t.lastMsg.read_users.indexOf(this.storeConfig.user_info.user_id)<0&&(r=document.createElement("div"),r.setAttribute("class","ladichat-message-unread-badge"),r.setAttribute("id","unread-badge-conv-"+t._id),r=r.outerHTML);const c=e&&e.avatar&&e.avatar.length>0?e.avatar:LadiChat_Config.defaultStaffAvatar;return"<div id="+t._id+' class="conversation-item '+i+`" key="${t.last_action}" > \n                <div class="inbox">\n                    <div class="avatar">\n                        <img src='`+c+"' /> \n                    </div>\n                    <div class=\"detail\">\n                    <div>\n                        <div class='staff-name'>"+(e&&e.name?e.name:this.storeConfig.store_info.name)+'</div>\n                        <div class="time">'+LadiChat_Helper.getPrettyDate(t.last_action)+'</div>\n                    </div>\n                    <div class="message">\n                        <p class="content">'+o+" </p>"+r+"</div>\n                    </div>\n                </div>\n            </div>"}}class ConversationPage{init(e,t,n){this.storeConfig=t,this.configConversationPage=t.conversationPage?t.conversationPage:LadiChat_Config.defaultConversationPageConfig;const i=this.generateHTMLContent();this.token=e,this.name=LadiChat_Config.SCREEN_NAME.LIST_CONVERSATION_PAGE,this.doom_element=i,this.socket=n,this.reloadTime()}reloadTime(){const e=this;window.interval_conversationPage_ID&&clearInterval(window.interval_conversationPage_ID),window.interval_conversationPage_ID=setInterval((function(){for(let t=0;t<e.listConversation.length;t++)e.reloadLastMsgTime(e.listConversation[t].lastMsg,e.listConversation[t]._id)}),1e4)}removeSocketEvent(){this.socket.removeListener(LadiChat_Config.SOCKET_EVENT.NEW_CONVERSATION,this.eventNewConversation),this.socket.removeListener(LadiChat_Config.SOCKET_EVENT.NEW_MESSAGE,this.eventNewMessage),this.socket.removeListener("connect",this.eventConnect)}addSocketEvent(){const e=this;this.eventNewConversation=function(t){e.handlerNewConversation(t)},this.eventNewMessage=function(t){e.handlerNewMessage([t])},this.eventConnect=function(t){e.subscribeAllConversation()},this.socket.on(LadiChat_Config.SOCKET_EVENT.NEW_CONVERSATION,this.eventNewConversation),this.socket.on(LadiChat_Config.SOCKET_EVENT.NEW_MESSAGE,this.eventNewMessage),this.socket.on("connect",this.eventConnect)}handlerNewMessage(e){try{for(let t=0;t<e.length;t++){const n=e[t];if("SYSTEM"===n.type||"NOTE"===n.type)return;const i=n.conversation_id;for(let e=0;e<this.listConversation.length;e++)this.listConversation[e]._id===i&&(this.listConversation[e].last_action=n.created_at,this.listConversation[e].lastMsg=n,this.reloadLastMsg(n,i),this.reloadLastMsgTime(n,i));this.sortConversation(),this.animateSort()}}catch(e){console.log(e)}}reloadLastMsgTime(e,t){const n=this.mainDocument.getElementById(t);if(n){const t=n.getElementsByClassName("time");t.length>0&&(t[0].innerHTML='<div class="time">'+LadiChat_Helper.getPrettyDate(e.created_at)+"</div>")}}reloadLastMsg(e,t){const n=this.mainDocument.getElementById(t);if(n){const i=n.getElementsByClassName("message");if(i.length>0){const n=i[0];let a=e.message;a=a.replace(/<div>/gi,"&nbsp;"),a=a.replace(/<br>/gi,"&nbsp;");let o="<div></div>";const s=document.createElement("div");s.innerHTML=a,o=s.innerText,""==s.innerText&&a.indexOf("<img")>=0&&(o="[Hình ảnh]");let r=!1;e.read_users.indexOf(this.storeConfig.user_info.user_id)<0&&(r=document.createElement("div"),r.setAttribute("class","ladichat-message-unread-badge"),r.setAttribute("id","unread-badge-conv-"+t)),n.innerHTML='<p class="content">'+o+" </p>",r&&n.appendChild(r)}}}addEvent(e){const t=this;this.mainDocument=e;const n=e.getElementById("back-btn");n&&n.addEventListener("click",(function(){t.removeSocketEvent(),LadiChat.showStartPage()})),this.btnNewConversation=e.getElementById("button-new-conversation"),this.btnNewConversation.addEventListener("click",(function(){t.removeSocketEvent(),LadiChat.showConversationStream(null)})),this.addSocketEvent(),this.getConversation()}handlerNewConversation(e){this.listConversation.push(e),this.reloadConversation()}generateHeader(){let e=`<div class="ladichat-widget-header">\n            <div id="back-btn" class="ladichat-widget-header-back-btn">\n                <span>\n                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><g fill="none"><g fill="#FFF"><polygon transform="translate(-40 -29)translate(47.071068 36.071068)rotate(-315)translate(-47.071068 -36.071068)" points="44.3 38.8 44.3 31.1 42.1 31.1 42.1 40 42.1 41.1 52.1 41.1 52.1 38.8"></polygon></g></g></svg>\n                </span>\n            </div>\n            <div class="ladichat-widget-header-option">\n                <div id="slider" class="ladichat-widget-header-avatar slide-in">\n                    <span class="ladichat-widget-header-name">${this.configConversationPage.header_name}</span>\n                </div>\n            </div>\n        </div>`;this.storeConfig.startPage.is_enable||(e=`<div class="ladichat-widget-header" >\n            <div class="ladichat-widget-header-option" style="text-align:center">\n                <div id="slider" class="ladichat-widget-header-avatar slide-in">\n                    <span class="ladichat-widget-header-name">${this.configConversationPage.header_name}</span>\n                </div>\n            </div>\n        </div>`);const t=document.createElement("div");return t.innerHTML=e.trim(),t.firstChild}generateHTMLContent(){const e=document.createElement("div"),t=this.generateHeader();e.appendChild(t);const n=document.createElement("div");n.setAttribute("class","ladichat-widget-body conversation"),e.appendChild(n),this.chatWidgetConversationList=document.createElement("div"),this.chatWidgetConversationList.setAttribute("id","ladichat-conversation"),this.chatWidgetConversationList.setAttribute("class","ladichat-conversation"),n.appendChild(this.chatWidgetConversationList);const i=document.createElement("div");i.setAttribute("class","ladichat-widget-footer conversation-page");const a=document.createElement("div");return a.setAttribute("class","start-new-conversation"),this.btnNewConversation=document.createElement("span"),this.btnNewConversation.innerText=this.configConversationPage.button_create_conversation,this.btnNewConversation.setAttribute("class","button-new-conversation noselect"),this.btnNewConversation.setAttribute("id","button-new-conversation"),a.appendChild(this.btnNewConversation),i.appendChild(a),e.appendChild(i),e}startNewConversation(){}async getConversation(){try{const e={token:this.token},t=await LadiChat_Helper.sendPOSTRequest(LadiChat_Static_Config.END_POINT,LadiChat_Config.API_ROUTE.LIST_CONVERSATION,e);200==t.code&&(this.listConversation=[],this.listConversation=t.data.conversations,this.reloadConversation())}catch(e){console.log(e)}}async getMessage(e){}selectConversation(e){const t=e.id;for(let e=0;e<this.listConversation.length;e++)t==this.listConversation[e]._id&&(this.currentConversation=this.listConversation[e],LadiChat.showConversationStream(this.currentConversation))}animateSort(){for(let e=0;e<this.listConversation.length;e++){const t=this.mainDocument.getElementById(this.listConversation[e]._id);t&&(t.style.zindex=""+e,t.style.transform=`translateY(${69*e}px)`,t.style.transition="transform 200ms")}}sortConversation(){this.listConversation=this.listConversation.sort((function(e,t){const n=e.lastMsg?new Date(e.lastMsg.created_at):new Date(e.last_action);return(t.lastMsg?new Date(t.lastMsg.created_at):new Date(t.last_action)).getTime()-n.getTime()}))}subscribeAllConversation(){if(this.listConversation&&0!=this.listConversation.length)for(let e=0;e<this.listConversation.length;e++)this.socket.emit(LadiChat_Config.SOCKET_EVENT.SUBSCRIBE_CONVERSATION,this.listConversation[e]._id)}reloadConversation(){if(LadiChat.screen_name!=this.name)return;const e=this;!this.currentConversation&&this.listConversation.length>0&&(this.currentConversation=this.listConversation[0]);const t=this.mainDocument.getElementById("ladichat-conversation");t.innerHTML="",this.sortConversation();for(let n=0;n<this.listConversation.length;n++){this.listConversation[n].lastMsg&&(this.listConversation[n].last_action=this.listConversation[n].lastMsg.created_at);const i=!1,a=LadiChat_Config.getStaffInfo(this.listConversation[n].assign_id,this.storeConfig),o=new ConversationItem;o.init(this.storeConfig,a,this.listConversation[n],i);const s=o.doom_element;s.addEventListener("click",(function(t){e.selectConversation(s)})),this.listConversation[n].widget_element=s,t.appendChild(s)}this.subscribeAllConversation(),this.animateSort()}}class ConversationStream{init(e,t,n,i){try{this.storeConfig=t,this.token=e,this.listMessage=[],this.listUnreadMessage=[],this.conversation=i;const a=this.generateHTMLContent();this.doom_element=a,this.socket=n,this.reloadTime(),this.changeTypingContent(),this.timerScroll=null,this.timerTyping=null,this.isTyping=!1,this.lastContent="",this.lastUnread=!1,this.indexShowRead=null,this.timerSearchEmoji=!1,this.listTyping=[],this.name=LadiChat_Config.SCREEN_NAME.MESSENGER_PAGE}catch(e){console.log(e)}}trackScrolling(e){const t=this;null!==this.timerScroll&&clearTimeout(this.timerScroll),this.timerScroll=setTimeout((async function(){await t.checkReadMsg()}),100)}async checkReadMsg(){const e=this.mainDocument.activeElement;if(!e)return;if("ladichat-typing-message"!=e.id)return;let t=-1;for(let e=this.listMessage.length-1;e>=0;e--)if(this.listMessage[e].read_users.indexOf(this.storeConfig.user_info.user_id)>=0){t=e;break}if(t>=0)for(let e=t-1;e>=0;e--)if(this.listMessage[e].read_users.indexOf(this.storeConfig.user_info.user_id)<0){const t={msg_id:this.listMessage[e]._id,user_read_id:this.storeConfig.user_info.user_id,conversation_id:this.conversation._id,store_id:this.conversation.store_id},n={"content-type":"application/json","session-key":this.token};let i=await LadiChat_Helper.sendRequest("POST",LadiChat_Static_Config.END_POINT+LadiChat_Config.API_ROUTE.USER_READ_MESSAGE,JSON.stringify(t),!0,n);return i=JSON.parse(i),void(i&&200==i.code&&this.listMessage[e].read_users.push(this.storeConfig.user_info.user_id))}for(let e=0;e<this.listMessage.length;e++)if(this.listMessage[e].read_users.indexOf(this.storeConfig.user_info.user_id)<0){const t=this.listMessage[e].widget_element;if(t&&LadiChat_Helper.isElementInViewport(t)){const t={msg_id:this.listMessage[e]._id,user_read_id:this.storeConfig.user_info.user_id,conversation_id:this.conversation._id,store_id:this.conversation.store_id},n={"content-type":"application/json","session-key":this.token};let i=await LadiChat_Helper.sendRequest("POST",LadiChat_Static_Config.END_POINT+LadiChat_Config.API_ROUTE.USER_READ_MESSAGE,JSON.stringify(t),!0,n);i=JSON.parse(i),i&&200==i.code&&this.listMessage[e].read_users.push(this.storeConfig.user_info.user_id)}}}reloadTime(){const e=this;window.interval_conversationStream_ID&&clearInterval(window.interval_conversationStream_ID),window.interval_conversationStream_ID=setInterval((function(){for(let t=0;t<e.listMessage.length;t++)e.reloadLastMsgTime(e.listMessage[t])}),1e4)}reloadLastMsgTime(e){const t=this.mainDocument.getElementById("datetime-"+e._id);if(t){if("SENT"==e.type){let n=!0;1==e.read_users.length&&(n=!1);const i=e._id==this.indexShowRead,a=""+LadiChat_Helper.getPrettyDate(e.created_at),o=" - "+(n?"Đã xem":"Chưa xem");t.innerHTML=`<div class="line">\n                    <span class="ladichat-msg-datetime" id="datetime-${e._id}">\n                    ${a+(i?o:"")} \n                    </span>\n                </div>`}if("RECIEVE"==e.type){const n='"'+new Date(e.created_at).toLocaleString()+'"';t.innerHTML=`<div class="line">\n                    <span class="ladichat-msg-datetime" id="datetime-${e._id}"\n                        data-tooltip=${n}\n                        data-tooltip-position="right">`+LadiChat_Helper.getPrettyDate(e.created_at)+"</span>\n                    </div>\n                </div>"}}}addEvent(e){try{const t=this;this.mainDocument=e,this.conversation&&this.conversation._id&&this.socket.emit(LadiChat_Config.SOCKET_EVENT.SUBSCRIBE_CONVERSATION,this.conversation._id),e.getElementById("back-btn").addEventListener("click",(function(){t.removeSocketEvent(),LadiChat.showConversationPage()})),e.getElementById("ladichat-send-button").addEventListener("click",(function(){t.sendMessage()})),this.inputBoxWigdet=e.getElementById("ladichat-typing-message"),this.inputBoxWigdet.addEventListener("keyup",(function(e){"Enter"===e.key?(e.preventDefault(),t.sendMessage()):(t.changeStyleInput(),t.userTyping())})),this.inputBoxWigdet.addEventListener("click",(function(e){e.preventDefault(),t.trackScrolling(e)})),this.inputBoxWigdet.addEventListener("paste",(function(n){n.preventDefault();const i=[];let a="";for(let e=0;e<n.clipboardData.items.length;e++){const t=n.clipboardData.items[e];if(0===t.type.indexOf("image")){if(0!=i.length)break;{const e=t.getAsFile();i.push(e)}}0===t.type.indexOf("text")&&(a=n.clipboardData.getData("text"))}i.length>0?t.processChangeFile(i,LadiChat_Config.SHARE_MEDIA.IMAGE):a.length>0&&e.execCommand("insertText",!1,a),t.changeStyleInput()})),this.labelInputImage=e.getElementById("ladichat-send-image"),this.inputImage=e.getElementById("image-upload-message"),this.inputImage.addEventListener("change",(function(e){const n=e.target.files;t.processChangeFile(n,LadiChat_Config.SHARE_MEDIA.IMAGE)})),this.labelInputDocument=e.getElementById("ladichat-send-document"),this.inputDocument=e.getElementById("file-upload-message"),this.inputDocument.addEventListener("change",(function(e){const n=e.target.files;t.processChangeFile(n,LadiChat_Config.SHARE_MEDIA.DOCUMENT)})),this.chatWidgetMessageList=e.getElementById("ladichat-conversation-list-message"),this.addSocketEvent(),this.conversation&&this.getListMessage(),this.listMessageScroll=e.getElementById("ladichat-list-msg-scroll"),this.listMessageScroll.addEventListener("scroll",(function(e){t.trackScrolling(e)})),this.labelInputIcon=e.getElementById("ladichat-send-icon"),this.sendIcon=e.getElementById("ladichat-send-icon"),this.sendIcon.addEventListener("click",(function(){t.showEmoji()})),this.emojiModal=e.getElementById("modal-ladichat-emoji"),this.emojiModal.addEventListener("click",(function(e){t.hideEmoji()})),this.emojiModalContent=e.getElementById("ladichat-emoji"),this.emojiModalContent.addEventListener("click",(function(e){return e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation(),!1})),this.emojiList=e.getElementById("ladichat-emoji-all");const n=this.emojiList.getElementsByClassName("ladichat-emoji-item");for(let e=0;e<n.length;e++){const i=n[e];i.addEventListener("click",(function(){const e=i.getAttribute("data-emoji");t.sendEmoji(e),t.hideEmoji()}))}this.searchEmoji=e.getElementById("search-emoji"),this.searchEmoji.addEventListener("keyup",(function(e){const n=e.currentTarget.value;t.filterEmoji(n)}))}catch(e){console.log(e)}}filterEmoji(e){const t=this;for(var n in this.arrayReturn=this.emoji.filterKey(e),this.emojiList.innerHTML="",this.arrayReturn){if(!this.arrayReturn.hasOwnProperty(n))continue;let e=i(n,this.arrayReturn[n]);this.emojiList.appendChild(e)}function i(e,t){const n=`<div class="ladichat-emoji-item" data-emoji="${t}"><span title=${e}>${t}</span></div>`,i=document.createElement("div");return i.innerHTML=n.trim(),i.firstChild}const a=this.emojiList.getElementsByClassName("ladichat-emoji-item");for(let e=0;e<a.length;e++){const n=a[e];n.addEventListener("click",(function(){const e=n.getAttribute("data-emoji");t.sendEmoji(e),t.hideEmoji()}))}}hideEmoji(){this.emojiModal.classList.remove("visible")}showEmoji(){const e=this.sendIcon.getBoundingClientRect();this.mainDocument.getElementById("ladichat-emoji")&&(this.emojiModalContent.style.top=e.top-250+"px",this.emojiModal.classList.add("visible"))}async processChangeFile(e,t){const n=LadiChat_Helper.getFormDataUpload(e,t);n&&this.uploadCND(n,t),this.resetInput()}async uploadCND(e,t){let n={Accept:"application/json, text/plain, */*",Authorization:LadiChat.token,"store-id":LadiChat.storeID};const i=await LadiChat_Helper.sendRequest("POST",LadiChat_Static_Config.UPLOAD_ENDPOINT,e,!0,n);let a=JSON.parse(i);200==a.code&&this.sendMessageAttachment(a.data,t),this.resetInput()}async sendMessageAttachment(e,t){const n={"content-type":"application/json","session-key":this.token};for(let a=0;a<e.length;a++){const o=e[a];let s=document.createElement("div"),r="";if(t==LadiChat_Config.SHARE_MEDIA.IMAGE&&(r=LadiChat_Config.SHARE_MEDIA.CND_URL_IMAGE+o.path,s=document.createElement("img"),s.setAttribute("src",r)),t==LadiChat_Config.SHARE_MEDIA.DOCUMENT){r=LadiChat_Config.SHARE_MEDIA.CND_URL_DOCUMENT+o.path,s=document.createElement("a"),s.setAttribute("href",r),s.setAttribute("target","_blank");const e=document.createElement("i");e.setAttribute("class","ladiui icon icon-attach"),s.appendChild(e);var i=document.createTextNode(o.name);s.appendChild(i)}const c={message:s.outerHTML};this.conversation&&(c.conversation_id=this.conversation._id);const l=await LadiChat_Helper.sendPOSTRequest(LadiChat_Static_Config.END_POINT,LadiChat_Config.API_ROUTE.SEND_MESSAGE,c,n);if(201==l.code){const e=l.conversation;this.storeConfig.user_info.current_conversation=e,LadiChat_Helper.setCookie(LadiChat_Config.LADICHAT_USER_INFO,JSON.stringify(this.storeConfig.user_info),30)}}}resetInput(){this.inputImage.value=""}onPaste(e){e.preventDefault();var t=e.clipboardData.getData("text");this.mainDocument.execCommand("insertText",!1,t)}removeSocketEvent(){this.socket.removeListener(LadiChat_Config.SOCKET_EVENT.READ_MESSAGE,this.eventReadMessage),this.socket.removeListener(LadiChat_Config.SOCKET_EVENT.NEW_MESSAGE,this.eventNewMessage),this.socket.removeListener(LadiChat_Config.SOCKET_EVENT.NEW_CONVERSATION,this.eventNewConversation)}addSocketEvent(){const e=this;this.eventReadMessage=function(t){e.handlerReadMessage(t)},this.eventNewMessage=function(t){e.handlerNewMessage([t])},this.eventNewConversation=function(t){e.handlerNewConversation(t)},this.socket.on(LadiChat_Config.SOCKET_EVENT.READ_MESSAGE,this.eventReadMessage),this.socket.on(LadiChat_Config.SOCKET_EVENT.NEW_MESSAGE,this.eventNewMessage),this.socket.on(LadiChat_Config.SOCKET_EVENT.NEW_CONVERSATION,this.eventNewConversation)}handlerNewConversation(e){this.conversation||(this.conversation=e)}handlerNewMessage(e){try{if(LadiChat.screen_name!=this.name)return;let t=!1;for(let n=0;n<e.length;n++){const i=e[n];if(this.conversation._id==i.conversation_id){let e=!1;for(let t=this.listMessage.length-1;t>=0;t--)this.listMessage[t].msg_tid&&!this.listMessage[t]._id&&this.listMessage[t].msg_tid==i.msg_tid&&(this.listMessage[t].ref.timeoutID&&clearTimeout(this.listMessage[t].ref.timeoutID),this.listMessage[t].ref=null,this.listMessage[t]=i,e=!0);e||this.listMessage.push(i),t=!0}}if(t){this.indexShowRead=null;const t=e[0].sender_id==this.storeConfig.user_info.user_id;this.reloadMessagesList(t)}this.trackScrolling(null)}catch(e){console.log(e)}}handlerReadMessage(e){let t=!1,n=!1;for(let i=0;i<this.listMessage.length;i++){if(t=new Date(this.listMessage[i].created_at),this.listMessage[i]._id===e._id){n=new Date(this.listMessage[i].created_at),this.listMessage[i].read_users.indexOf(e.user_read_id)<0&&this.listMessage[i].read_users.push(e.user_read_id);const t=this.listMessage[i].widget_element.querySelector("#datetime-"+e._id);t&&"SENT"===this.listMessage[i].type&&(t.innerHTML=LadiChat_Helper.getPrettyDate(this.listMessage[i].created_at)+" - Đã xem"),"SENT"===this.listMessage[i].type&&(this.indexShowRead=this.listMessage[i]._id)}if(n&&t<n){this.listMessage[i].read_users.indexOf(e.user_read_id)<0&&this.listMessage[i].read_users.push(e.user_read_id);const t=this.listMessage[i].widget_element.querySelector("#datetime-"+e._id);t&&"SENT"===this.listMessage[i].type&&(t.innerHTML=LadiChat_Helper.getPrettyDate(this.listMessage[i].created_at)+" - Đã xem")}}}changeTypingContent(){null!==this.timerTyping&&(clearInterval(this.timerTyping),this.lastContent=""),this.timerTyping=setInterval((function(){if(!this.conversation)return;const e=this.inputBoxWigdet.innerText,t=this.storeConfig.user_info.name?this.storeConfig.user_info.name:this.storeConfig.user_info.alias_name,n={conversation_id:this.conversation._id,name:t,user_id:this.storeConfig.user_info.user_id,msg:e};""!==e&&this.isTyping&&this.lastContent!==e&&(this.socket.emit(LadiChat_Config.SOCKET_EVENT.ON_TYPING_CHANGE_MSG,n),this.lastContent=e),""===e&&this.isTyping&&(this.socket.emit(LadiChat_Config.SOCKET_EVENT.END_TYPING,n),this.isTyping=!1)}),500)}changeStyleInput(){const e=this.mainDocument.getElementById("ladichat-footer-medias");""!==this.inputBoxWigdet.innerText?(e.style.display="block",e.style.width="10%",this.inputBoxWigdet.style.width="90%",this.labelInputImage.style.display="none",this.labelInputDocument.style.display="none",this.labelInputIcon.style.display="none"):(e.style.display="inline-flex",e.style.width="26%",this.inputBoxWigdet.style.width="73%",this.labelInputImage.style.display="inline-block",this.labelInputDocument.style.display="inline-block",this.labelInputIcon.style.display="inline-block")}userTyping(){if(!this.conversation)return;const e=this.inputBoxWigdet.innerText,t=this.storeConfig.user_info.name?this.storeConfig.user_info.name:this.storeConfig.user_info.alias_name,n={conversation_id:this.conversation._id,name:t,user_id:this.storeConfig.user_info.user_id,msg:e};""!==e&&(this.socket.emit(LadiChat_Config.SOCKET_EVENT.ON_TYPING,n),this.isTyping=!0),""===e&&(this.socket.emit(LadiChat_Config.SOCKET_EVENT.END_TYPING,n),this.isTyping=!1)}async sendEmoji(e){try{const t={"content-type":"application/json","session-key":this.token},n={message:e};this.conversation&&(n.conversation_id=this.conversation._id),this.changeStyleInput();const i=await LadiChat_Helper.sendPOSTRequest(LadiChat_Static_Config.END_POINT,LadiChat_Config.API_ROUTE.SEND_MESSAGE,n,t);201===i.code&&(this.conversation||(this.conversation=i.data.conversation))}catch(e){console.log(e)}}async sendMessage(){try{const e={"content-type":"application/json","session-key":this.token};if(""===this.inputBoxWigdet.innerText.trim())return;let t=this.inputBoxWigdet.innerHTML;t=t.replace(/(\r\n|\r|\n){2}/g,"$1").replace(/(\r\n|\r|\n){3,}/g,"$1\n"),t=t.replace(/(<div><br><\/div>)/g,"<br>"),t=t.replace(/(<br>)+/g,"<br>"),t=t.trim();const n=LadiChat_Helper.generateText(5),i={message:t,msg_tid:n},a={msg_tid:n,created_at:new Date,deleted_all:!1,deleted_users:[],message:t,read_users:[this.storeConfig.user_info._id],sender_id:this.storeConfig.user_info._id,store_id:this.storeConfig.user_info.user_id.store_id,updated_at:new Date,type:"SENT",_id:!1,resendData:{data:i,headers:e}};this.conversation&&(i.conversation_id=this.conversation._id,a.conversation_id=this.conversation._id),this.inputBoxWigdet.innerHTML="",this.listMessage.push(a),this.reloadMessagesList(),this.changeStyleInput();const o=await LadiChat_Helper.sendPOSTRequest(LadiChat_Static_Config.END_POINT,LadiChat_Config.API_ROUTE.SEND_MESSAGE,i,e);201!==o.code&&200!==o.code||(this.conversation||(this.conversation=o.data.conversation),!this.storeConfig.user_info||this.storeConfig.user_info.screen_name==LadiChat_Config.SCREEN_NAME.MESSENGER_PAGE&&this.storeConfig.user_info.conversation||(this.storeConfig.user_info.screen_name=LadiChat_Config.SCREEN_NAME.MESSENGER_PAGE,this.storeConfig.user_info.conversation=this.conversation,LadiChat_Helper.setCookie(LadiChat_Config.USER_INFO_COOKIE+LadiChat.storeID,JSON.stringify(this.storeConfig.user_info),30)))}catch(e){console.log(e)}}generateHeader(){try{const e='<div id="back-btn" class="ladichat-widget-header-back-btn">\n                <span>\n                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><g fill="none"><g fill="#FFF"><polygon transform="translate(-40 -29)translate(47.071068 36.071068)rotate(-315)translate(-47.071068 -36.071068)" points="44.3 38.8 44.3 31.1 42.1 31.1 42.1 40 42.1 41.1 52.1 41.1 52.1 38.8"></polygon></g></g></svg>\n                </span>\n            </div>',t=document.createElement("div");t.innerHTML=e.trim();const n=t.firstChild,i=document.createElement("div");i.setAttribute("id","ladichat-widget-header"),i.setAttribute("class","ladichat-widget-header"),i.appendChild(n);let a={avatar:LadiChat_Config.defaultStaffAvatar,name:this.storeConfig.store_info.name,is_away:!1};if(this.conversation){const e=LadiChat_Config.getStaffInfo(this.conversation.assign_id,this.storeConfig);e&&(a=e)}const o=document.createElement("div"),s=a.is_away?'<span class="ladichat-agent-online"></span>':'<span class="ladichat-agent-offline"></span>';return o.innerHTML=`<div class="ladichat-widget-header-option">\n                    <div id="slider" class="ladichat-widget-header-avatar slide-in">\n                        <img class="ladichat-header-avatar-image" src="${a.avatar?a.avatar:LadiChat_Config.defaultStaffAvatar}">\n                        <div><span class="ladichat-agent-name">`+a.name+"\n                        "+s+'\n                        </span>\n                        <span class="ladichat-agent-group">Hỗ trợ kỹ thuật</span>\n                        </div>\n                    </div>\n                </div>',i.appendChild(o.firstChild),i}catch(e){return console.log(e),null}}generateInputBox(){const e=document.createElement("div");return e.innerHTML='<div placeholder="Viết tin trả lời" contenteditable="true" tabindex="-1" id="ladichat-typing-message"></div>',e.firstChild}generateHTMLContent(){try{const e=document.createElement("div"),t=this.generateHeader();e.appendChild(t);const n=document.createElement("div");n.setAttribute("class","ladichat-widget-body"),n.setAttribute("id","ladichat-list-msg-scroll"),e.appendChild(n);const i=document.createElement("div");i.setAttribute("id","ladichat-conversation-list-message"),i.setAttribute("class","ladichat-conversation list-message"),n.appendChild(i);const a=document.createElement("div");a.setAttribute("class","ladichat-widget-footer"),e.appendChild(a);const o=document.createElement("div");o.setAttribute("id","ladichat-footer-typing"),a.appendChild(o);const s=this.generateInputBox();o.appendChild(s);const r=document.createElement("div");r.setAttribute("id","ladichat-footer-medias"),o.appendChild(r);const c=document.createElement("label");c.setAttribute("for","image-upload-message");const l=document.createElement("a");l.setAttribute("id","ladichat-send-image"),l.innerHTML='<svg width="18px" height="18px" viewBox="0 0 18 18" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n                <defs>\n                    <path d="M16.7142857,18 C17.0892857,18 17.3973214,17.8794643 17.6383929,17.6383929 C17.8794643,17.3973214 18,17.0892857 18,16.7142857 L18,1.28571429 C18,0.910714286 17.8794643,0.602678571 17.6383929,0.361607143 C17.3973214,0.120535714 17.0892857,0 16.7142857,0 L1.28571429,0 C0.910714286,0 0.602678571,0.120535714 0.361607143,0.361607143 C0.120535714,0.602678571 0,0.910714286 0,1.28571429 L0,16.7142857 C0,17.0892857 0.120535714,17.3973214 0.361607143,17.6383929 C0.602678571,17.8794643 0.910714286,18 1.28571429,18 L16.7142857,18 Z M6.26785714,6.75 C5.78571429,6.75 5.37053571,6.57589286 5.02232143,6.22767857 C4.67410714,5.87946429 4.5,5.46428571 4.5,4.98214286 C4.5,4.5 4.67410714,4.08482143 5.02232143,3.73660714 C5.37053571,3.38839286 5.78571429,3.21428571 6.26785714,3.21428571 C6.75,3.21428571 7.16517857,3.38839286 7.51339286,3.73660714 C7.86160714,4.08482143 8.03571429,4.5 8.03571429,4.98214286 C8.03571429,5.46428571 7.86160714,5.87946429 7.51339286,6.22767857 C7.16517857,6.57589286 6.75,6.75 6.26785714,6.75 Z M15.75,14.1428571 L2.25,14.1428571 C2.14285714,14.1428571 2.04910714,14.0892857 1.96875,13.9821429 C1.88839286,13.875 1.90178571,13.7678571 2.00892857,13.6607143 L4.58035714,9.48214286 C4.63392857,9.375 4.71428571,9.32142857 4.82142857,9.32142857 C4.92857143,9.32142857 5.00892857,9.34821429 5.0625,9.40178571 L7.39285714,11.9732143 L11.0089286,6.58928571 C11.0625,6.48214286 11.1428571,6.42857143 11.25,6.42857143 C11.3571429,6.42857143 11.4375,6.48214286 11.4910714,6.58928571 L15.9910714,13.6607143 C16.0982143,13.7678571 16.125,13.875 16.0714286,13.9821429 C15.9642857,14.0892857 15.8571429,14.1428571 15.75,14.1428571 Z" id="path-1"></path>\n                </defs>\n                <g id="Protype" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">\n                    <g id="" fill-rule="nonzero">\n                        <use fill="#A8C7FB" xlink:href="#path-1"></use>\n                        <use fill-opacity="0.5" fill="#44566C" xlink:href="#path-1"></use>\n                    </g>\n                </g>\n            </svg>',c.appendChild(l),r.appendChild(c);const h=document.createElement("input");h.setAttribute("id","file-upload-message"),h.setAttribute("type","file"),h.setAttribute("accept",".doc,.txt,.pdf,.csv"),h.setAttribute("multiple","true"),r.appendChild(h);const d=document.createElement("label");d.setAttribute("for","file-upload-message");const u=document.createElement("a");u.setAttribute("id","ladichat-send-document"),u.innerHTML='<?xml version="1.0" encoding="UTF-8"?>\n            <svg width="18px" height="18px" viewBox="0 0 18 18" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n                <title></title>\n                <defs>\n                    <path d="M6.3984375,17.296875 C8.0390625,17.296875 9.3515625,16.734375 10.3359375,15.609375 L10.3359375,15.609375 L16.9453125,9 C17.0859375,8.859375 17.15625,8.68359375 17.15625,8.47265625 C17.15625,8.26171875 17.0859375,8.0859375 16.9453125,7.9453125 C16.8046875,7.8046875 16.6289062,7.734375 16.4179688,7.734375 C16.2070312,7.734375 16.03125,7.8046875 15.890625,7.9453125 L15.890625,7.9453125 L9.28125,14.5546875 C8.765625,15.0703125 8.14453125,15.421875 7.41796875,15.609375 C6.69140625,15.796875 5.9765625,15.796875 5.2734375,15.609375 C4.5703125,15.421875 3.9609375,15.0703125 3.4453125,14.5546875 C2.6484375,13.6640625 2.25,12.6796875 2.25,11.6015625 C2.25,11.0390625 2.35546875,10.5117188 2.56640625,10.0195312 C2.77734375,9.52734375 3.0703125,9.09375 3.4453125,8.71875 L3.4453125,8.71875 L9.28125,2.8828125 C9.796875,2.3203125 10.40625,2.0390625 11.109375,2.0390625 C11.8125,2.0390625 12.421875,2.3203125 12.9375,2.8828125 C13.453125,3.4453125 13.7109375,4.078125 13.7109375,4.78125 C13.7109375,5.484375 13.4765625,6.09375 13.0078125,6.609375 L13.0078125,6.609375 L7.6640625,11.953125 C7.4296875,12.140625 7.16015625,12.234375 6.85546875,12.234375 C6.55078125,12.234375 6.29296875,12.1289062 6.08203125,11.9179688 C5.87109375,11.7070312 5.765625,11.4492188 5.765625,11.1445312 C5.765625,10.8398438 5.859375,10.5703125 6.046875,10.3359375 L6.046875,10.3359375 L10.546875,5.8359375 C10.734375,5.6953125 10.828125,5.51953125 10.828125,5.30859375 C10.828125,5.09765625 10.7460938,4.921875 10.5820312,4.78125 C10.4179688,4.640625 10.2421875,4.5703125 10.0546875,4.5703125 C9.8671875,4.5703125 9.6796875,4.640625 9.4921875,4.78125 L9.4921875,4.78125 L4.9921875,9.28125 C4.4765625,9.796875 4.21875,10.4179688 4.21875,11.1445312 C4.21875,11.8710937 4.48828125,12.5039062 5.02734375,13.0429688 C5.56640625,13.5820312 6.19921875,13.8515625 6.92578125,13.8515625 C7.65234375,13.8515625 8.2734375,13.59375 8.7890625,13.078125 L8.7890625,13.078125 L14.1328125,7.734375 C14.6484375,7.171875 15,6.5390625 15.1875,5.8359375 C15.375,5.1328125 15.375,4.4296875 15.1875,3.7265625 C15,3.0234375 14.6367188,2.4140625 14.0976562,1.8984375 C13.5585938,1.3828125 12.9257812,1.03125 12.1992188,0.84375 C11.4726562,0.65625 10.7578125,0.65625 10.0546875,0.84375 C9.3515625,1.03125 8.7421875,1.3828125 8.2265625,1.8984375 L8.2265625,1.8984375 L2.390625,7.734375 C1.875,8.25 1.4765625,8.84765625 1.1953125,9.52734375 C0.9140625,10.2070312 0.7734375,10.921875 0.7734375,11.671875 C0.7734375,12.421875 0.9140625,13.1484375 1.1953125,13.8515625 C1.4765625,14.5546875 1.88671875,15.1757812 2.42578125,15.7148438 C2.96484375,16.2539062 3.57421875,16.6523438 4.25390625,16.9101562 C4.93359375,17.1679688 5.6484375,17.296875 6.3984375,17.296875 Z" id="path-2"></path>\n                </defs>\n                <g id="Protype" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">\n                    <g id="" fill-rule="nonzero">\n                        <use fill="#A8C7FB" xlink:href="#path-2"></use>\n                        <use fill-opacity="0.5" fill="#44566C" xlink:href="#path-2"></use>\n                    </g>\n                </g>\n            </svg>',d.appendChild(u),r.appendChild(d);const f=document.createElement("input");f.setAttribute("id","image-upload-message"),f.setAttribute("data-tooltip","Gửi ảnh"),f.setAttribute("data-tooltip-position","top"),f.setAttribute("type","file"),f.setAttribute("accept","image/*"),f.setAttribute("multiple","true"),r.appendChild(f);const p=document.createElement("label"),g=document.createElement("a");g.setAttribute("id","ladichat-send-icon"),g.innerHTML='<?xml version="1.0" encoding="UTF-8"?>\n            <svg width="18px" height="18px" viewBox="0 0 18 18" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n                <title>Group</title>\n                <g id="Protype" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">\n                    <g id="Group" fill-rule="nonzero">\n                        <g id="path-1-link" fill="#A8C7FB">\n                            <path d="M9,18 C10.640625,18 12.140625,17.5898438 13.5,16.7695312 C14.859375,15.9492188 15.9492188,14.859375 16.7695312,13.5 C17.5898438,12.140625 18,10.640625 18,9 C18,7.359375 17.5898438,5.859375 16.7695312,4.5 C15.9492188,3.140625 14.859375,2.05078125 13.5,1.23046875 C12.140625,0.41015625 10.640625,0 9,0 C7.359375,0 5.859375,0.41015625 4.5,1.23046875 C3.140625,2.05078125 2.05078125,3.140625 1.23046875,4.5 C0.41015625,5.859375 0,7.359375 0,9 C0,10.640625 0.41015625,12.140625 1.23046875,13.5 C2.05078125,14.859375 3.140625,15.9492188 4.5,16.7695312 C5.859375,17.5898438 7.359375,18 9,18 Z M9,15.75 C7.78125,15.75 6.65625,15.4453125 5.625,14.8359375 C4.59375,14.2265625 3.7734375,13.40625 3.1640625,12.375 C2.5546875,11.34375 2.25,10.21875 2.25,9 C2.25,7.78125 2.5546875,6.65625 3.1640625,5.625 C3.7734375,4.59375 4.59375,3.7734375 5.625,3.1640625 C6.65625,2.5546875 7.78125,2.25 9,2.25 C10.21875,2.25 11.34375,2.5546875 12.375,3.1640625 C13.40625,3.7734375 14.2265625,4.59375 14.8359375,5.625 C15.4453125,6.65625 15.75,7.78125 15.75,9 C15.75,10.21875 15.4453125,11.34375 14.8359375,12.375 C14.2265625,13.40625 13.40625,14.2265625 12.375,14.8359375 C11.34375,15.4453125 10.21875,15.75 9,15.75 Z M6.75,7.875 C7.078125,7.875 7.34765625,7.76953125 7.55859375,7.55859375 C7.76953125,7.34765625 7.875,7.078125 7.875,6.75 C7.875,6.421875 7.76953125,6.15234375 7.55859375,5.94140625 C7.34765625,5.73046875 7.078125,5.625 6.75,5.625 C6.421875,5.625 6.15234375,5.73046875 5.94140625,5.94140625 C5.73046875,6.15234375 5.625,6.421875 5.625,6.75 C5.625,7.078125 5.73046875,7.34765625 5.94140625,7.55859375 C6.15234375,7.76953125 6.421875,7.875 6.75,7.875 Z M11.25,7.875 C11.578125,7.875 11.8476562,7.76953125 12.0585938,7.55859375 C12.2695312,7.34765625 12.375,7.078125 12.375,6.75 C12.375,6.421875 12.2695312,6.15234375 12.0585938,5.94140625 C11.8476562,5.73046875 11.578125,5.625 11.25,5.625 C10.921875,5.625 10.6523438,5.73046875 10.4414062,5.94140625 C10.2304688,6.15234375 10.125,6.421875 10.125,6.75 C10.125,7.078125 10.2304688,7.34765625 10.4414062,7.55859375 C10.6523438,7.76953125 10.921875,7.875 11.25,7.875 Z M9,13.5 C9.9375,13.5 10.734375,13.171875 11.390625,12.515625 C12.046875,11.859375 12.375,11.0625 12.375,10.125 L5.625,10.125 C5.625,11.0625 5.953125,11.859375 6.609375,12.515625 C7.265625,13.171875 8.0625,13.5 9,13.5 Z" id="path-1"></path>\n                        </g>\n                        <g id="path-1-link" fill="#44566C" fill-opacity="0.5">\n                            <path d="M9,18 C10.640625,18 12.140625,17.5898438 13.5,16.7695312 C14.859375,15.9492188 15.9492188,14.859375 16.7695312,13.5 C17.5898438,12.140625 18,10.640625 18,9 C18,7.359375 17.5898438,5.859375 16.7695312,4.5 C15.9492188,3.140625 14.859375,2.05078125 13.5,1.23046875 C12.140625,0.41015625 10.640625,0 9,0 C7.359375,0 5.859375,0.41015625 4.5,1.23046875 C3.140625,2.05078125 2.05078125,3.140625 1.23046875,4.5 C0.41015625,5.859375 0,7.359375 0,9 C0,10.640625 0.41015625,12.140625 1.23046875,13.5 C2.05078125,14.859375 3.140625,15.9492188 4.5,16.7695312 C5.859375,17.5898438 7.359375,18 9,18 Z M9,15.75 C7.78125,15.75 6.65625,15.4453125 5.625,14.8359375 C4.59375,14.2265625 3.7734375,13.40625 3.1640625,12.375 C2.5546875,11.34375 2.25,10.21875 2.25,9 C2.25,7.78125 2.5546875,6.65625 3.1640625,5.625 C3.7734375,4.59375 4.59375,3.7734375 5.625,3.1640625 C6.65625,2.5546875 7.78125,2.25 9,2.25 C10.21875,2.25 11.34375,2.5546875 12.375,3.1640625 C13.40625,3.7734375 14.2265625,4.59375 14.8359375,5.625 C15.4453125,6.65625 15.75,7.78125 15.75,9 C15.75,10.21875 15.4453125,11.34375 14.8359375,12.375 C14.2265625,13.40625 13.40625,14.2265625 12.375,14.8359375 C11.34375,15.4453125 10.21875,15.75 9,15.75 Z M6.75,7.875 C7.078125,7.875 7.34765625,7.76953125 7.55859375,7.55859375 C7.76953125,7.34765625 7.875,7.078125 7.875,6.75 C7.875,6.421875 7.76953125,6.15234375 7.55859375,5.94140625 C7.34765625,5.73046875 7.078125,5.625 6.75,5.625 C6.421875,5.625 6.15234375,5.73046875 5.94140625,5.94140625 C5.73046875,6.15234375 5.625,6.421875 5.625,6.75 C5.625,7.078125 5.73046875,7.34765625 5.94140625,7.55859375 C6.15234375,7.76953125 6.421875,7.875 6.75,7.875 Z M11.25,7.875 C11.578125,7.875 11.8476562,7.76953125 12.0585938,7.55859375 C12.2695312,7.34765625 12.375,7.078125 12.375,6.75 C12.375,6.421875 12.2695312,6.15234375 12.0585938,5.94140625 C11.8476562,5.73046875 11.578125,5.625 11.25,5.625 C10.921875,5.625 10.6523438,5.73046875 10.4414062,5.94140625 C10.2304688,6.15234375 10.125,6.421875 10.125,6.75 C10.125,7.078125 10.2304688,7.34765625 10.4414062,7.55859375 C10.6523438,7.76953125 10.921875,7.875 11.25,7.875 Z M9,13.5 C9.9375,13.5 10.734375,13.171875 11.390625,12.515625 C12.046875,11.859375 12.375,11.0625 12.375,10.125 L5.625,10.125 C5.625,11.0625 5.953125,11.859375 6.609375,12.515625 C7.265625,13.171875 8.0625,13.5 9,13.5 Z" id="path-1"></path>\n                        </g>\n                    </g>\n                </g>\n            </svg>',p.appendChild(g),r.appendChild(p);const m=document.createElement("label"),_=document.createElement("a");return _.setAttribute("id","ladichat-send-button"),_.innerHTML='<svg width="18px" height="18px" viewBox="0 0 18 18" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n                <defs>\n                    <path d="M11.8828125,17.4375 C12.1171875,17.390625 12.28125,17.25 12.375,17.015625 L17.4375,1.265625 C17.484375,1.078125 17.4375,0.890625 17.296875,0.703125 C17.109375,0.5625 16.921875,0.515625 16.734375,0.5625 L0.984375,5.625 C0.75,5.71875 0.609375,5.8828125 0.5625,6.1171875 C0.515625,6.3515625 0.609375,6.5390625 0.84375,6.6796875 L6.3984375,9.9140625 L11.8125,6.1875 L8.0859375,11.6015625 L11.3203125,17.15625 C11.4140625,17.34375 11.578125,17.4375 11.8125,17.4375 L11.8828125,17.4375 Z" id="path-3"></path>\n                </defs>\n                <g id="Protype" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">\n                    <g id="" fill-rule="nonzero">\n                        <use fill="#FFFFFF" xlink:href="#path-3"></use>\n                        <use fill="#A8C7FB" xlink:href="#path-3"></use>\n                        <use fill-opacity="0.5" fill="#44566C" xlink:href="#path-3"></use>\n                    </g>\n                </g>\n            </svg>',m.appendChild(_),r.appendChild(m),this.emoji=new Emoji,e.appendChild(this.emoji.doom_element),e}catch(e){return console.log(e),null}}async getListMessage(){try{const e={token:this.token,conversation_id:this.conversation._id},t=await LadiChat_Helper.sendPOSTRequest(LadiChat_Static_Config.END_POINT,LadiChat_Config.API_ROUTE.LIST_MESSAGE,e);200==t.code&&(this.listMessage=[],this.listMessage=t.data.messages,this.reloadMessagesList())}catch(e){console.log(e)}}linkAllMessage(){try{const e={attributes:null,className:"linkified",defaultProtocol:"http",events:null,format:function(e,t){return e},formatHref:function(e,t){return e},ignoreTags:[],nl2br:!1,tagName:"a",target:{url:"_blank"},validate:!0};linkifyElement(this.chatWidgetMessageList,e,this.mainDocument)}catch(e){console.log(e)}}reloadMessagesList(e=!1){this.chatWidgetMessageList.innerHTML="";const t=document.createElement("span");t.setAttribute("id","ladichat-powered-by"),t.innerHTML="Powered by ";const n=document.createElement("a");n.setAttribute("id","ladichat-powered-by-link"),n.setAttribute("href","https://ladipage.vn"),n.setAttribute("target","_blank"),n.innerHTML=" LadiPage",t.appendChild(n),this.chatWidgetMessageList.appendChild(t);let i=!0,a=!1,o=!1,s=!1;for(let e=this.listMessage.length-1;e>=0;e--){const t=this.listMessage[e];t.sender_id==this.storeConfig.user_info._id&&(t.type="SENT",!this.indexShowRead&&t.read_users.length>1&&(this.indexShowRead=t._id)),t.sender_id!=this.storeConfig.user_info._id&&(t.type="RECIEVE")}null===this.indexShowRead&&this.listMessage.length>0&&(this.indexShowRead=this.listMessage[0]._id);for(let t=0;t<this.listMessage.length;t++){const n=this.listMessage[t];let r=!1,c=!1,l={};if(a&&a==n.type||(a=n.type,i=!0),t+1<this.listMessage.length&&(o=this.listMessage[t+1].type),t==this.listMessage.length-1&&(i=!0),o&&o!==a&&(i=!0),t+1<=this.listMessage.length-1){const e=new Date(this.listMessage[t+1].created_at),a=new Date(n.created_at);i=LadiChat_Helper.diffDateMinute(e,a)>5}if(n.sender_id==this.storeConfig.user_info._id){const e=n._id==this.indexShowRead;e&&(i=!0),l=new MessageSent,n._id&&(n.resendData=null),l.init(n,this.conversation,this.storeConfig,i,e),r=l.doom_element,n.type="SENT",s=!1}n.sender_id!=this.storeConfig.user_info._id&&(l=new MessageRecieve,s&&s==n.sender_id||(c=!0,s=n.sender_id),l.init(n,this.conversation,this.storeConfig,i,c),r=l.doom_element,n.type="RECIEVE",(!n.read_users||n.read_users.indexOf(this.storeConfig.user_info._id)<0)&&(this.lastUnread||e||(this.lastUnread=r),this.listUnreadMessage.push(n))),this.listMessage[t].ref=l,this.listMessage[t].widget_element=r,this.chatWidgetMessageList.appendChild(r)}for(let e=0;e<this.listTyping.length;e++){const t=this.listTyping[e],n=new MessageTyping;n.init(t.ladi_uid,this.conversation,this.storeConfig),this.chatWidgetMessageList.appendChild(n.doom_element)}const r=this;!e&&this.lastUnread?setTimeout((function(){r.lastUnread.scrollIntoView(!0),r.lastUnread=!1}),100):setTimeout((function(){r.listMessage[r.listMessage.length-1].widget_element.scrollIntoView(!0)}),100),this.linkAllMessage()}}class Emoji{constructor(){const e=this.generateHTMLContent();this.doom_element=e,this.listFilter=[]}filterKey(e){return Object.keys(listEmoji).filter((function(t){return t.indexOf(e.toLowerCase())>=0})).reduce((function(e,t){return e[t]=listEmoji[t],e}),{})}loadContent(e){for(var t in listEmoji){if(!listEmoji.hasOwnProperty(t))continue;let n=this.buildItem(t,listEmoji[t]);e.appendChild(n)}}buildItem(e,t){const n=`<div class="ladichat-emoji-item" data-emoji="${t}"><span title=${e}>${t}</span></div>`,i=document.createElement("div");return i.innerHTML=n.trim(),i.firstChild}generateHTMLContent(){const e=document.createElement("div");e.setAttribute("class","ladiui-modal"),e.setAttribute("data-dissmiss","modal-ladichat-emoji"),e.setAttribute("id","modal-ladichat-emoji");const t=document.createElement("div");t.innerHTML='<div class="ladichat-emoji" id="ladichat-emoji">\n                <div class="ladichat-search-emoji">\n                    <input type="text" id="search-emoji" placeholder="Tìm theo tên hoặc nội dung" name="id" class="ladiui input" value="">\n                    <i class="ladi-icon icon-zoom"></i>\n                </div>\n            </div>'.trim();const n=t.firstChild;e.appendChild(n);const i=document.createElement("div");return i.setAttribute("class","ladichat-emoji-all"),i.setAttribute("id","ladichat-emoji-all"),this.loadContent(i),n.appendChild(i),e}}const listEmoji={100:"💯",1234:"🔢",umbrella_with_rain_drops:"☔",coffee:"☕",aries:"♈",taurus:"♉",sagittarius:"♐",capricorn:"♑",aquarius:"♒",pisces:"♓",anchor:"⚓",white_check_mark:"✅",sparkles:"✨",question:"❓",grey_question:"❔",grey_exclamation:"❕",exclamation:"❗",heavy_exclamation_mark:"❗",heavy_plus_sign:"➕",heavy_minus_sign:"➖",heavy_division_sign:"➗",hash:"#️⃣",keycap_star:"*️⃣",zero:"0️⃣",one:"1️⃣",two:"2️⃣",three:"3️⃣",four:"4️⃣",five:"5️⃣",six:"6️⃣",seven:"7️⃣",eight:"8️⃣",nine:"9️⃣",copyright:"©️",registered:"®️",mahjong:"🀄",black_joker:"🃏",a:"🅰️",b:"🅱️",o2:"🅾️",parking:"🅿️",ab:"🆎",cl:"🆑",cool:"🆒",free:"🆓",id:"🆔",new:"🆕",ng:"🆖",ok:"🆗",sos:"🆘",up:"🆙",vs:"🆚","flag-ac":"🇦🇨","flag-ad":"🇦🇩","flag-ae":"🇦🇪","flag-af":"🇦🇫","flag-ag":"🇦🇬","flag-ai":"🇦🇮","flag-al":"🇦🇱","flag-am":"🇦🇲","flag-ao":"🇦🇴","flag-aq":"🇦🇶","flag-ar":"🇦🇷","flag-as":"🇦🇸","flag-at":"🇦🇹","flag-au":"🇦🇺","flag-aw":"🇦🇼","flag-ax":"🇦🇽","flag-az":"🇦🇿","flag-ba":"🇧🇦","flag-bb":"🇧🇧","flag-bd":"🇧🇩","flag-be":"🇧🇪","flag-bf":"🇧🇫","flag-bg":"🇧🇬","flag-bh":"🇧🇭","flag-bi":"🇧🇮","flag-bj":"🇧🇯","flag-bl":"🇧🇱","flag-bm":"🇧🇲","flag-bn":"🇧🇳","flag-bo":"🇧🇴","flag-bq":"🇧🇶","flag-br":"🇧🇷","flag-bs":"🇧🇸","flag-bt":"🇧🇹","flag-bv":"🇧🇻","flag-bw":"🇧🇼","flag-by":"🇧🇾","flag-bz":"🇧🇿","flag-ca":"🇨🇦","flag-cc":"🇨🇨","flag-cd":"🇨🇩","flag-cf":"🇨🇫","flag-cg":"🇨🇬","flag-ch":"🇨🇭","flag-ci":"🇨🇮","flag-ck":"🇨🇰","flag-cl":"🇨🇱","flag-cm":"🇨🇲",cn:"🇨🇳","flag-cn":"🇨🇳","flag-co":"🇨🇴","flag-cp":"🇨🇵","flag-cr":"🇨🇷","flag-cu":"🇨🇺","flag-cv":"🇨🇻","flag-cw":"🇨🇼","flag-cx":"🇨🇽","flag-cy":"🇨🇾","flag-cz":"🇨🇿",de:"🇩🇪","flag-de":"🇩🇪","flag-dg":"🇩🇬","flag-dj":"🇩🇯","flag-dk":"🇩🇰","flag-dm":"🇩🇲","flag-do":"🇩🇴","flag-dz":"🇩🇿","flag-ea":"🇪🇦","flag-ec":"🇪🇨","flag-ee":"🇪🇪","flag-eg":"🇪🇬","flag-eh":"🇪🇭","flag-er":"🇪🇷",es:"🇪🇸","flag-es":"🇪🇸","flag-et":"🇪🇹","flag-eu":"🇪🇺","flag-fi":"🇫🇮","flag-fj":"🇫🇯","flag-fk":"🇫🇰","flag-fm":"🇫🇲","flag-fo":"🇫🇴",fr:"🇫🇷","flag-fr":"🇫🇷","flag-ga":"🇬🇦",gb:"🇬🇧",uk:"🇬🇧","flag-gb":"🇬🇧","flag-gd":"🇬🇩","flag-ge":"🇬🇪","flag-gf":"🇬🇫","flag-gg":"🇬🇬","flag-gh":"🇬🇭","flag-gi":"🇬🇮","flag-gl":"🇬🇱","flag-gm":"🇬🇲","flag-gn":"🇬🇳","flag-gp":"🇬🇵","flag-gq":"🇬🇶","flag-gr":"🇬🇷","flag-gs":"🇬🇸","flag-gt":"🇬🇹","flag-gu":"🇬🇺","flag-gw":"🇬🇼","flag-gy":"🇬🇾","flag-hk":"🇭🇰","flag-hm":"🇭🇲","flag-hn":"🇭🇳","flag-hr":"🇭🇷","flag-ht":"🇭🇹","flag-hu":"🇭🇺","flag-ic":"🇮🇨","flag-id":"🇮🇩","flag-ie":"🇮🇪","flag-il":"🇮🇱","flag-im":"🇮🇲","flag-in":"🇮🇳","flag-io":"🇮🇴","flag-iq":"🇮🇶","flag-ir":"🇮🇷","flag-is":"🇮🇸",it:"🇮🇹","flag-it":"🇮🇹","flag-je":"🇯🇪","flag-jm":"🇯🇲","flag-jo":"🇯🇴",jp:"🇯🇵","flag-jp":"🇯🇵","flag-ke":"🇰🇪","flag-kg":"🇰🇬","flag-kh":"🇰🇭","flag-ki":"🇰🇮","flag-km":"🇰🇲","flag-kn":"🇰🇳","flag-kp":"🇰🇵",kr:"🇰🇷","flag-kr":"🇰🇷","flag-kw":"🇰🇼","flag-ky":"🇰🇾","flag-kz":"🇰🇿","flag-la":"🇱🇦","flag-lb":"🇱🇧","flag-lc":"🇱🇨","flag-li":"🇱🇮","flag-lk":"🇱🇰","flag-lr":"🇱🇷","flag-ls":"🇱🇸","flag-lt":"🇱🇹","flag-lu":"🇱🇺","flag-lv":"🇱🇻","flag-ly":"🇱🇾","flag-ma":"🇲🇦","flag-mc":"🇲🇨","flag-md":"🇲🇩","flag-me":"🇲🇪","flag-mf":"🇲🇫","flag-mg":"🇲🇬","flag-mh":"🇲🇭","flag-mk":"🇲🇰","flag-ml":"🇲🇱","flag-mm":"🇲🇲","flag-mn":"🇲🇳","flag-mo":"🇲🇴","flag-mp":"🇲🇵","flag-mq":"🇲🇶","flag-mr":"🇲🇷","flag-ms":"🇲🇸","flag-mt":"🇲🇹","flag-mu":"🇲🇺","flag-mv":"🇲🇻","flag-mw":"🇲🇼","flag-mx":"🇲🇽","flag-my":"🇲🇾","flag-mz":"🇲🇿","flag-na":"🇳🇦","flag-nc":"🇳🇨","flag-ne":"🇳🇪","flag-nf":"🇳🇫","flag-ng":"🇳🇬","flag-ni":"🇳🇮","flag-nl":"🇳🇱","flag-no":"🇳🇴","flag-np":"🇳🇵","flag-nr":"🇳🇷","flag-nu":"🇳🇺","flag-nz":"🇳🇿","flag-om":"🇴🇲","flag-pa":"🇵🇦","flag-pe":"🇵🇪","flag-pf":"🇵🇫","flag-pg":"🇵🇬","flag-ph":"🇵🇭","flag-pk":"🇵🇰","flag-pl":"🇵🇱","flag-pm":"🇵🇲","flag-pn":"🇵🇳","flag-pr":"🇵🇷","flag-ps":"🇵🇸","flag-pt":"🇵🇹","flag-pw":"🇵🇼","flag-py":"🇵🇾","flag-qa":"🇶🇦","flag-re":"🇷🇪","flag-ro":"🇷🇴","flag-rs":"🇷🇸",ru:"🇷🇺","flag-ru":"🇷🇺","flag-rw":"🇷🇼","flag-sa":"🇸🇦","flag-sb":"🇸🇧","flag-sc":"🇸🇨","flag-sd":"🇸🇩","flag-se":"🇸🇪","flag-sg":"🇸🇬","flag-sh":"🇸🇭","flag-si":"🇸🇮","flag-sj":"🇸🇯","flag-sk":"🇸🇰","flag-sl":"🇸🇱","flag-sm":"🇸🇲","flag-sn":"🇸🇳","flag-so":"🇸🇴","flag-sr":"🇸🇷","flag-ss":"🇸🇸","flag-st":"🇸🇹","flag-sv":"🇸🇻","flag-sx":"🇸🇽","flag-sy":"🇸🇾","flag-sz":"🇸🇿","flag-ta":"🇹🇦","flag-tc":"🇹🇨","flag-td":"🇹🇩","flag-tf":"🇹🇫","flag-tg":"🇹🇬","flag-th":"🇹🇭","flag-tj":"🇹🇯","flag-tk":"🇹🇰","flag-tl":"🇹🇱","flag-tm":"🇹🇲","flag-tn":"🇹🇳","flag-to":"🇹🇴","flag-tr":"🇹🇷","flag-tt":"🇹🇹","flag-tv":"🇹🇻","flag-tw":"🇹🇼","flag-tz":"🇹🇿","flag-ua":"🇺🇦","flag-ug":"🇺🇬","flag-um":"🇺🇲","flag-un":"🇺🇳",us:"🇺🇸","flag-us":"🇺🇸","flag-uy":"🇺🇾","flag-uz":"🇺🇿","flag-va":"🇻🇦","flag-vc":"🇻🇨","flag-ve":"🇻🇪","flag-vg":"🇻🇬","flag-vi":"🇻🇮","flag-vn":"🇻🇳","flag-vu":"🇻🇺","flag-wf":"🇼🇫","flag-ws":"🇼🇸","flag-xk":"🇽🇰","flag-ye":"🇾🇪","flag-yt":"🇾🇹","flag-za":"🇿🇦","flag-zm":"🇿🇲","flag-zw":"🇿🇼",koko:"🈁",sa:"🈂️",u7121:"🈚",u6307:"🈯",u7981:"🈲",u7a7a:"🈳",u5408:"🈴",u6e80:"🈵",u6709:"🈶",u6708:"🈷️",u7533:"🈸",u5272:"🈹",u55b6:"🈺",ideograph_advantage:"🉐",accept:"🉑",cyclone:"🌀",foggy:"🌁",closed_umbrella:"🌂",night_with_stars:"🌃",sunrise_over_mountains:"🌄",sunrise:"🌅",city_sunset:"🌆",city_sunrise:"🌇",rainbow:"🌈",bridge_at_night:"🌉",ocean:"🌊",volcano:"🌋",milky_way:"🌌",earth_africa:"🌍",earth_americas:"🌎",earth_asia:"🌏",globe_with_meridians:"🌐",new_moon:"🌑",waxing_crescent_moon:"🌒",first_quarter_moon:"🌓",moon:"🌔",waxing_gibbous_moon:"🌔",full_moon:"🌕",waning_gibbous_moon:"🌖",last_quarter_moon:"🌗",waning_crescent_moon:"🌘",crescent_moon:"🌙",new_moon_with_face:"🌚",first_quarter_moon_with_face:"🌛",last_quarter_moon_with_face:"🌜",full_moon_with_face:"🌝",sun_with_face:"🌞",star2:"🌟",stars:"🌠",thermometer:"🌡️",mostly_sunny:"🌤️",sun_small_cloud:"🌤️",barely_sunny:"🌥️",sun_behind_cloud:"🌥️",partly_sunny_rain:"🌦️",sun_behind_rain_cloud:"🌦️",rain_cloud:"🌧️",snow_cloud:"🌨️",lightning:"🌩️",lightning_cloud:"🌩️",tornado:"🌪️",tornado_cloud:"🌪️",fog:"🌫️",wind_blowing_face:"🌬️",hotdog:"🌭",taco:"🌮",burrito:"🌯",chestnut:"🌰",seedling:"🌱",evergreen_tree:"🌲",deciduous_tree:"🌳",palm_tree:"🌴",cactus:"🌵",hot_pepper:"🌶️",tulip:"🌷",cherry_blossom:"🌸",rose:"🌹",hibiscus:"🌺",sunflower:"🌻",blossom:"🌼",corn:"🌽",ear_of_rice:"🌾",herb:"🌿",four_leaf_clover:"🍀",maple_leaf:"🍁",fallen_leaf:"🍂",leaves:"🍃",mushroom:"🍄",tomato:"🍅",eggplant:"🍆",grapes:"🍇",melon:"🍈",watermelon:"🍉",tangerine:"🍊",lemon:"🍋",banana:"🍌",pineapple:"🍍",apple:"🍎",green_apple:"🍏",pear:"🍐",peach:"🍑",cherries:"🍒",strawberry:"🍓",hamburger:"🍔",pizza:"🍕",meat_on_bone:"🍖",poultry_leg:"🍗",rice_cracker:"🍘",rice_ball:"🍙",rice:"🍚",curry:"🍛",ramen:"🍜",spaghetti:"🍝",bread:"🍞",fries:"🍟",sweet_potato:"🍠",dango:"🍡",oden:"🍢",sushi:"🍣",fried_shrimp:"🍤",fish_cake:"🍥",icecream:"🍦",shaved_ice:"🍧",ice_cream:"🍨",doughnut:"🍩",cookie:"🍪",chocolate_bar:"🍫",candy:"🍬",lollipop:"🍭",custard:"🍮",honey_pot:"🍯",cake:"🍰",bento:"🍱",stew:"🍲",fried_egg:"🍳",cooking:"🍳",fork_and_knife:"🍴",tea:"🍵",sake:"🍶",wine_glass:"🍷",cocktail:"🍸",tropical_drink:"🍹",beer:"🍺",beers:"🍻",baby_bottle:"🍼",knife_fork_plate:"🍽️",champagne:"🍾",popcorn:"🍿",ribbon:"🎀",gift:"🎁",birthday:"🎂",jack_o_lantern:"🎃",christmas_tree:"🎄",santa:"🎅",fireworks:"🎆",sparkler:"🎇",balloon:"🎈",tada:"🎉",confetti_ball:"🎊",tanabata_tree:"🎋",crossed_flags:"🎌",bamboo:"🎍",dolls:"🎎",flags:"🎏",wind_chime:"🎐",rice_scene:"🎑",school_satchel:"🎒",mortar_board:"🎓",medal:"🎖️",reminder_ribbon:"🎗️",studio_microphone:"🎙️",level_slider:"🎚️",control_knobs:"🎛️",film_frames:"🎞️",admission_tickets:"🎟️",carousel_horse:"🎠",ferris_wheel:"🎡",roller_coaster:"🎢",fishing_pole_and_fish:"🎣",microphone:"🎤",movie_camera:"🎥",cinema:"🎦",headphones:"🎧",art:"🎨",tophat:"🎩",circus_tent:"🎪",ticket:"🎫",clapper:"🎬",performing_arts:"🎭",video_game:"🎮",dart:"🎯",slot_machine:"🎰","8ball":"🎱",game_die:"🎲",bowling:"🎳",flower_playing_cards:"🎴",musical_note:"🎵",notes:"🎶",saxophone:"🎷",guitar:"🎸",musical_keyboard:"🎹",trumpet:"🎺",violin:"🎻",musical_score:"🎼",running_shirt_with_sash:"🎽",tennis:"🎾",ski:"🎿",basketball:"🏀",checkered_flag:"🏁",snowboarder:"🏂","woman-running":"🏃‍♀️","man-running":"🏃‍♂️",runner:"🏃‍♂️",running:"🏃‍♂️","woman-surfing":"🏄‍♀️","man-surfing":"🏄‍♂️",surfer:"🏄‍♂️",sports_medal:"🏅",trophy:"🏆",horse_racing:"🏇",football:"🏈",rugby_football:"🏉","woman-swimming":"🏊‍♀️","man-swimming":"🏊‍♂️",swimmer:"🏊‍♂️","woman-lifting-weights":"🏋️‍♀️","man-lifting-weights":"🏋️‍♂️",weight_lifter:"🏋️‍♂️","woman-golfing":"🏌️‍♀️","man-golfing":"🏌️‍♂️",golfer:"🏌️‍♂️",racing_motorcycle:"🏍️",racing_car:"🏎️",cricket_bat_and_ball:"🏏",volleyball:"🏐",field_hockey_stick_and_ball:"🏑",ice_hockey_stick_and_puck:"🏒",table_tennis_paddle_and_ball:"🏓",snow_capped_mountain:"🏔️",camping:"🏕️",beach_with_umbrella:"🏖️",building_construction:"🏗️",house_buildings:"🏘️",cityscape:"🏙️",derelict_house_building:"🏚️",classical_building:"🏛️",desert:"🏜️",desert_island:"🏝️",national_park:"🏞️",stadium:"🏟️",house:"🏠",house_with_garden:"🏡",office:"🏢",post_office:"🏣",european_post_office:"🏤",hospital:"🏥",bank:"🏦",atm:"🏧",hotel:"🏨",love_hotel:"🏩",convenience_store:"🏪",school:"🏫",department_store:"🏬",factory:"🏭",izakaya_lantern:"🏮",lantern:"🏮",japanese_castle:"🏯",european_castle:"🏰","rainbow-flag":"🏳️‍🌈",waving_white_flag:"🏳️","flag-england":"🏴󠁧󠁢󠁥󠁮󠁧󠁿","flag-scotland":"🏴󠁧󠁢󠁳󠁣󠁴󠁿","flag-wales":"🏴󠁧󠁢󠁷󠁬󠁳󠁿",waving_black_flag:"🏴",rosette:"🏵️",label:"🏷️",badminton_racquet_and_shuttlecock:"🏸",bow_and_arrow:"🏹",amphora:"🏺","skin-tone-2":"🏻","skin-tone-3":"🏼","skin-tone-4":"🏽","skin-tone-5":"🏾","skin-tone-6":"🏿",rat:"🐀",mouse2:"🐁",ox:"🐂",water_buffalo:"🐃",cow2:"🐄",tiger2:"🐅",leopard:"🐆",rabbit2:"🐇",cat2:"🐈",dragon:"🐉",crocodile:"🐊",whale2:"🐋",snail:"🐌",snake:"🐍",racehorse:"🐎",ram:"🐏",goat:"🐐",sheep:"🐑",monkey:"🐒",rooster:"🐓",chicken:"🐔",dog2:"🐕",pig2:"🐖",boar:"🐗",elephant:"🐘",octopus:"🐙",shell:"🐚",bug:"🐛",ant:"🐜",bee:"🐝",honeybee:"🐝",beetle:"🐞",fish:"🐟",tropical_fish:"🐠",blowfish:"🐡",turtle:"🐢",hatching_chick:"🐣",baby_chick:"🐤",hatched_chick:"🐥",bird:"🐦",penguin:"🐧",koala:"🐨",poodle:"🐩",dromedary_camel:"🐪",camel:"🐫",dolphin:"🐬",flipper:"🐬",mouse:"🐭",cow:"🐮",tiger:"🐯",rabbit:"🐰",cat:"🐱",dragon_face:"🐲",whale:"🐳",horse:"🐴",monkey_face:"🐵",dog:"🐶",pig:"🐷",frog:"🐸",hamster:"🐹",wolf:"🐺",bear:"🐻",panda_face:"🐼",pig_nose:"🐽",feet:"🐾",paw_prints:"🐾",chipmunk:"🐿️",eyes:"👀","eye-in-speech-bubble":"👁️‍🗨️",eye:"👁️",ear:"👂",nose:"👃",lips:"👄",tongue:"👅",point_up_2:"👆",point_down:"👇",point_left:"👈",point_right:"👉",facepunch:"👊",punch:"👊",wave:"👋",ok_hand:"👌","+1":"👍",thumbsup:"👍","-1":"👎",thumbsdown:"👎",clap:"👏",open_hands:"👐",crown:"👑",womans_hat:"👒",eyeglasses:"👓",necktie:"👔",shirt:"👕",tshirt:"👕",jeans:"👖",dress:"👗",kimono:"👘",bikini:"👙",womans_clothes:"👚",purse:"👛",handbag:"👜",pouch:"👝",mans_shoe:"👞",shoe:"👞",athletic_shoe:"👟",high_heel:"👠",sandal:"👡",boot:"👢",footprints:"👣",bust_in_silhouette:"👤",busts_in_silhouette:"👥",boy:"👦",girl:"👧","male-farmer":"👨‍🌾","male-cook":"👨‍🍳","male-student":"👨‍🎓","male-singer":"👨‍🎤","male-artist":"👨‍🎨","male-teacher":"👨‍🏫","male-factory-worker":"👨‍🏭","man-boy-boy":"👨‍👦‍👦","man-boy":"👨‍👦","man-girl-boy":"👨‍👧‍👦","man-girl-girl":"👨‍👧‍👧","man-girl":"👨‍👧","man-man-boy":"👨‍👨‍👦","man-man-boy-boy":"👨‍👨‍👦‍👦","man-man-girl":"👨‍👨‍👧","man-man-girl-boy":"👨‍👨‍👧‍👦","man-man-girl-girl":"👨‍👨‍👧‍👧","man-woman-boy":"👨‍👩‍👦",family:"👨‍👩‍👦","man-woman-boy-boy":"👨‍👩‍👦‍👦","man-woman-girl":"👨‍👩‍👧","man-woman-girl-boy":"👨‍👩‍👧‍👦","man-woman-girl-girl":"👨‍👩‍👧‍👧","male-technologist":"👨‍💻","male-office-worker":"👨‍💼","male-mechanic":"👨‍🔧","male-scientist":"👨‍🔬","male-astronaut":"👨‍🚀","male-firefighter":"👨‍🚒","male-doctor":"👨‍⚕️","male-judge":"👨‍⚖️","male-pilot":"👨‍✈️","man-heart-man":"👨‍❤️‍👨","man-kiss-man":"👨‍❤️‍💋‍👨",man:"👨","female-farmer":"👩‍🌾","female-cook":"👩‍🍳","female-student":"👩‍🎓","female-singer":"👩‍🎤","female-artist":"👩‍🎨","female-teacher":"👩‍🏫","female-factory-worker":"👩‍🏭","woman-boy-boy":"👩‍👦‍👦","woman-boy":"👩‍👦","woman-girl-boy":"👩‍👧‍👦","woman-girl-girl":"👩‍👧‍👧","woman-girl":"👩‍👧","woman-woman-boy":"👩‍👩‍👦","woman-woman-boy-boy":"👩‍👩‍👦‍👦","woman-woman-girl":"👩‍👩‍👧","woman-woman-girl-boy":"👩‍👩‍👧‍👦","woman-woman-girl-girl":"👩‍👩‍👧‍👧","female-technologist":"👩‍💻","female-office-worker":"👩‍💼","female-mechanic":"👩‍🔧","female-scientist":"👩‍🔬","female-astronaut":"👩‍🚀","female-firefighter":"👩‍🚒","female-doctor":"👩‍⚕️","female-judge":"👩‍⚖️","female-pilot":"👩‍✈️","woman-heart-man":"👩‍❤️‍👨",couple_with_heart:"👩‍❤️‍👨","woman-heart-woman":"👩‍❤️‍👩","woman-kiss-man":"👩‍❤️‍💋‍👨",couplekiss:"👩‍❤️‍💋‍👨","woman-kiss-woman":"👩‍❤️‍💋‍👩",woman:"👩",couple:"👫",man_and_woman_holding_hands:"👫",two_men_holding_hands:"👬",two_women_holding_hands:"👭","female-police-officer":"👮‍♀️","male-police-officer":"👮‍♂️",cop:"👮‍♂️","woman-with-bunny-ears-partying":"👯‍♀️",dancers:"👯‍♀️","man-with-bunny-ears-partying":"👯‍♂️",bride_with_veil:"👰","blond-haired-woman":"👱‍♀️","blond-haired-man":"👱‍♂️",person_with_blond_hair:"👱‍♂️",man_with_gua_pi_mao:"👲","woman-wearing-turban":"👳‍♀️","man-wearing-turban":"👳‍♂️",man_with_turban:"👳‍♂️",older_man:"👴",older_woman:"👵",baby:"👶","female-construction-worker":"👷‍♀️","male-construction-worker":"👷‍♂️",construction_worker:"👷‍♂️",princess:"👸",japanese_ogre:"👹",japanese_goblin:"👺",ghost:"👻",angel:"👼",alien:"👽",space_invader:"👾",imp:"👿",skull:"💀","woman-tipping-hand":"💁‍♀️",information_desk_person:"💁‍♀️","man-tipping-hand":"💁‍♂️","female-guard":"💂‍♀️","male-guard":"💂‍♂️",guardsman:"💂‍♂️",dancer:"💃",lipstick:"💄",nail_care:"💅","woman-getting-massage":"💆‍♀️",massage:"💆‍♀️","man-getting-massage":"💆‍♂️","woman-getting-haircut":"💇‍♀️",haircut:"💇‍♀️","man-getting-haircut":"💇‍♂️",barber:"💈",syringe:"💉",pill:"💊",kiss:"💋",love_letter:"💌",ring:"💍",gem:"💎",bouquet:"💐",wedding:"💒",heartbeat:"💓",broken_heart:"💔",two_hearts:"💕",sparkling_heart:"💖",heartpulse:"💗",cupid:"💘",blue_heart:"💙",green_heart:"💚",yellow_heart:"💛",purple_heart:"💜",gift_heart:"💝",revolving_hearts:"💞",heart_decoration:"💟",diamond_shape_with_a_dot_inside:"💠",bulb:"💡",anger:"💢",bomb:"💣",zzz:"💤",boom:"💥",collision:"💥",sweat_drops:"💦",droplet:"💧",dash:"💨",hankey:"💩",poop:"💩",shit:"💩",muscle:"💪",dizzy:"💫",speech_balloon:"💬",thought_balloon:"💭",white_flower:"💮",moneybag:"💰",currency_exchange:"💱",heavy_dollar_sign:"💲",credit_card:"💳",yen:"💴",dollar:"💵",euro:"💶",pound:"💷",money_with_wings:"💸",chart:"💹",seat:"💺",computer:"💻",briefcase:"💼",minidisc:"💽",floppy_disk:"💾",cd:"💿",dvd:"📀",file_folder:"📁",open_file_folder:"📂",page_with_curl:"📃",page_facing_up:"📄",date:"📅",calendar:"📆",card_index:"📇",chart_with_upwards_trend:"📈",chart_with_downwards_trend:"📉",bar_chart:"📊",clipboard:"📋",pushpin:"📌",round_pushpin:"📍",paperclip:"📎",straight_ruler:"📏",triangular_ruler:"📐",bookmark_tabs:"📑",ledger:"📒",notebook:"📓",notebook_with_decorative_cover:"📔",closed_book:"📕",book:"📖",open_book:"📖",green_book:"📗",blue_book:"📘",orange_book:"📙",books:"📚",name_badge:"📛",scroll:"📜",memo:"📝",pencil:"📝",telephone_receiver:"📞",pager:"📟",fax:"📠",satellite_antenna:"📡",loudspeaker:"📢",mega:"📣",outbox_tray:"📤",inbox_tray:"📥",package:"📦","e-mail":"📧",email:"📧",incoming_envelope:"📨",envelope_with_arrow:"📩",mailbox_closed:"📪",mailbox:"📫",mailbox_with_mail:"📬",mailbox_with_no_mail:"📭",postbox:"📮",postal_horn:"📯",newspaper:"📰",iphone:"📱",calling:"📲",vibration_mode:"📳",mobile_phone_off:"📴",no_mobile_phones:"📵",signal_strength:"📶",camera:"📷",camera_with_flash:"📸",video_camera:"📹",tv:"📺",radio:"📻",vhs:"📼",film_projector:"📽️",prayer_beads:"📿",twisted_rightwards_arrows:"🔀",repeat:"🔁",repeat_one:"🔂",arrows_clockwise:"🔃",arrows_counterclockwise:"🔄",low_brightness:"🔅",high_brightness:"🔆",mute:"🔇",speaker:"🔈",sound:"🔉",loud_sound:"🔊",battery:"🔋",electric_plug:"🔌",mag:"🔍",mag_right:"🔎",lock_with_ink_pen:"🔏",closed_lock_with_key:"🔐",key:"🔑",lock:"🔒",unlock:"🔓",bell:"🔔",no_bell:"🔕",bookmark:"🔖",link:"🔗",radio_button:"🔘",back:"🔙",end:"🔚",on:"🔛",soon:"🔜",top:"🔝",underage:"🔞",keycap_ten:"🔟",capital_abcd:"🔠",abcd:"🔡",symbols:"🔣",abc:"🔤",fire:"🔥",flashlight:"🔦",wrench:"🔧",hammer:"🔨",nut_and_bolt:"🔩",hocho:"🔪",knife:"🔪",gun:"🔫",microscope:"🔬",telescope:"🔭",crystal_ball:"🔮",six_pointed_star:"🔯",beginner:"🔰",trident:"🔱",black_square_button:"🔲",white_square_button:"🔳",red_circle:"🔴",large_blue_circle:"🔵",large_orange_diamond:"🔶",large_blue_diamond:"🔷",small_orange_diamond:"🔸",small_blue_diamond:"🔹",small_red_triangle:"🔺",small_red_triangle_down:"🔻",arrow_up_small:"🔼",arrow_down_small:"🔽",om_symbol:"🕉️",dove_of_peace:"🕊️",kaaba:"🕋",mosque:"🕌",synagogue:"🕍",menorah_with_nine_branches:"🕎",clock1:"🕐",clock2:"🕑",clock3:"🕒",clock4:"🕓",clock5:"🕔",clock6:"🕕",clock7:"🕖",clock8:"🕗",clock9:"🕘",clock10:"🕙",clock11:"🕚",clock12:"🕛",clock130:"🕜",clock230:"🕝",clock330:"🕞",clock430:"🕟",clock530:"🕠",clock630:"🕡",clock730:"🕢",clock830:"🕣",clock930:"🕤",clock1030:"🕥",clock1130:"🕦",clock1230:"🕧",candle:"🕯️",mantelpiece_clock:"🕰️",hole:"🕳️",man_in_business_suit_levitating:"🕴️","female-detective":"🕵️‍♀️","male-detective":"🕵️‍♂️",sleuth_or_spy:"🕵️‍♂️",dark_sunglasses:"🕶️",spider:"🕷️",spider_web:"🕸️",joystick:"🕹️",man_dancing:"🕺",linked_paperclips:"🖇️",lower_left_ballpoint_pen:"🖊️",lower_left_fountain_pen:"🖋️",lower_left_paintbrush:"🖌️",lower_left_crayon:"🖍️",raised_hand_with_fingers_splayed:"🖐️",middle_finger:"🖕",reversed_hand_with_middle_finger_extended:"🖕","spock-hand":"🖖",black_heart:"🖤",desktop_computer:"🖥️",printer:"🖨️",three_button_mouse:"🖱️",trackball:"🖲️",frame_with_picture:"🖼️",card_index_dividers:"🗂️",card_file_box:"🗃️",file_cabinet:"🗄️",wastebasket:"🗑️",spiral_note_pad:"🗒️",spiral_calendar_pad:"🗓️",compression:"🗜️",old_key:"🗝️",rolled_up_newspaper:"🗞️",dagger_knife:"🗡️",speaking_head_in_silhouette:"🗣️",left_speech_bubble:"🗨️",right_anger_bubble:"🗯️",ballot_box_with_ballot:"🗳️",world_map:"🗺️",mount_fuji:"🗻",tokyo_tower:"🗼",statue_of_liberty:"🗽",japan:"🗾",moyai:"🗿",grinning:"😀",grin:"😁",joy:"😂",smiley:"😃",smile:"😄",sweat_smile:"😅",laughing:"😆",satisfied:"😆",innocent:"😇",smiling_imp:"😈",wink:"😉",blush:"😊",yum:"😋",relieved:"😌",heart_eyes:"😍",sunglasses:"😎",smirk:"😏",neutral_face:"😐",expressionless:"😑",unamused:"😒",sweat:"😓",pensive:"😔",confused:"😕",confounded:"😖",kissing:"😗",kissing_heart:"😘",kissing_smiling_eyes:"😙",kissing_closed_eyes:"😚",stuck_out_tongue:"😛",stuck_out_tongue_winking_eye:"😜",stuck_out_tongue_closed_eyes:"😝",disappointed:"😞",worried:"😟",angry:"😠",rage:"😡",cry:"😢",persevere:"😣",triumph:"😤",disappointed_relieved:"😥",frowning:"😦",anguished:"😧",fearful:"😨",weary:"😩",sleepy:"😪",tired_face:"😫",grimacing:"😬",sob:"😭",open_mouth:"😮",hushed:"😯",cold_sweat:"😰",scream:"😱",astonished:"😲",flushed:"😳",sleeping:"😴",dizzy_face:"😵",no_mouth:"😶",mask:"😷",smile_cat:"😸",joy_cat:"😹",smiley_cat:"😺",heart_eyes_cat:"😻",smirk_cat:"😼",kissing_cat:"😽",pouting_cat:"😾",crying_cat_face:"😿",scream_cat:"🙀",slightly_frowning_face:"🙁",slightly_smiling_face:"🙂",upside_down_face:"🙃",face_with_rolling_eyes:"🙄","woman-gesturing-no":"🙅‍♀️",no_good:"🙅‍♀️","man-gesturing-no":"🙅‍♂️","woman-gesturing-ok":"🙆‍♀️",ok_woman:"🙆‍♀️","man-gesturing-ok":"🙆‍♂️","woman-bowing":"🙇‍♀️","man-bowing":"🙇‍♂️",bow:"🙇‍♂️",see_no_evil:"🙈",hear_no_evil:"🙉",speak_no_evil:"🙊","woman-raising-hand":"🙋‍♀️",raising_hand:"🙋‍♀️","man-raising-hand":"🙋‍♂️",raised_hands:"🙌","woman-frowning":"🙍‍♀️",person_frowning:"🙍‍♀️","man-frowning":"🙍‍♂️","woman-pouting":"🙎‍♀️",person_with_pouting_face:"🙎‍♀️","man-pouting":"🙎‍♂️",pray:"🙏",rocket:"🚀",helicopter:"🚁",steam_locomotive:"🚂",railway_car:"🚃",bullettrain_side:"🚄",bullettrain_front:"🚅",train2:"🚆",metro:"🚇",light_rail:"🚈",station:"🚉",tram:"🚊",train:"🚋",bus:"🚌",oncoming_bus:"🚍",trolleybus:"🚎",busstop:"🚏",minibus:"🚐",ambulance:"🚑",fire_engine:"🚒",police_car:"🚓",oncoming_police_car:"🚔",taxi:"🚕",oncoming_taxi:"🚖",car:"🚗",red_car:"🚗",oncoming_automobile:"🚘",blue_car:"🚙",truck:"🚚",articulated_lorry:"🚛",tractor:"🚜",monorail:"🚝",mountain_railway:"🚞",suspension_railway:"🚟",mountain_cableway:"🚠",aerial_tramway:"🚡",ship:"🚢","woman-rowing-boat":"🚣‍♀️","man-rowing-boat":"🚣‍♂️",rowboat:"🚣‍♂️",speedboat:"🚤",traffic_light:"🚥",vertical_traffic_light:"🚦",construction:"🚧",rotating_light:"🚨",triangular_flag_on_post:"🚩",door:"🚪",no_entry_sign:"🚫",smoking:"🚬",no_smoking:"🚭",put_litter_in_its_place:"🚮",do_not_litter:"🚯",potable_water:"🚰","non-potable_water":"🚱",bike:"🚲",no_bicycles:"🚳","woman-biking":"🚴‍♀️","man-biking":"🚴‍♂️",bicyclist:"🚴‍♂️","woman-mountain-biking":"🚵‍♀️","man-mountain-biking":"🚵‍♂️",mountain_bicyclist:"🚵‍♂️","woman-walking":"🚶‍♀️","man-walking":"🚶‍♂️",walking:"🚶‍♂️",no_pedestrians:"🚷",children_crossing:"🚸",mens:"🚹",womens:"🚺",restroom:"🚻",baby_symbol:"🚼",toilet:"🚽",wc:"🚾",shower:"🚿",bath:"🛀",bathtub:"🛁",passport_control:"🛂",customs:"🛃",baggage_claim:"🛄",left_luggage:"🛅",couch_and_lamp:"🛋️",sleeping_accommodation:"🛌",shopping_bags:"🛍️",bellhop_bell:"🛎️",bed:"🛏️",place_of_worship:"🛐",octagonal_sign:"🛑",shopping_trolley:"🛒",hammer_and_wrench:"🛠️",shield:"🛡️",oil_drum:"🛢️",motorway:"🛣️",railway_track:"🛤️",motor_boat:"🛥️",small_airplane:"🛩️",airplane_departure:"🛫",airplane_arriving:"🛬",satellite:"🛰️",passenger_ship:"🛳️",scooter:"🛴",motor_scooter:"🛵",canoe:"🛶",sled:"🛷",flying_saucer:"🛸",zipper_mouth_face:"🤐",money_mouth_face:"🤑",face_with_thermometer:"🤒",nerd_face:"🤓",thinking_face:"🤔",face_with_head_bandage:"🤕",robot_face:"🤖",hugging_face:"🤗",the_horns:"🤘",sign_of_the_horns:"🤘",call_me_hand:"🤙",raised_back_of_hand:"🤚","left-facing_fist":"🤛","right-facing_fist":"🤜",handshake:"🤝",crossed_fingers:"🤞",hand_with_index_and_middle_fingers_crossed:"🤞",i_love_you_hand_sign:"🤟",face_with_cowboy_hat:"🤠",clown_face:"🤡",nauseated_face:"🤢",rolling_on_the_floor_laughing:"🤣",drooling_face:"🤤",lying_face:"🤥","woman-facepalming":"🤦‍♀️","man-facepalming":"🤦‍♂️",face_palm:"🤦",sneezing_face:"🤧",face_with_raised_eyebrow:"🤨",face_with_one_eyebrow_raised:"🤨","star-struck":"🤩",grinning_face_with_star_eyes:"🤩",zany_face:"🤪",grinning_face_with_one_large_and_one_small_eye:"🤪",shushing_face:"🤫",face_with_finger_covering_closed_lips:"🤫",face_with_symbols_on_mouth:"🤬",serious_face_with_symbols_covering_mouth:"🤬",face_with_hand_over_mouth:"🤭",smiling_face_with_smiling_eyes_and_hand_covering_mouth:"🤭",face_vomiting:"🤮",face_with_open_mouth_vomiting:"🤮",exploding_head:"🤯",shocked_face_with_exploding_head:"🤯",pregnant_woman:"🤰","breast-feeding":"🤱",palms_up_together:"🤲",selfie:"🤳",prince:"🤴",man_in_tuxedo:"🤵",mrs_claus:"🤶",mother_christmas:"🤶","woman-shrugging":"🤷‍♀️","man-shrugging":"🤷‍♂️",shrug:"🤷","woman-cartwheeling":"🤸‍♀️","man-cartwheeling":"🤸‍♂️",person_doing_cartwheel:"🤸","woman-juggling":"🤹‍♀️","man-juggling":"🤹‍♂️",juggling:"🤹",fencer:"🤺","woman-wrestling":"🤼‍♀️","man-wrestling":"🤼‍♂️",wrestlers:"🤼","woman-playing-water-polo":"🤽‍♀️","man-playing-water-polo":"🤽‍♂️",water_polo:"🤽","woman-playing-handball":"🤾‍♀️","man-playing-handball":"🤾‍♂️",handball:"🤾",wilted_flower:"🥀",drum_with_drumsticks:"🥁",clinking_glasses:"🥂",tumbler_glass:"🥃",spoon:"🥄",goal_net:"🥅",first_place_medal:"🥇",second_place_medal:"🥈",third_place_medal:"🥉",boxing_glove:"🥊",martial_arts_uniform:"🥋",curling_stone:"🥌",croissant:"🥐",avocado:"🥑",cucumber:"🥒",bacon:"🥓",potato:"🥔",carrot:"🥕",baguette_bread:"🥖",green_salad:"🥗",shallow_pan_of_food:"🥘",stuffed_flatbread:"🥙",egg:"🥚",glass_of_milk:"🥛",peanuts:"🥜",kiwifruit:"🥝",pancakes:"🥞",dumpling:"🥟",fortune_cookie:"🥠",takeout_box:"🥡",chopsticks:"🥢",bowl_with_spoon:"🥣",cup_with_straw:"🥤",coconut:"🥥",broccoli:"🥦",pie:"🥧",pretzel:"🥨",cut_of_meat:"🥩",sandwich:"🥪",canned_food:"🥫",crab:"🦀",lion_face:"🦁",scorpion:"🦂",turkey:"🦃",unicorn_face:"🦄",eagle:"🦅",duck:"🦆",bat:"🦇",shark:"🦈",owl:"🦉",fox_face:"🦊",butterfly:"🦋",deer:"🦌",gorilla:"🦍",lizard:"🦎",rhinoceros:"🦏",shrimp:"🦐",squid:"🦑",giraffe_face:"🦒",zebra_face:"🦓",hedgehog:"🦔",sauropod:"🦕","t-rex":"🦖",cricket:"🦗",cheese_wedge:"🧀",face_with_monocle:"🧐",adult:"🧑",child:"🧒",older_adult:"🧓",bearded_person:"🧔",person_with_headscarf:"🧕",woman_in_steamy_room:"🧖‍♀️",man_in_steamy_room:"🧖‍♂️",person_in_steamy_room:"🧖‍♂️",woman_climbing:"🧗‍♀️",person_climbing:"🧗‍♀️",man_climbing:"🧗‍♂️",woman_in_lotus_position:"🧘‍♀️",person_in_lotus_position:"🧘‍♀️",man_in_lotus_position:"🧘‍♂️",female_mage:"🧙‍♀️",mage:"🧙‍♀️",male_mage:"🧙‍♂️",female_fairy:"🧚‍♀️",fairy:"🧚‍♀️",male_fairy:"🧚‍♂️",female_vampire:"🧛‍♀️",vampire:"🧛‍♀️",male_vampire:"🧛‍♂️",mermaid:"🧜‍♀️",merman:"🧜‍♂️",merperson:"🧜‍♂️",female_elf:"🧝‍♀️",male_elf:"🧝‍♂️",elf:"🧝‍♂️",female_genie:"🧞‍♀️",male_genie:"🧞‍♂️",genie:"🧞‍♂️",female_zombie:"🧟‍♀️",male_zombie:"🧟‍♂️",zombie:"🧟‍♂️",brain:"🧠",orange_heart:"🧡",billed_cap:"🧢",scarf:"🧣",gloves:"🧤",coat:"🧥",socks:"🧦",bangbang:"‼️",interrobang:"⁉️",tm:"™️",information_source:"ℹ️",left_right_arrow:"↔️",arrow_up_down:"↕️",arrow_upper_left:"↖️",arrow_upper_right:"↗️",arrow_lower_right:"↘️",arrow_lower_left:"↙️",leftwards_arrow_with_hook:"↩️",arrow_right_hook:"↪️",watch:"⌚",hourglass:"⌛",keyboard:"⌨️",eject:"⏏️",fast_forward:"⏩",rewind:"⏪",arrow_double_up:"⏫",arrow_double_down:"⏬",black_right_pointing_double_triangle_with_vertical_bar:"⏭️",black_left_pointing_double_triangle_with_vertical_bar:"⏮️",black_right_pointing_triangle_with_double_vertical_bar:"⏯️",alarm_clock:"⏰",stopwatch:"⏱️",timer_clock:"⏲️",hourglass_flowing_sand:"⏳",double_vertical_bar:"⏸️",black_square_for_stop:"⏹️",black_circle_for_record:"⏺️",m:"Ⓜ️",black_small_square:"▪️",white_small_square:"▫️",arrow_forward:"▶️",arrow_backward:"◀️",white_medium_square:"◻️",black_medium_square:"◼️",white_medium_small_square:"◽",black_medium_small_square:"◾",sunny:"☀️",cloud:"☁️",umbrella:"☂️",snowman:"☃️",comet:"☄️",phone:"☎️",telephone:"☎️",ballot_box_with_check:"☑️",shamrock:"☘️",point_up:"☝️",skull_and_crossbones:"☠️",radioactive_sign:"☢️",biohazard_sign:"☣️",orthodox_cross:"☦️",star_and_crescent:"☪️",peace_symbol:"☮️",yin_yang:"☯️",wheel_of_dharma:"☸️",white_frowning_face:"☹️",relaxed:"☺️",female_sign:"♀️",male_sign:"♂️",gemini:"♊",cancer:"♋",leo:"♌",virgo:"♍",libra:"♎",scorpius:"♏",spades:"♠️",clubs:"♣️",hearts:"♥️",diamonds:"♦️",hotsprings:"♨️",recycle:"♻️",wheelchair:"♿",hammer_and_pick:"⚒️",crossed_swords:"⚔️",medical_symbol:"⚕️",staff_of_aesculapius:"⚕️",scales:"⚖️",alembic:"⚗️",gear:"⚙️",atom_symbol:"⚛️",fleur_de_lis:"⚜️",warning:"⚠️",zap:"⚡",white_circle:"⚪",black_circle:"⚫",coffin:"⚰️",funeral_urn:"⚱️",soccer:"⚽",baseball:"⚾",snowman_without_snow:"⛄",partly_sunny:"⛅",thunder_cloud_and_rain:"⛈️",ophiuchus:"⛎",pick:"⛏️",helmet_with_white_cross:"⛑️",chains:"⛓️",no_entry:"⛔",shinto_shrine:"⛩️",church:"⛪",mountain:"⛰️",umbrella_on_ground:"⛱️",fountain:"⛲",golf:"⛳",ferry:"⛴️",boat:"⛵",sailboat:"⛵",skier:"⛷️",ice_skate:"⛸️","woman-bouncing-ball":"⛹️‍♀️","man-bouncing-ball":"⛹️‍♂️",person_with_ball:"⛹️‍♂️",tent:"⛺",fuelpump:"⛽",scissors:"✂️",airplane:"✈️",envelope:"✉️",fist:"✊",hand:"✋",raised_hand:"✋",v:"✌️",writing_hand:"✍️",pencil2:"✏️",black_nib:"✒️",heavy_check_mark:"✔️",heavy_multiplication_x:"✖️",latin_cross:"✝️",star_of_david:"✡️",eight_spoked_asterisk:"✳️",eight_pointed_black_star:"✴️",snowflake:"❄️",sparkle:"❇️",x:"❌",negative_squared_cross_mark:"❎",heavy_heart_exclamation_mark_ornament:"❣️",heart:"❤️",arrow_right:"➡️",curly_loop:"➰",loop:"➿",arrow_heading_up:"⤴️",arrow_heading_down:"⤵️",arrow_left:"⬅️",arrow_up:"⬆️",arrow_down:"⬇️",black_large_square:"⬛",white_large_square:"⬜",star:"⭐",o:"⭕",wavy_dash:"〰️",part_alternation_mark:"〽️",congratulations:"㊗️",secret:"㊙️"};class LighBoxImage{init(e){}}"use strict";!function(e,t){var n=function(t){function n(e,t,n){var i=n[n.length-1];e.replaceChild(i,t);for(var a=n.length-2;a>=0;a--)e.insertBefore(n[a],i),i=n[a]}function i(e,t,n){var i=[],a=e,o=Array.isArray(a),s=0;for(a=o?a:a[Symbol.iterator]();;){var r;if(o){if(s>=a.length)break;r=a[s++]}else{if((s=a.next()).done)break;r=s.value}var c=r;if("nl"===c.type&&t.nl2br)i.push(n.createElement("br"));else if(c.isLink&&t.check(c)){var l=t.resolve(c),h=l.formatted,d=l.formattedHref,u=l.tagName,f=l.className,p=l.target,g=l.events,m=l.attributes,_=n.createElement(u);if(_.setAttribute("href",d),f&&_.setAttribute("class",f),p&&_.setAttribute("target",p),m)for(var C in m)_.setAttribute(C,m[C]);if(g)for(var y in g)_.addEventListener?_.addEventListener(y,g[y]):_.attachEvent&&_.attachEvent("on"+y,g[y]);_.appendChild(n.createTextNode(h)),i.push(_)}else i.push(n.createTextNode(c.toString()))}return i}function a(e,t,o){if(!e||e.nodeType!==h)throw new Error("Cannot linkify "+e+" - Invalid DOM Node type");var c=t.ignoreTags;if("A"===e.tagName||r.contains(c,e.tagName))return e;for(var u=e.firstChild;u;){var f=void 0,p=void 0,g=void 0;switch(u.nodeType){case h:a(u,t,o);break;case d:if(f=u.nodeValue,0===(p=s(f)).length||1===p.length&&p[0]instanceof l)break;n(e,u,g=i(p,t,o)),u=g[g.length-1]}u=u.nextSibling}return e}function o(t,n){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];try{i=i||document||e&&e.document||global&&global.document}catch(e){}if(!i)throw new Error("Cannot find document implementation. If you are in a non-browser environment like Node.js, pass the document implementation as the third argument to linkifyElement.");return a(t,n=new c(n),i)}var s=t.tokenize,r=t.options,c=r.Options,l=t.parser.TOKENS.TEXT,h=1,d=3;return o.helper=a,o.normalize=function(e){return new c(e)},o}(linkify);e.linkifyElement=n}(window);class MessageInputData{init(e,t,n,i=!0){this.message=e,this.conversation=t,this.storeConfig=n,this.isShowDate=i;const a=this.generateHTMLContent(),o=document.createElement("div");o.innerHTML=a.trim();const s=o.firstChild;this.doom_element=s;const r=s.getElementsByTagName("img"),c=[],l=[];for(let e=0;e<r.length;e++){const t=r[e];t.addEventListener("click",(function(){LadiChat_Helper.openInNewTab(t.src)})),c.push(t.src),l.push(t.src.split("/").pop())}}showLightBox(e){}generateHTMLContent(){const e=LadiChat_Config.getStaffInfo(this.message.sender_id,this.storeConfig);let t='<div class="no-avatar">\n            <p>'+LadiChat_Helper.getDisplayName(e.name)+"</p>\n        </div>";return e.avatar&&""!=e.avatar&&(t='<div class="avatar-img">\n                <img  src="'+e.avatar+'"></img>\n            </div>'),this.isShowDate||(t="<div></div>"),'<div class="ladichat-message-recieve-item" id='+this.message._id+'>\n                <div class="ladichat-message-recieve-left">'+t+' </div>\n                <div class="ladichat-message-recieve-mid">\n                    <div class="content">\n                        <div class="line">\n                            <div class="ladichat-msg-recieve-text">'+this.message.message+'</div>\n                        </div>\n                        <div class="line>\n                            <input type="text" id="search" placeholder="Tìm theo tên, email hoặc số điện thoại" name="searchString" class="ladichat-input-field">\n                        </div>\n                    </div>\n                </div>\n            </div>'}}class MessageRecieve{init(e,t,n,i=!0,a=!0){this.message=e,this.conversation=t,this.storeConfig=n,this.isShowDate=i,this.isShowAvatar=a;const o=this.generateHTMLContent(),s=document.createElement("div");s.innerHTML=o.trim();const r=s.firstChild;this.doom_element=r;const c=r.getElementsByTagName("img"),l=[],h=[];for(let e=0;e<c.length;e++){const t=c[e];t.addEventListener("click",(function(){LadiChat_Helper.openInNewTab(t.src)})),l.push(t.src),h.push(t.src.split("/").pop())}}showLightBox(e){}generateHTMLContent(){const e=LadiChat_Config.getStaffInfo(this.message.sender_id,this.storeConfig);let t='<div class="no-avatar">\n            <p>'+LadiChat_Helper.getDisplayName(e.name)+"</p>\n        </div>";e.avatar&&""!=e.avatar&&(t='<div class="avatar-img">\n                <img  src="'+e.avatar+'"></img>\n            </div>'),this.isShowAvatar||(t="<div></div>");const n='"'+new Date(this.message.created_at).toLocaleString()+'"',i=this.isShowDate?`<div class="line">\n            <span class="ladichat-msg-datetime" id="datetime-${this.message._id}"\n                data-tooltip=${n}\n                data-tooltip-position="right">`+LadiChat_Helper.getPrettyDate(this.message.created_at)+"</span>\n            </div>\n        </div>":"";return'<div class="ladichat-message-recieve-item" id='+this.message._id+'>\n                <div class="ladichat-message-recieve-left">'+t+' </div>\n                <div class="ladichat-message-recieve-mid">\n                    <div class="content">\n                        <div class="line">\n                            <div class="ladichat-msg-recieve-text">'+this.message.message+"</div>\n                        </div>\n                        "+i+"\n                    </div>\n                </div>\n            </div>"}}class MessageSent{init(e,t,n,i=!0,a=!1){this.message=e,this.isShowDate=i,this.storeConfig=n,this.conversation=t,this.isShowRead=a,this.resendData=e.resendData||!1;const o=this.generateHTMLContent(),s=document.createElement("div");s.innerHTML=o.trim();const r=s.firstChild;this.doom_element=r;const c=r.getElementsByTagName("img"),l=[],h=[];for(let e=0;e<c.length;e++){const t=c[e];t.addEventListener("click",(function(){LadiChat_Helper.openInNewTab(t.src)})),l.push(t.src),h.push(t.src.split("/").pop())}this.isFailed=!1,this.timeoutID=null,this.msgTraceID=LadiChat_Helper.generateText(5);var d=this;!this.message._id&&this.message.msg_tid&&this.resendData?this.timeoutID=setTimeout((()=>{d.isFailed=!0,d.reloadElement()}),1e4):this.timeoutID&&clearTimeout(this.timeoutID)}reloadElement(){let e=this;if(!this.isFailed&&this.timeoutID)return clearTimeout(this.timeoutID),void(this.timeoutID=null);const t=this.generateHTMLContent(),n=document.createElement("div");n.innerHTML=t.trim();const i=n.innerHTML;LadiChat.iframeDoc.getElementById("message-"+this.message.msg_tid).innerHTML=i;const a=LadiChat.iframeDoc.getElementById("resend-"+this.message.msg_tid);a.addEventListener("click",(async function(){a.parentNode.removeChild(a),e.isFailed=!1,!e.message._id&&e.message.msg_tid&&e.resendData&&(e.timeoutID&&clearTimeout(e.timeoutID),e.timeoutID=setTimeout((()=>{e.isFailed=!0,e.reloadElement()}),1e4),await LadiChat_Helper.sendPOSTRequest(LadiChat_Static_Config.END_POINT,LadiChat_Config.API_ROUTE.SEND_MESSAGE,e.resendData.data,e.resendData.headers))}))}generateHTMLContent(){let e=!1;if(0==this.message.read_users.length)e=!1;else for(let t=0;t<this.storeConfig.staffs.length;t++)if(this.message.read_users.indexOf(this.storeConfig.staffs[t].ladi_uid)>=0){e=!0;break}let t="";!this.message._id&&this.message.msg_tid&&this.isFailed&&(t=`<span class="re-sent-msg" id="resend-${this.message.msg_tid}">\n            <svg width="16px" height="16px" viewBox="0 0 16 16" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n                <g id="Protype" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">\n                    <g id="Elements" transform="translate(-881.000000, -64.000000)" fill="#E02020" fill-rule="nonzero">\n                        <g id="Checkbox" transform="translate(865.000000, 31.000000)">\n                            <g id="Checked" transform="translate(16.000000, 4.000000)">\n                                <path d="M7.625,44.25 C9.02291667,44.25 10.3043403,43.9111111 11.4692708,43.2333333 C12.6342014,42.5555556 13.5555556,41.6342014 14.2333333,40.4692708 C14.9111111,39.3043403 15.25,38.0229167 15.25,36.625 C15.25,35.2270833 14.9111111,33.9456597 14.2333333,32.7807292 C13.5555556,31.6157986 12.6342014,30.6944444 11.4692708,30.0166667 C10.3043403,29.3388889 9.02291667,29 7.625,29 C6.22708333,29 4.94565972,29.3388889 3.78072917,30.0166667 C2.61579861,30.6944444 1.69444444,31.6157986 1.01666667,32.7807292 C0.338888889,33.9456597 0,35.2270833 0,36.625 C0,38.0229167 0.338888889,39.3043403 1.01666667,40.4692708 C1.69444444,41.6342014 2.61579861,42.5555556 3.78072917,43.2333333 C4.94565972,43.9111111 6.22708333,44.25 7.625,44.25 Z M7.94270833,38.5947917 L7.30729167,38.5947917 L6.98958333,31.7958333 L8.26041667,31.7958333 L7.94270833,38.5947917 Z M7.625,41.4541667 C7.41319444,41.4541667 7.23315972,41.3800347 7.08489583,41.2317708 C6.93663194,41.0835069 6.8625,40.9034722 6.8625,40.6916667 C6.8625,40.4798611 6.93663194,40.2998264 7.08489583,40.1515625 C7.23315972,40.0032986 7.41319444,39.9291667 7.625,39.9291667 C7.83680556,39.9291667 8.01684028,40.0032986 8.16510417,40.1515625 C8.31336806,40.2998264 8.3875,40.4798611 8.3875,40.6916667 C8.3875,40.9034722 8.31336806,41.0835069 8.16510417,41.2317708 C8.01684028,41.3800347 7.83680556,41.4541667 7.625,41.4541667 Z" id=""></path>\n                            </g>\n                        </g>\n                    </g>\n                </g>\n            </svg><a>Gửi tin nhắn thất bại, ấn để gửi lại</a></span>`);const n=""+LadiChat_Helper.getPrettyDate(this.message.created_at),i=" - "+(e?"Đã xem":"Chưa xem"),a='"'+new Date(this.message.created_at).toLocaleString()+'"',o=this.isShowDate&&!this.isFailed?`<div style="float: right" data-tooltip=${a}\n        data-tooltip-position="left">\n            <span class="ladichat-msg-datetime" id="datetime-${this.message._id?this.message._id:this.message.msg_tid}">\n            ${n+(this.isShowRead?i:"")} \n            </span>\n        </div>`:"";return`<div class="ladichat-message-sent-item" id="message-${this.message._id?this.message._id:this.message.msg_tid}">\n            <div class="content">\n                <div class="line">\n                    <div class="ladichat-msg-sent-text">`+this.message.message+"</div>\n                </div>\n                "+(this.isFailed?t:o)+"\n            </div>\n        </div>"}}class MessageTyping{init(e,t,n){this.typingUser=e,this.conversation=t,this.storeConfig=n;const i=this.generateHTMLContent(),a=document.createElement("div");a.innerHTML=i.trim();const o=a.firstChild;this.doom_element=o}generateHTMLContent(){const e=LadiChat_Config.getStaffInfo(this.typingUser,this.storeConfig);let t='<div class="no-avatar">\n            <p>'+LadiChat_Helper.getDisplayName(e.name)+"</p>\n        </div>";return e.avatar&&""!=e.avatar&&(t='<div class="avatar-img">\n                <img  src="'+e.avatar+'"></img>\n            </div>'),'<div class="ladichat-message-recieve-item" id=\'message-typing-'+this.typingUser+'\'>\n                <div class="ladichat-message-recieve-left">'+t+' </div>\n                <div class="ladichat-message-recieve-mid">\n                    <div class="content">\n                        <div class="line">\n                            <div class="ladichat-typing user">\n                                <span class="dot"></span>\n                                <span class="dot"></span>\n                                <span class="dot"></span>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n        </div>'}}class Modal{init(e){const t=this.generateHTMLContent(e);this.doom_element=t}generateHTMLContent(e){const t=document.createElement("div");return t.setAttribute("class","ladiui-modal visible"),t.innerHTML=e,t}}class _LadiChat{constructor(e){this.commandQueue=e||[],this.closeCallBack=void 0,this.isProcessQueue=!1,this.timeoutID=null,this.initSuccess=!1}async init(e){try{LadiChat.toastCount=1,LadiChat.storeID=e.store_id,LadiChat.version=e.version;let t={"Content-Type":"text/plain"};if(LadiChat.token=LadiChat_Helper.getCookie(LadiChat_Config.SESSION_KEY+LadiChat.storeID),LadiChat.userInfo=LadiChat_Helper.getCookie(LadiChat_Config.USER_INFO_COOKIE+LadiChat.storeID),!LadiChat.token||""==LadiChat.token){const e=LadiChat_Helper.uuidv4(),n={store_id:LadiChat.storeID,session_id:e,page_url:window.location.href};t={"Content-Type":"application/json"};const i=await LadiChat_Helper.sendRequest("POST",LadiChat_Static_Config.END_POINT+LadiChat_Config.API_ROUTE.NEW_SESSION,JSON.stringify(n),!0,t),a=JSON.parse(i);if(200!=a.code)return void LadiChat_Helper.setCookie(LadiChat_Config.SESSION_KEY+LadiChat.storeID,LadiChat.token,1);LadiChat.token=a.data.sessionKey}if(""!=LadiChat.userInfo&&(LadiChat.userInfo=JSON.parse(LadiChat.userInfo)),LadiChat.token){const e={page_url:window.location.href};t={"Content-Type":"application/json","session-key":LadiChat.token};let n=await LadiChat_Helper.sendRequest("POST",LadiChat_Static_Config.END_POINT+LadiChat_Config.API_ROUTE.MY_INFO,JSON.stringify(e),!0,t);n&&(n=JSON.parse(n),200==n.code&&(LadiChat.userInfo=Object.assign(n.data,LadiChat.userInfo),LadiChat.userInfo.user_id=LadiChat.userInfo._id))}LadiChat_Helper.setCookie(LadiChat_Config.USER_INFO_COOKIE+LadiChat.storeID,JSON.stringify(LadiChat.userInfo),30),LadiChat_Helper.setCookie(LadiChat_Config.SESSION_KEY+LadiChat.storeID,LadiChat.token,LadiChat_Config.EXPRIRE_TOKEN),LadiChat.listTyping=[],LadiChat.firstRender=!1,LadiChat.mainPage=null,await LadiChat.initSocket(),await LadiChat.getStoreConfig(),await LadiChat.getUnreadMessage(),LadiChat.visibleWidget=!0,await LadiChat.buildChatWidget(),!LadiChat.isProcessQueue&&null==LadiChat.timeoutID&&LadiChat.commandQueue.length>0&&(LadiChat.timeoutID=setTimeout(LadiChat.processQueue,200))}catch(e){console.log(e)}}async initSocket(){try{const e={session_key:LadiChat.token};LadiChat.socket=io.connect(LadiChat_Static_Config.END_POINT,{transports:["websocket","polling"],query:e}),LadiChat.socket.on(LadiChat_Config.SOCKET_EVENT.NEW_MESSAGE,(function(e){LadiChat.handlerNewMessage(e)})),LadiChat.socket.on(LadiChat_Config.SOCKET_EVENT.READ_MESSAGE,(function(e){LadiChat.handlerReadMessage(e)})),LadiChat.socket.on(LadiChat_Config.SOCKET_EVENT.ON_TYPING,(function(e){LadiChat.handlerOnTyping(e)})),LadiChat.socket.on(LadiChat_Config.SOCKET_EVENT.END_TYPING,(function(e){LadiChat.handlerEndTyping(e)}))}catch(e){console.log(e)}}handlerOnTyping(e){try{if(e.ladi_uid){const t=e.conversation_id;let n=LadiChat.listTyping[t];if(n){let t=-1;for(let i=0;i<n.length;i++)if(n[i].ladi_uid==e.ladi_uid){t=i;break}t<0&&n.push(e)}else n=[e];LadiChat.listTyping[t]=n,LadiChat.mainPage.name==LadiChat_Config.SCREEN_NAME.MESSENGER_PAGE&&LadiChat.mainPage.conversation._id==t&&(LadiChat.mainPage.listTyping=n,LadiChat.mainPage.reloadMessagesList())}}catch(e){console.log(e)}}handlerEndTyping(e){try{if(e.ladi_uid){const t=e.conversation_id,n=LadiChat.listTyping[t];if(n){for(let t=0;t<n.length;t++)if(n[t].ladi_uid==e.ladi_uid){n.splice(t,1);break}LadiChat.listTyping[t]=n,LadiChat.mainPage.name==LadiChat_Config.SCREEN_NAME.MESSENGER_PAGE&&LadiChat.mainPage.conversation._id==t&&(LadiChat.mainPage.listTyping=n,LadiChat.mainPage.reloadMessagesList())}}}catch(e){console.log(e)}}handlerReadMessage(e){if(LadiChat.storeConfig.unread_message&&LadiChat.storeConfig.unread_message.length>0)for(let t=0;t<LadiChat.storeConfig.unread_message.length;t++)if(LadiChat.storeConfig.unread_message[t].message_id==e._id){LadiChat.storeConfig.unread_message.splice(t,1);const e=LadiChat.iframeDoc.getElementById("badge-new-message"),n=document.createTextNode(LadiChat.storeConfig.unread_message.length);e.innerHTML="",e.appendChild(n),0==LadiChat.storeConfig.unread_message.length&&e.classList.contains("visible")&&e.classList.remove("visible"),LadiChat.storeConfig.unread_message.length>0&&!e.classList.contains("visible")&&e.classList.add("visible");break}}handlerNewMessage(e){try{if("SYSTEM"==e.type||"NOTE"==e.type)return;if(e.read_users.indexOf(LadiChat.userInfo.user_id)<0&&LadiChat.storeConfig.unread_message&&LadiChat.storeConfig.unread_message.length>=0){LadiChat.storeConfig.unread_message.push({message_id:e._id});const t=LadiChat.iframeDoc.getElementById("badge-new-message"),n=document.createTextNode(LadiChat.storeConfig.unread_message.length);t.innerHTML="",t.appendChild(n),0==LadiChat.storeConfig.unread_message.length&&t.classList.contains("visible")&&t.classList.remove("visible"),LadiChat.storeConfig.unread_message.length>0&&!t.classList.contains("visible")&&t.classList.add("visible")}}catch(e){console.log(e)}}async loadCss(e,t){return new Promise((function(n,i){let a=document.createElement("link");a.type="text/css",a.rel="stylesheet",a.onload=function(){n()},a.href=e,t.head.appendChild(a)}))}async getUnreadMessage(){try{const e={"content-type":"application/json","session-key":LadiChat.token},t=await LadiChat_Helper.sendPOSTRequest(LadiChat_Static_Config.END_POINT,LadiChat_Config.API_ROUTE.UNREAD_MESSAGE,{},e);200==t.code&&(LadiChat.storeConfig.unread_message=t.data.unread)}catch(e){console.log(e)}}async getStoreConfig(){try{const e={token:LadiChat.token},t=await LadiChat_Helper.sendPOSTRequest(LadiChat_Static_Config.END_POINT,LadiChat_Config.API_ROUTE.GET_CONFIG,e);200==t.code&&(LadiChat.storeConfig=t.data),LadiChat.storeConfig.user_info=Object.assign(LadiChat.userInfo,LadiChat.storeConfig.user_info)}catch(e){console.log(e)}}querySelector(e,t){return(t=t||document).querySelectorAll(e)}forEach(e,t){const n=Object.keys(e);for(let i=0;i<n.length;i++)t(e[n[i]])}showChatWidget(e=!1){let t=LadiChat_Helper.getCookie(LadiChat_Config.USER_INFO_COOKIE+LadiChat.storeID);t=JSON.parse(t);const n=LadiChat.iframeDoc.getElementById("svg-icon");if(!LadiChat.firstRender)return t.is_show_widget?(LadiChat.chatContainer.classList.add("is-visible"),LadiChat.chatWidgetOpen.classList.remove("close"),LadiChat.chatWidgetOpen.classList.add("open"),LadiChat.frameContainer.style.width="520px",LadiChat.frameContainer.style.height="100%",n.innerHTML=LadiChat.openSVG):(LadiChat.chatContainer.classList.remove("is-visible"),LadiChat.chatWidgetOpen.classList.remove("open"),LadiChat.chatWidgetOpen.classList.add("close"),LadiChat.frameContainer.style.width="100px",LadiChat.frameContainer.style.height="100px",n.innerHTML=LadiChat.closeSVG),void(LadiChat.firstRender=!0);e&&(LadiChat.chatContainer.classList.contains("is-visible")?(LadiChat.chatContainer.classList.remove("is-visible"),LadiChat.chatWidgetOpen.classList.remove("open"),LadiChat.chatWidgetOpen.classList.add("close"),LadiChat.frameContainer.style.width="100px",LadiChat.frameContainer.style.height="100px",n.innerHTML=LadiChat.closeSVG,t.is_show_widget=!1,"function"==typeof LadiChat.closeCallBack&&LadiChat.closeCallBack.call()):(LadiChat.chatContainer.classList.add("is-visible"),LadiChat.chatWidgetOpen.classList.remove("close"),LadiChat.chatWidgetOpen.classList.add("open"),LadiChat.frameContainer.style.width="520px",LadiChat.frameContainer.style.height="100%",n.innerHTML=LadiChat.openSVG,t.is_show_widget=!0)),LadiChat_Helper.setCookie(LadiChat_Config.USER_INFO_COOKIE+LadiChat.storeID,JSON.stringify(t),30)}closeChatWidget(){}async showStartPage(){let e=LadiChat_Helper.getCookie(LadiChat_Config.STORE_CONFIG_COOKIE+LadiChat.storeID);e=e&&""!=e?Object.assign(JSON.parse(e),LadiChat.storeConfig):LadiChat.storeConfig;let t=LadiChat_Helper.getCookie(LadiChat_Config.USER_INFO_COOKIE+LadiChat.storeID);t&&""!=t&&(t=JSON.parse(t),e.user_info=t),t.screen_name=LadiChat_Config.SCREEN_NAME.SURVEY_PAGE,LadiChat.screen_name=LadiChat_Config.SCREEN_NAME.SURVEY_PAGE,LadiChat.mainPage=new StartPage,LadiChat.mainPage.init(LadiChat.token,e,LadiChat.socket),LadiChat.chatContainer.innerHTML=LadiChat.mainPage.doom_element.outerHTML,setTimeout((function(){LadiChat.frameContainer.style.setProperty("visibility","visible")}),300);const n=frames["ladichat-widget-frame"].contentWindow.document||frames["ladichat-widget-frame"].contentDocument;LadiChat.mainPage.addEvent(n),LadiChat_Helper.setCookie(LadiChat_Config.USER_INFO_COOKIE+LadiChat.storeID,JSON.stringify(t),30),LadiChat.showChatWidget()}async showConversationPage(){let e=LadiChat_Helper.getCookie(LadiChat_Config.STORE_CONFIG_COOKIE+LadiChat.storeID);e=e&&""!=e?Object.assign(JSON.parse(e),LadiChat.storeConfig):LadiChat.storeConfig;let t=LadiChat_Helper.getCookie(LadiChat_Config.USER_INFO_COOKIE+LadiChat.storeID);t&&""!=t&&(t=JSON.parse(t),e.user_info=t),t.screen_name=LadiChat_Config.SCREEN_NAME.LIST_CONVERSATION_PAGE,LadiChat.screen_name=LadiChat_Config.SCREEN_NAME.LIST_CONVERSATION_PAGE,LadiChat.mainPage=new ConversationPage,LadiChat.mainPage.init(LadiChat.token,e,LadiChat.socket),LadiChat.chatContainer.innerHTML=LadiChat.mainPage.doom_element.outerHTML,setTimeout((function(){LadiChat.frameContainer.style.setProperty("visibility","visible")}),300);const n=frames["ladichat-widget-frame"].contentWindow.document||frames["ladichat-widget-frame"].contentDocument;LadiChat.mainPage.addEvent(n),LadiChat_Helper.setCookie(LadiChat_Config.USER_INFO_COOKIE+LadiChat.storeID,JSON.stringify(t),30),LadiChat.showChatWidget()}showConversationStream(e){let t=LadiChat_Helper.getCookie(LadiChat_Config.STORE_CONFIG_COOKIE+LadiChat.storeID);t=t&&""!=t?Object.assign(JSON.parse(t),LadiChat.storeConfig):LadiChat.storeConfig;let n=LadiChat_Helper.getCookie(LadiChat_Config.USER_INFO_COOKIE+LadiChat.storeID);n&&""!=n&&(n=JSON.parse(n),t.user_info=n),n.screen_name=LadiChat_Config.SCREEN_NAME.MESSENGER_PAGE,LadiChat.screen_name=LadiChat_Config.SCREEN_NAME.MESSENGER_PAGE,LadiChat.mainPage=new ConversationStream,LadiChat.mainPage.init(LadiChat.token,t,LadiChat.socket,e),LadiChat.chatContainer.innerHTML=LadiChat.mainPage.doom_element.outerHTML;const i=frames["ladichat-widget-frame"].contentWindow.document||frames["ladichat-widget-frame"].contentDocument;LadiChat.mainPage.addEvent(i),setTimeout((function(){LadiChat.frameContainer.style.setProperty("visibility","visible")}),300),e&&(LadiChat.storeConfig.user_info.current_conversation=e,n.conversation=e),LadiChat_Helper.setCookie(LadiChat_Config.USER_INFO_COOKIE+LadiChat.storeID,JSON.stringify(n),30),LadiChat.showChatWidget()}async loadWidgetStyle(){await LadiChat.loadCss("https://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,600,600i,700,700i|Roboto:ital,wght@0,300;0,400;0,500;1,300;1,400;1,500&display=swap",LadiChat.iframeDoc),await LadiChat.loadCss(LadiChat_Static_Config.CSS_URL+"?ver="+(new Date).getTime(),LadiChat.iframeDoc);const e=document.createElement("style");e.setAttribute("id","style-ladichat"),e.textContent=LadiChat_Helper.getApplyStyle(JSON.parse(LadiChat.storeConfig.widgetConfig)),LadiChat.iframeDoc.head.appendChild(e)}async buildChatWidget(e){try{LadiChat.openSVG='<svg width="21px" height="21px" viewBox="0 0 21 21" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n                <g id="Protype" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">\n                    <path d="M19.5,21 C19.875,21 20.21875,20.84375 20.53125,20.53125 C20.84375,20.21875 21,19.875 21,19.5 C21,19.125 20.84375,18.78125 20.53125,18.46875 L12.5625,10.5 L20.53125,2.53125 C20.84375,2.21875 21,1.875 21,1.5 C21,1.125 20.84375,0.78125 20.53125,0.46875 C20.21875,0.15625 19.875,0 19.5,0 C19.125,0 18.78125,0.15625 18.46875,0.46875 L10.5,8.4375 L2.53125,0.46875 C2.21875,0.15625 1.875,0 1.5,0 C1.125,0 0.78125,0.15625 0.46875,0.46875 C0.15625,0.78125 0,1.125 0,1.5 C0,1.875 0.15625,2.21875 0.46875,2.53125 L8.4375,10.5 L0.46875,18.46875 C0.15625,18.78125 0,19.125 0,19.5 C0,19.875 0.15625,20.21875 0.46875,20.53125 C0.78125,20.84375 1.125,21 1.5,21 C1.875,21 2.21875,20.84375 2.53125,20.53125 L10.5,12.5625 L18.46875,20.53125 C18.78125,20.84375 19.125,21 19.5,21 Z" id="" fill="#FFFFFF" fill-rule="nonzero"></path>\n                </g>\n            </svg>',LadiChat.closeSVG='<svg width="28px" height="28px" viewBox="0 0 28 28" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n                <g id="Protype" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">\n                    <path d="M0.625,27.375 L6,22 L24.625,22 C25.375,22 26.0208333,21.75 26.5625,21.25 C27.1041667,20.75 27.375,20.125 27.375,19.375 L27.375,3.375 C27.375,2.625 27.1041667,1.97916667 26.5625,1.4375 C26.0208333,0.895833333 25.375,0.625 24.625,0.625 L3.375,0.625 C2.625,0.625 1.97916667,0.895833333 1.4375,1.4375 C0.895833333,1.97916667 0.625,2.625 0.625,3.375 L0.625,27.375 Z M22,8.625 L6,8.625 L6,6 L22,6 L22,8.625 Z M22,12.625 L6,12.625 L6,10 L22,10 L22,12.625 Z M16.625,16.625 L6,16.625 L6,14 L16.625,14 L16.625,16.625 Z" id="" fill="#FFFFFF" fill-rule="nonzero"></path>\n                </g>\n            </svg>';const e=document.createElement("div");e.setAttribute("id","ladichat");let t="\n                display: block;\n                border: none;\n                position: fixed;\n                width: 100px;\n                height: 100px;\n                opacity: 1;\n                bottom: 0px;\n                background: none transparent;\n                margin: 0px;\n                transform: translateY(0px);\n                transition: none 0s ease 0s;\n                visibility: hidden;\n                z-index: 999999999 !important;";const n=JSON.parse(LadiChat.storeConfig.widgetConfig);"right"==n.widget_position?t+="\n                left: auto;\n                right: 10px;\n                ":t+="\n                right: auto;\n                left: 10px;\n                ",LadiChat.frameContainer=document.createElement("iframe"),LadiChat.frameContainer.style=t,LadiChat.frameContainer.setAttribute("id","ladichat-widget-frame"),LadiChat.chatWidget=document.createElement("div"),LadiChat.chatWidget.setAttribute("class","ladichat-widget"),LadiChat.chatWidget.setAttribute("id","ladichat-widget"),LadiChat.chatContainer=document.createElement("div"),LadiChat.chatContainer.setAttribute("id","ladichat-widget-container"),LadiChat.chatContainer.setAttribute("class","ladichat-widget-container"),LadiChat.chatWidget.appendChild(LadiChat.chatContainer),"left"==n.widget_position?LadiChat.chatContainer.style="left: 0px;":LadiChat.chatContainer.style="left: 125px;",LadiChat.chatWidgetOpen=document.createElement("a"),LadiChat.chatWidgetOpen.setAttribute("id","ladichat-widget-open"),LadiChat.chatWidgetOpen.setAttribute("class","fab close"),LadiChat.chatWidgetOpen.innerHTML='<div id="svg-icon"><svg width="28px" height="28px" viewBox="0 0 28 28" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n            <g id="Protype" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">\n                <path d="M0.625,27.375 L6,22 L24.625,22 C25.375,22 26.0208333,21.75 26.5625,21.25 C27.1041667,20.75 27.375,20.125 27.375,19.375 L27.375,3.375 C27.375,2.625 27.1041667,1.97916667 26.5625,1.4375 C26.0208333,0.895833333 25.375,0.625 24.625,0.625 L3.375,0.625 C2.625,0.625 1.97916667,0.895833333 1.4375,1.4375 C0.895833333,1.97916667 0.625,2.625 0.625,3.375 L0.625,27.375 Z M22,8.625 L6,8.625 L6,6 L22,6 L22,8.625 Z M22,12.625 L6,12.625 L6,10 L22,10 L22,12.625 Z M16.625,16.625 L6,16.625 L6,14 L16.625,14 L16.625,16.625 Z" id="" fill="#FFFFFF" fill-rule="nonzero"></path>\n            </g>\n        </svg></div>',LadiChat.chatWidgetOpen.addEventListener("click",(function(){LadiChat.showChatWidget(!0)}));const i=LadiChat.storeConfig.unread_message&&LadiChat.storeConfig.unread_message.length>0?LadiChat.storeConfig.unread_message.length:"",a=document.createElement("span");a.setAttribute("class","badge-new-message"),a.setAttribute("id","badge-new-message");const o=document.createTextNode(i);if(a.appendChild(o),i>0&&a.classList.add("visible"),LadiChat.chatWidgetOpen.appendChild(a),LadiChat.chatWidget.appendChild(LadiChat.chatWidgetOpen),e.appendChild(LadiChat.frameContainer),document.body.appendChild(e),LadiChat.iframeDoc=frames["ladichat-widget-frame"].contentWindow.document||frames["ladichat-widget-frame"].contentDocument,LadiChat.iframeDoc.open(),LadiChat.iframeDoc.close(),LadiChat.iframeDoc.documentElement.appendChild(LadiChat.chatWidget),await LadiChat.loadWidgetStyle(),LadiChat.storeConfig.user_info=LadiChat.userInfo,!LadiChat.storeConfig.is_online&&!n.show_widget_when_offline)return;LadiChat_Helper.setCookie(LadiChat_Config.STORE_CONFIG_COOKIE+LadiChat.storeID,JSON.stringify(LadiChat.storeConfig),30);let s=!1;const r={token:this.token},c=await LadiChat_Helper.sendPOSTRequest(LadiChat_Static_Config.END_POINT,LadiChat_Config.API_ROUTE.LIST_CONVERSATION,r);200==c.code&&(s=c.data.conversations.length>0),LadiChat.retouchScreen(s),LadiChat.initSuccess=!0}catch(e){console.log(e)}}retouchScreen(e){try{const t=LadiChat.storeConfig.startPage;if(LadiChat.storeConfig.user_info.screen_name)switch(LadiChat.storeConfig.user_info.screen_name){case LadiChat_Config.SCREEN_NAME.SURVEY_PAGE:t.is_enable?LadiChat.showStartPage():LadiChat.showConversationPage();break;case LadiChat_Config.SCREEN_NAME.LIST_CONVERSATION_PAGE:e?LadiChat.showConversationPage():LadiChat.showConversationStream();break;case LadiChat_Config.SCREEN_NAME.MESSENGER_PAGE:LadiChat.storeConfig.user_info.conversation?LadiChat.showConversationStream(LadiChat.storeConfig.user_info.conversation):e?LadiChat.showConversationPage():LadiChat.showConversationStream()}else t.survey_enable&&!LadiChat.storeConfig.user_info.is_complete_survey&&t.is_enable?LadiChat.showStartPage():e?LadiChat.showConversationPage():LadiChat.showConversationStream()}catch(e){console.log(e)}}toastr(e,t,n,i,a){try{void 0===e&&(e="error"),void 0===t&&(t=""),void 0===n&&(n=""),void 0===i&&(i=5e3),void 0===a&&(a="top-right");var o=document.getElementById("ladiui-toast-container");o||((o=document.createElement("div")).setAttribute("id","ladiui-toast-container"),o.setAttribute("class","toast-"+a));var s=document.createElement("div");s.setAttribute("class","ladiui-toast toast-"+e),s.setAttribute("order",LadiChat.toastCount++);var r=document.createElement("div");r.setAttribute("class","ladiui-toast-title"),t=document.createTextNode(t),r.appendChild(t),s.appendChild(r);var c=document.createElement("div");c.setAttribute("class","ladiui-toast-message"),c.innerHTML=n,s.appendChild(c),o.appendChild(s),LadiChat.iframeDoc.body.appendChild(o),setTimeout(function(){s.remove()}.bind(s),i)}catch(e){console.log(e)}}async processQueue(){try{if(LadiChat&&LadiChat.commandQueue&&LadiChat.commandQueue.length>0){LadiChat.isProcessQueue=!0;const e=LadiChat.commandQueue[0];if(e.length<2)return LadiChat.nextEvent(),null;const t=e[0]||"",n=e[1]||"",i=e.length>=3?e[2]:"";if(""==t||""==n||n.indexOf(":")<0)return LadiChat.nextEvent(),null;const a=n.split(":"),o=a[0],s=a[1];if("set"===t||"get"===t){const e={cmd:t,target_name:o,target_field:s,target_value:i},n={"content-type":"application/json","session-key":LadiChat.token};200===(await LadiChat_Helper.sendPOSTRequest(LadiChat_Static_Config.END_POINT,LadiChat_Config.API_ROUTE.CUSTOM_COMMAND,e,n)).code&&"user"===o&&(LadiChat.storeConfig.user_info.is_complete_survey=!0,LadiChat.userInfo.is_complete_survey=!0,LadiChat.userInfo[s]=i,LadiChat_Helper.setCookie(LadiChat_Config.USER_INFO_COOKIE+LadiChat.storeID,JSON.stringify(LadiChat.userInfo),30))}return"do"===t&&"chat"===o&&"open"===s&&LadiChat.openWidget(),"do"===t&&"chat"===o&&"closed"===s&&LadiChat.closeWidget(),"on"===t&&"chat"===o&&"closed"===s&&(LadiChat.closeWidget(),"function"==typeof i&&(LadiChat.closeCallBack=i)),LadiChat.nextEvent(),!0}}catch(e){console.log(e)}}nextEvent(){LadiChat.commandQueue.shift(),LadiChat.isProcessQueue=!1,LadiChat.timeoutID&&(clearTimeout(LadiChat.timeoutID),LadiChat.timeoutID=null),LadiChat.commandQueue.length>0&&(LadiChat.timeoutID=setTimeout(LadiChat.processQueue,200))}push(e){if(e.length<2)return null;LadiChat.commandQueue||(LadiChat.commandQueue=[]),LadiChat.commandQueue.push(e),LadiChat.isProcessQueue||LadiChat.timeoutID||!LadiChat.initSuccess||(LadiChat.timeoutID=setTimeout(LadiChat.processQueue,200))}closeWidget(){LadiChat.chatWidget.style.display="none","function"==typeof LadiChat.closeCallBack&&LadiChat.closeCallBack.call()}openWidget(){const e=LadiChat.iframeDoc.getElementById("svg-icon");LadiChat.chatWidget.style.display="block",LadiChat.chatContainer.classList.add("is-visible"),LadiChat.chatWidgetOpen.classList.remove("close"),LadiChat.chatWidgetOpen.classList.add("open"),LadiChat.frameContainer.style.width="520px",LadiChat.frameContainer.style.height="100%",e.innerHTML=LadiChat.openSVG,LadiChat.userInfo.is_show_widget=!0}}!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.io=t():e.io=t()}(this,(function(){return function(e){function t(i){if(n[i])return n[i].exports;var a=n[i]={exports:{},id:i,loaded:!1};return e[i].call(a.exports,a,a.exports,t),a.loaded=!0,a.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){function i(e,t){"object"==typeof e&&(t=e,e=void 0),t=t||{};var n,i=a(e),o=i.source,l=i.id,h=i.path,d=c[l]&&h in c[l].nsps;return t.forceNew||t["force new connection"]||!1===t.multiplex||d?(r("ignoring socket cache for %s",o),n=s(o,t)):(c[l]||(r("new io instance for %s",o),c[l]=s(o,t)),n=c[l]),i.query&&!t.query&&(t.query=i.query),n.socket(i.path,t)}var a=n(1),o=n(7),s=n(15),r=n(3)("socket.io-client");e.exports=t=i;var c=t.managers={};t.protocol=o.protocol,t.connect=i,t.Manager=n(15),t.Socket=n(39)},function(e,t,n){var i=n(2),a=n(3)("socket.io-client:url");e.exports=function(e,t){var n=e;t=t||"undefined"!=typeof location&&location,null==e&&(e=t.protocol+"//"+t.host),"string"==typeof e&&("/"===e.charAt(0)&&(e="/"===e.charAt(1)?t.protocol+e:t.host+e),/^(https?|wss?):\/\//.test(e)||(a("protocol-less url %s",e),e=void 0!==t?t.protocol+"//"+e:"https://"+e),a("parse %s",e),n=i(e)),n.port||(/^(http|ws)$/.test(n.protocol)?n.port="80":/^(http|ws)s$/.test(n.protocol)&&(n.port="443")),n.path=n.path||"/";var o=-1!==n.host.indexOf(":")?"["+n.host+"]":n.host;return n.id=n.protocol+"://"+o+":"+n.port,n.href=n.protocol+"://"+o+(t&&t.port===n.port?"":":"+n.port),n}},function(e,t){var n=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,i=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];e.exports=function(e){var t=e,a=e.indexOf("["),o=e.indexOf("]");-1!=a&&-1!=o&&(e=e.substring(0,a)+e.substring(a,o).replace(/:/g,";")+e.substring(o,e.length));for(var s=n.exec(e||""),r={},c=14;c--;)r[i[c]]=s[c]||"";return-1!=a&&-1!=o&&(r.source=t,r.host=r.host.substring(1,r.host.length-1).replace(/;/g,":"),r.authority=r.authority.replace("[","").replace("]","").replace(/;/g,":"),r.ipv6uri=!0),r}},function(e,t,n){(function(i){var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t.log=function(){var e;return"object"===("undefined"==typeof console?"undefined":a(console))&&console.log&&(e=console).log.apply(e,arguments)},t.formatArgs=function(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),this.useColors){var n="color: "+this.color;t.splice(1,0,n,"color: inherit");var i=0,a=0;t[0].replace(/%[a-zA-Z%]/g,(function(e){"%%"!==e&&(i++,"%c"===e&&(a=i))})),t.splice(a,0,n)}},t.save=function(e){try{e?t.storage.setItem("debug",e):t.storage.removeItem("debug")}catch(e){}},t.load=function(){var e=void 0;try{e=t.storage.getItem("debug")}catch(e){}return!e&&void 0!==i&&"env"in i&&(e=i.env.DEBUG),e},t.useColors=function(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type&&!window.process.__nwjs)||("undefined"==typeof navigator||!navigator.userAgent||!navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},t.storage=function(){try{return localStorage}catch(e){}}(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],e.exports=n(5)(t),e.exports.formatters.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}}).call(t,n(4))},function(e,t){function n(){throw new Error("setTimeout has not been defined")}function i(){throw new Error("clearTimeout has not been defined")}function a(e){if(l===setTimeout)return setTimeout(e,0);if((l===n||!l)&&setTimeout)return l=setTimeout,setTimeout(e,0);try{return l(e,0)}catch(t){try{return l.call(null,e,0)}catch(t){return l.call(this,e,0)}}}function o(){p&&u&&(p=!1,u.length?f=u.concat(f):g=-1,f.length&&s())}function s(){if(!p){var e=a(o);p=!0;for(var t=f.length;t;){for(u=f,f=[];++g<t;)u&&u[g].run();g=-1,t=f.length}u=null,p=!1,function(e){if(h===clearTimeout)return clearTimeout(e);if((h===i||!h)&&clearTimeout)return h=clearTimeout,clearTimeout(e);try{h(e)}catch(t){try{return h.call(null,e)}catch(t){return h.call(this,e)}}}(e)}}function r(e,t){this.fun=e,this.array=t}function c(){}var l,h,d=e.exports={};!function(){try{l="function"==typeof setTimeout?setTimeout:n}catch(e){l=n}try{h="function"==typeof clearTimeout?clearTimeout:i}catch(e){h=i}}();var u,f=[],p=!1,g=-1;d.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];f.push(new r(e,t)),1!==f.length||p||a(s)},r.prototype.run=function(){this.fun.apply(null,this.array)},d.title="browser",d.browser=!0,d.env={},d.argv=[],d.version="",d.versions={},d.on=c,d.addListener=c,d.once=c,d.off=c,d.removeListener=c,d.removeAllListeners=c,d.emit=c,d.prependListener=c,d.prependOnceListener=c,d.listeners=function(e){return[]},d.binding=function(e){throw new Error("process.binding is not supported")},d.cwd=function(){return"/"},d.chdir=function(e){throw new Error("process.chdir is not supported")},d.umask=function(){return 0}},function(e,t,n){function i(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}e.exports=function(e){function t(e){for(var t=0,n=0;n<e.length;n++)t=(t<<5)-t+e.charCodeAt(n),t|=0;return a.colors[Math.abs(t)%a.colors.length]}function a(e){function n(){for(var e=arguments.length,t=Array(e),o=0;o<e;o++)t[o]=arguments[o];if(n.enabled){var s=n,r=Number(new Date),c=r-(i||r);s.diff=c,s.prev=i,s.curr=r,i=r,t[0]=a.coerce(t[0]),"string"!=typeof t[0]&&t.unshift("%O");var l=0;t[0]=t[0].replace(/%([a-zA-Z%])/g,(function(e,n){if("%%"===e)return e;l++;var i=a.formatters[n];if("function"==typeof i){var o=t[l];e=i.call(s,o),t.splice(l,1),l--}return e})),a.formatArgs.call(s,t);var h=s.log||a.log;h.apply(s,t)}}var i=void 0;return n.namespace=e,n.enabled=a.enabled(e),n.useColors=a.useColors(),n.color=t(e),n.destroy=o,n.extend=s,"function"==typeof a.init&&a.init(n),a.instances.push(n),n}function o(){var e=a.instances.indexOf(this);return-1!==e&&(a.instances.splice(e,1),!0)}function s(e,t){var n=a(this.namespace+(void 0===t?":":t)+e);return n.log=this.log,n}function r(e){return e.toString().substring(2,e.toString().length-2).replace(/\.\*\?$/,"*")}return a.debug=a,a.default=a,a.coerce=function(e){return e instanceof Error?e.stack||e.message:e},a.disable=function(){var e=[].concat(i(a.names.map(r)),i(a.skips.map(r).map((function(e){return"-"+e})))).join(",");return a.enable(""),e},a.enable=function(e){a.save(e),a.names=[],a.skips=[];var t=void 0,n=("string"==typeof e?e:"").split(/[\s,]+/),i=n.length;for(t=0;t<i;t++)n[t]&&("-"===(e=n[t].replace(/\*/g,".*?"))[0]?a.skips.push(new RegExp("^"+e.substr(1)+"$")):a.names.push(new RegExp("^"+e+"$")));for(t=0;t<a.instances.length;t++){var o=a.instances[t];o.enabled=a.enabled(o.namespace)}},a.enabled=function(e){if("*"===e[e.length-1])return!0;var t=void 0,n=void 0;for(t=0,n=a.skips.length;t<n;t++)if(a.skips[t].test(e))return!1;for(t=0,n=a.names.length;t<n;t++)if(a.names[t].test(e))return!0;return!1},a.humanize=n(6),Object.keys(e).forEach((function(t){a[t]=e[t]})),a.instances=[],a.names=[],a.skips=[],a.formatters={},a.selectColor=t,a.enable(a.load()),a}},function(e,t){function n(e){var t=Math.abs(e);return t>=r?i(e,t,r,"day"):t>=s?i(e,t,s,"hour"):t>=o?i(e,t,o,"minute"):t>=a?i(e,t,a,"second"):e+" ms"}function i(e,t,n,i){var a=t>=1.5*n;return Math.round(e/n)+" "+i+(a?"s":"")}var a=1e3,o=60*a,s=60*o,r=24*s,c=7*r,l=365.25*r;e.exports=function(e,t){t=t||{};var i=typeof e;if("string"===i&&e.length>0)return function(e){if(!((e=String(e)).length>100)){var t=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(t){var n=parseFloat(t[1]);switch((t[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return n*l;case"weeks":case"week":case"w":return n*c;case"days":case"day":case"d":return n*r;case"hours":case"hour":case"hrs":case"hr":case"h":return n*s;case"minutes":case"minute":case"mins":case"min":case"m":return n*o;case"seconds":case"second":case"secs":case"sec":case"s":return n*a;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return n;default:return}}}}(e);if("number"===i&&isFinite(e))return t.long?n(e):function(e){var t=Math.abs(e);return t>=r?Math.round(e/r)+"d":t>=s?Math.round(e/s)+"h":t>=o?Math.round(e/o)+"m":t>=a?Math.round(e/a)+"s":e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},function(e,t,n){function i(){}function a(e){var n=""+e.type;if(t.BINARY_EVENT!==e.type&&t.BINARY_ACK!==e.type||(n+=e.attachments+"-"),e.nsp&&"/"!==e.nsp&&(n+=e.nsp+","),null!=e.id&&(n+=e.id),null!=e.data){var i=function(e){try{return JSON.stringify(e)}catch(e){return!1}}(e.data);if(!1===i)return f;n+=i}return c("encoded %j as %s",e,n),n}function o(){this.reconstructor=null}function s(e){this.reconPack=e,this.buffers=[]}function r(e){return{type:t.ERROR,data:"parser error: "+e}}var c=n(8)("socket.io-parser"),l=n(11),h=n(12),d=n(13),u=n(14);t.protocol=4,t.types=["CONNECT","DISCONNECT","EVENT","ACK","ERROR","BINARY_EVENT","BINARY_ACK"],t.CONNECT=0,t.DISCONNECT=1,t.EVENT=2,t.ACK=3,t.ERROR=4,t.BINARY_EVENT=5,t.BINARY_ACK=6,t.Encoder=i,t.Decoder=o;var f=t.ERROR+'"encode error"';i.prototype.encode=function(e,n){c("encoding packet %j",e),t.BINARY_EVENT===e.type||t.BINARY_ACK===e.type?function(e,t){h.removeBlobs(e,(function(e){var n=h.deconstructPacket(e),i=a(n.packet),o=n.buffers;o.unshift(i),t(o)}))}(e,n):n([a(e)])},l(o.prototype),o.prototype.add=function(e){var n;if("string"==typeof e)n=function(e){var n=0,i={type:Number(e.charAt(0))};if(null==t.types[i.type])return r("unknown packet type "+i.type);if(t.BINARY_EVENT===i.type||t.BINARY_ACK===i.type){for(var a="";"-"!==e.charAt(++n)&&(a+=e.charAt(n),n!=e.length););if(a!=Number(a)||"-"!==e.charAt(n))throw new Error("Illegal attachments");i.attachments=Number(a)}if("/"===e.charAt(n+1))for(i.nsp="";++n&&","!==(s=e.charAt(n))&&(i.nsp+=s,n!==e.length););else i.nsp="/";var o=e.charAt(n+1);if(""!==o&&Number(o)==o){for(i.id="";++n;){var s;if(null==(s=e.charAt(n))||Number(s)!=s){--n;break}if(i.id+=e.charAt(n),n===e.length)break}i.id=Number(i.id)}if(e.charAt(++n)){var l=function(e){try{return JSON.parse(e)}catch(e){return!1}}(e.substr(n));if(!1===l||i.type!==t.ERROR&&!d(l))return r("invalid payload");i.data=l}return c("decoded %s as %j",e,i),i}(e),t.BINARY_EVENT===n.type||t.BINARY_ACK===n.type?(this.reconstructor=new s(n),0===this.reconstructor.reconPack.attachments&&this.emit("decoded",n)):this.emit("decoded",n);else{if(!u(e)&&!e.base64)throw new Error("Unknown type: "+e);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");(n=this.reconstructor.takeBinaryData(e))&&(this.reconstructor=null,this.emit("decoded",n))}},o.prototype.destroy=function(){this.reconstructor&&this.reconstructor.finishedReconstruction()},s.prototype.takeBinaryData=function(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){var t=h.reconstructPacket(this.reconPack,this.buffers);return this.finishedReconstruction(),t}return null},s.prototype.finishedReconstruction=function(){this.reconPack=null,this.buffers=[]}},function(e,t,n){(function(i){function a(){var e;try{e=t.storage.debug}catch(e){}return!e&&void 0!==i&&"env"in i&&(e=i.env.DEBUG),e}var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};(t=e.exports=n(9)).log=function(){return"object"===("undefined"==typeof console?"undefined":o(console))&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},t.formatArgs=function(e){var n=this.useColors;if(e[0]=(n?"%c":"")+this.namespace+(n?" %c":" ")+e[0]+(n?"%c ":" ")+"+"+t.humanize(this.diff),n){var i="color: "+this.color;e.splice(1,0,i,"color: inherit");var a=0,o=0;e[0].replace(/%[a-zA-Z%]/g,(function(e){"%%"!==e&&(a++,"%c"===e&&(o=a))})),e.splice(o,0,i)}},t.save=function(e){try{null==e?t.storage.removeItem("debug"):t.storage.debug=e}catch(e){}},t.load=a,t.useColors=function(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type)||("undefined"==typeof navigator||!navigator.userAgent||!navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},t.storage="undefined"!=typeof chrome&&void 0!==chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(e){}}(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.formatters.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}},t.enable(a())}).call(t,n(4))},function(e,t,n){function i(e){function n(){if(n.enabled){var e=n,a=+new Date,o=a-(i||a);e.diff=o,e.prev=i,e.curr=a,i=a;for(var s=new Array(arguments.length),r=0;r<s.length;r++)s[r]=arguments[r];s[0]=t.coerce(s[0]),"string"!=typeof s[0]&&s.unshift("%O");var c=0;s[0]=s[0].replace(/%([a-zA-Z%])/g,(function(n,i){if("%%"===n)return n;c++;var a=t.formatters[i];if("function"==typeof a){var o=s[c];n=a.call(e,o),s.splice(c,1),c--}return n})),t.formatArgs.call(e,s);var l=n.log||t.log||console.log.bind(console);l.apply(e,s)}}var i;return n.namespace=e,n.enabled=t.enabled(e),n.useColors=t.useColors(),n.color=function(e){var n,i=0;for(n in e)i=(i<<5)-i+e.charCodeAt(n),i|=0;return t.colors[Math.abs(i)%t.colors.length]}(e),n.destroy=a,"function"==typeof t.init&&t.init(n),t.instances.push(n),n}function a(){var e=t.instances.indexOf(this);return-1!==e&&(t.instances.splice(e,1),!0)}(t=e.exports=i.debug=i.default=i).coerce=function(e){return e instanceof Error?e.stack||e.message:e},t.disable=function(){t.enable("")},t.enable=function(e){t.save(e),t.names=[],t.skips=[];var n,i=("string"==typeof e?e:"").split(/[\s,]+/),a=i.length;for(n=0;n<a;n++)i[n]&&("-"===(e=i[n].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.substr(1)+"$")):t.names.push(new RegExp("^"+e+"$")));for(n=0;n<t.instances.length;n++){var o=t.instances[n];o.enabled=t.enabled(o.namespace)}},t.enabled=function(e){if("*"===e[e.length-1])return!0;var n,i;for(n=0,i=t.skips.length;n<i;n++)if(t.skips[n].test(e))return!1;for(n=0,i=t.names.length;n<i;n++)if(t.names[n].test(e))return!0;return!1},t.humanize=n(10),t.instances=[],t.names=[],t.skips=[],t.formatters={}},function(e,t){function n(e){return i(e,r,"day")||i(e,s,"hour")||i(e,o,"minute")||i(e,a,"second")||e+" ms"}function i(e,t,n){if(!(e<t))return e<1.5*t?Math.floor(e/t)+" "+n:Math.ceil(e/t)+" "+n+"s"}var a=1e3,o=60*a,s=60*o,r=24*s,c=365.25*r;e.exports=function(e,t){t=t||{};var i=typeof e;if("string"===i&&e.length>0)return function(e){if(!((e=String(e)).length>100)){var t=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(e);if(t){var n=parseFloat(t[1]);switch((t[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return n*c;case"days":case"day":case"d":return n*r;case"hours":case"hour":case"hrs":case"hr":case"h":return n*s;case"minutes":case"minute":case"mins":case"min":case"m":return n*o;case"seconds":case"second":case"secs":case"sec":case"s":return n*a;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return n;default:return}}}}(e);if("number"===i&&!1===isNaN(e))return t.long?n(e):function(e){return e>=r?Math.round(e/r)+"d":e>=s?Math.round(e/s)+"h":e>=o?Math.round(e/o)+"m":e>=a?Math.round(e/a)+"s":e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},function(e,t,n){function i(e){if(e)return function(e){for(var t in i.prototype)e[t]=i.prototype[t];return e}(e)}e.exports=i,i.prototype.on=i.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t),this},i.prototype.once=function(e,t){function n(){this.off(e,n),t.apply(this,arguments)}return n.fn=t,this.on(e,n),this},i.prototype.off=i.prototype.removeListener=i.prototype.removeAllListeners=i.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n=this._callbacks["$"+e];if(!n)return this;if(1==arguments.length)return delete this._callbacks["$"+e],this;for(var i,a=0;a<n.length;a++)if((i=n[a])===t||i.fn===t){n.splice(a,1);break}return this},i.prototype.emit=function(e){this._callbacks=this._callbacks||{};var t=[].slice.call(arguments,1),n=this._callbacks["$"+e];if(n)for(var i=0,a=(n=n.slice(0)).length;i<a;++i)n[i].apply(this,t);return this},i.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]},i.prototype.hasListeners=function(e){return!!this.listeners(e).length}},function(e,t,n){function i(e,t){if(!e)return e;if(s(e)){var n={_placeholder:!0,num:t.length};return t.push(e),n}if(o(e)){for(var a=new Array(e.length),r=0;r<e.length;r++)a[r]=i(e[r],t);return a}if("object"==typeof e&&!(e instanceof Date)){for(var c in a={},e)a[c]=i(e[c],t);return a}return e}function a(e,t){if(!e)return e;if(e&&e._placeholder)return t[e.num];if(o(e))for(var n=0;n<e.length;n++)e[n]=a(e[n],t);else if("object"==typeof e)for(var i in e)e[i]=a(e[i],t);return e}var o=n(13),s=n(14),r=Object.prototype.toString,c="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===r.call(Blob),l="function"==typeof File||"undefined"!=typeof File&&"[object FileConstructor]"===r.call(File);t.deconstructPacket=function(e){var t=[],n=e.data,a=e;return a.data=i(n,t),a.attachments=t.length,{packet:a,buffers:t}},t.reconstructPacket=function(e,t){return e.data=a(e.data,t),e.attachments=void 0,e},t.removeBlobs=function(e,t){var n=0,i=e;(function e(a,r,h){if(!a)return a;if(c&&a instanceof Blob||l&&a instanceof File){n++;var d=new FileReader;d.onload=function(){h?h[r]=this.result:i=this.result,--n||t(i)},d.readAsArrayBuffer(a)}else if(o(a))for(var u=0;u<a.length;u++)e(a[u],u,a);else if("object"==typeof a&&!s(a))for(var f in a)e(a[f],f,a)})(i),n||t(i)}},function(e,t){var n={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==n.call(e)}},function(e,t){e.exports=function(e){return n&&Buffer.isBuffer(e)||i&&(e instanceof ArrayBuffer||a(e))};var n="function"==typeof Buffer&&"function"==typeof Buffer.isBuffer,i="function"==typeof ArrayBuffer,a=function(e){return"function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(e):e.buffer instanceof ArrayBuffer}},function(e,t,n){function i(e,t){if(!(this instanceof i))return new i(e,t);e&&"object"==typeof e&&(t=e,e=void 0),(t=t||{}).path=t.path||"/socket.io",this.nsps={},this.subs=[],this.opts=t,this.reconnection(!1!==t.reconnection),this.reconnectionAttempts(t.reconnectionAttempts||1/0),this.reconnectionDelay(t.reconnectionDelay||1e3),this.reconnectionDelayMax(t.reconnectionDelayMax||5e3),this.randomizationFactor(t.randomizationFactor||.5),this.backoff=new u({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==t.timeout?2e4:t.timeout),this.readyState="closed",this.uri=e,this.connecting=[],this.lastPing=null,this.encoding=!1,this.packetBuffer=[];var n=t.parser||r;this.encoder=new n.Encoder,this.decoder=new n.Decoder,this.autoConnect=!1!==t.autoConnect,this.autoConnect&&this.open()}var a=n(16),o=n(39),s=n(11),r=n(7),c=n(41),l=n(42),h=n(3)("socket.io-client:manager"),d=n(38),u=n(43),f=Object.prototype.hasOwnProperty;e.exports=i,i.prototype.emitAll=function(){for(var e in this.emit.apply(this,arguments),this.nsps)f.call(this.nsps,e)&&this.nsps[e].emit.apply(this.nsps[e],arguments)},i.prototype.updateSocketIds=function(){for(var e in this.nsps)f.call(this.nsps,e)&&(this.nsps[e].id=this.generateId(e))},i.prototype.generateId=function(e){return("/"===e?"":e+"#")+this.engine.id},s(i.prototype),i.prototype.reconnection=function(e){return arguments.length?(this._reconnection=!!e,this):this._reconnection},i.prototype.reconnectionAttempts=function(e){return arguments.length?(this._reconnectionAttempts=e,this):this._reconnectionAttempts},i.prototype.reconnectionDelay=function(e){return arguments.length?(this._reconnectionDelay=e,this.backoff&&this.backoff.setMin(e),this):this._reconnectionDelay},i.prototype.randomizationFactor=function(e){return arguments.length?(this._randomizationFactor=e,this.backoff&&this.backoff.setJitter(e),this):this._randomizationFactor},i.prototype.reconnectionDelayMax=function(e){return arguments.length?(this._reconnectionDelayMax=e,this.backoff&&this.backoff.setMax(e),this):this._reconnectionDelayMax},i.prototype.timeout=function(e){return arguments.length?(this._timeout=e,this):this._timeout},i.prototype.maybeReconnectOnOpen=function(){!this.reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()},i.prototype.open=i.prototype.connect=function(e,t){if(h("readyState %s",this.readyState),~this.readyState.indexOf("open"))return this;h("opening %s",this.uri),this.engine=a(this.uri,this.opts);var n=this.engine,i=this;this.readyState="opening",this.skipReconnect=!1;var o=c(n,"open",(function(){i.onopen(),e&&e()})),s=c(n,"error",(function(t){if(h("connect_error"),i.cleanup(),i.readyState="closed",i.emitAll("connect_error",t),e){var n=new Error("Connection error");n.data=t,e(n)}else i.maybeReconnectOnOpen()}));if(!1!==this._timeout){var r=this._timeout;h("connect attempt will timeout after %d",r);var l=setTimeout((function(){h("connect attempt timed out after %d",r),o.destroy(),n.close(),n.emit("error","timeout"),i.emitAll("connect_timeout",r)}),r);this.subs.push({destroy:function(){clearTimeout(l)}})}return this.subs.push(o),this.subs.push(s),this},i.prototype.onopen=function(){h("open"),this.cleanup(),this.readyState="open",this.emit("open");var e=this.engine;this.subs.push(c(e,"data",l(this,"ondata"))),this.subs.push(c(e,"ping",l(this,"onping"))),this.subs.push(c(e,"pong",l(this,"onpong"))),this.subs.push(c(e,"error",l(this,"onerror"))),this.subs.push(c(e,"close",l(this,"onclose"))),this.subs.push(c(this.decoder,"decoded",l(this,"ondecoded")))},i.prototype.onping=function(){this.lastPing=new Date,this.emitAll("ping")},i.prototype.onpong=function(){this.emitAll("pong",new Date-this.lastPing)},i.prototype.ondata=function(e){this.decoder.add(e)},i.prototype.ondecoded=function(e){this.emit("packet",e)},i.prototype.onerror=function(e){h("error",e),this.emitAll("error",e)},i.prototype.socket=function(e,t){function n(){~d(a.connecting,i)||a.connecting.push(i)}var i=this.nsps[e];if(!i){i=new o(this,e,t),this.nsps[e]=i;var a=this;i.on("connecting",n),i.on("connect",(function(){i.id=a.generateId(e)})),this.autoConnect&&n()}return i},i.prototype.destroy=function(e){var t=d(this.connecting,e);~t&&this.connecting.splice(t,1),this.connecting.length||this.close()},i.prototype.packet=function(e){h("writing packet %j",e);var t=this;e.query&&0===e.type&&(e.nsp+="?"+e.query),t.encoding?t.packetBuffer.push(e):(t.encoding=!0,this.encoder.encode(e,(function(n){for(var i=0;i<n.length;i++)t.engine.write(n[i],e.options);t.encoding=!1,t.processPacketQueue()})))},i.prototype.processPacketQueue=function(){if(this.packetBuffer.length>0&&!this.encoding){var e=this.packetBuffer.shift();this.packet(e)}},i.prototype.cleanup=function(){h("cleanup");for(var e=this.subs.length,t=0;t<e;t++)this.subs.shift().destroy();this.packetBuffer=[],this.encoding=!1,this.lastPing=null,this.decoder.destroy()},i.prototype.close=i.prototype.disconnect=function(){h("disconnect"),this.skipReconnect=!0,this.reconnecting=!1,"opening"===this.readyState&&this.cleanup(),this.backoff.reset(),this.readyState="closed",this.engine&&this.engine.close()},i.prototype.onclose=function(e){h("onclose"),this.cleanup(),this.backoff.reset(),this.readyState="closed",this.emit("close",e),this._reconnection&&!this.skipReconnect&&this.reconnect()},i.prototype.reconnect=function(){if(this.reconnecting||this.skipReconnect)return this;var e=this;if(this.backoff.attempts>=this._reconnectionAttempts)h("reconnect failed"),this.backoff.reset(),this.emitAll("reconnect_failed"),this.reconnecting=!1;else{var t=this.backoff.duration();h("will wait %dms before reconnect attempt",t),this.reconnecting=!0;var n=setTimeout((function(){e.skipReconnect||(h("attempting reconnect"),e.emitAll("reconnect_attempt",e.backoff.attempts),e.emitAll("reconnecting",e.backoff.attempts),e.skipReconnect||e.open((function(t){t?(h("reconnect attempt error"),e.reconnecting=!1,e.reconnect(),e.emitAll("reconnect_error",t.data)):(h("reconnect success"),e.onreconnect())})))}),t);this.subs.push({destroy:function(){clearTimeout(n)}})}},i.prototype.onreconnect=function(){var e=this.backoff.attempts;this.reconnecting=!1,this.backoff.reset(),this.updateSocketIds(),this.emitAll("reconnect",e)}},function(e,t,n){e.exports=n(17),e.exports.parser=n(24)},function(e,t,n){function i(e,t){return this instanceof i?(t=t||{},e&&"object"==typeof e&&(t=e,e=null),e?(e=l(e),t.hostname=e.host,t.secure="https"===e.protocol||"wss"===e.protocol,t.port=e.port,e.query&&(t.query=e.query)):t.host&&(t.hostname=l(t.host).host),this.secure=null!=t.secure?t.secure:"undefined"!=typeof location&&"https:"===location.protocol,t.hostname&&!t.port&&(t.port=this.secure?"443":"80"),this.agent=t.agent||!1,this.hostname=t.hostname||("undefined"!=typeof location?location.hostname:"localhost"),this.port=t.port||("undefined"!=typeof location&&location.port?location.port:this.secure?443:80),this.query=t.query||{},"string"==typeof this.query&&(this.query=h.decode(this.query)),this.upgrade=!1!==t.upgrade,this.path=(t.path||"/engine.io").replace(/\/$/,"")+"/",this.forceJSONP=!!t.forceJSONP,this.jsonp=!1!==t.jsonp,this.forceBase64=!!t.forceBase64,this.enablesXDR=!!t.enablesXDR,this.withCredentials=!1!==t.withCredentials,this.timestampParam=t.timestampParam||"t",this.timestampRequests=t.timestampRequests,this.transports=t.transports||["polling","websocket"],this.transportOptions=t.transportOptions||{},this.readyState="",this.writeBuffer=[],this.prevBufferLen=0,this.policyPort=t.policyPort||843,this.rememberUpgrade=t.rememberUpgrade||!1,this.binaryType=null,this.onlyBinaryUpgrades=t.onlyBinaryUpgrades,this.perMessageDeflate=!1!==t.perMessageDeflate&&(t.perMessageDeflate||{}),!0===this.perMessageDeflate&&(this.perMessageDeflate={}),this.perMessageDeflate&&null==this.perMessageDeflate.threshold&&(this.perMessageDeflate.threshold=1024),this.pfx=t.pfx||null,this.key=t.key||null,this.passphrase=t.passphrase||null,this.cert=t.cert||null,this.ca=t.ca||null,this.ciphers=t.ciphers||null,this.rejectUnauthorized=void 0===t.rejectUnauthorized||t.rejectUnauthorized,this.forceNode=!!t.forceNode,this.isReactNative="undefined"!=typeof navigator&&"string"==typeof navigator.product&&"reactnative"===navigator.product.toLowerCase(),("undefined"==typeof self||this.isReactNative)&&(t.extraHeaders&&Object.keys(t.extraHeaders).length>0&&(this.extraHeaders=t.extraHeaders),t.localAddress&&(this.localAddress=t.localAddress)),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingIntervalTimer=null,this.pingTimeoutTimer=null,void this.open()):new i(e,t)}var a=n(18),o=n(11),s=n(3)("engine.io-client:socket"),r=n(38),c=n(24),l=n(2),h=n(32);e.exports=i,i.priorWebsocketSuccess=!1,o(i.prototype),i.protocol=c.protocol,i.Socket=i,i.Transport=n(23),i.transports=n(18),i.parser=n(24),i.prototype.createTransport=function(e){s('creating transport "%s"',e);var t=function(e){var t={};for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}(this.query);t.EIO=c.protocol,t.transport=e;var n=this.transportOptions[e]||{};return this.id&&(t.sid=this.id),new a[e]({query:t,socket:this,agent:n.agent||this.agent,hostname:n.hostname||this.hostname,port:n.port||this.port,secure:n.secure||this.secure,path:n.path||this.path,forceJSONP:n.forceJSONP||this.forceJSONP,jsonp:n.jsonp||this.jsonp,forceBase64:n.forceBase64||this.forceBase64,enablesXDR:n.enablesXDR||this.enablesXDR,withCredentials:n.withCredentials||this.withCredentials,timestampRequests:n.timestampRequests||this.timestampRequests,timestampParam:n.timestampParam||this.timestampParam,policyPort:n.policyPort||this.policyPort,pfx:n.pfx||this.pfx,key:n.key||this.key,passphrase:n.passphrase||this.passphrase,cert:n.cert||this.cert,ca:n.ca||this.ca,ciphers:n.ciphers||this.ciphers,rejectUnauthorized:n.rejectUnauthorized||this.rejectUnauthorized,perMessageDeflate:n.perMessageDeflate||this.perMessageDeflate,extraHeaders:n.extraHeaders||this.extraHeaders,forceNode:n.forceNode||this.forceNode,localAddress:n.localAddress||this.localAddress,requestTimeout:n.requestTimeout||this.requestTimeout,protocols:n.protocols||void 0,isReactNative:this.isReactNative})},i.prototype.open=function(){var e;if(this.rememberUpgrade&&i.priorWebsocketSuccess&&-1!==this.transports.indexOf("websocket"))e="websocket";else{if(0===this.transports.length){var t=this;return void setTimeout((function(){t.emit("error","No transports available")}),0)}e=this.transports[0]}this.readyState="opening";try{e=this.createTransport(e)}catch(e){return this.transports.shift(),void this.open()}e.open(),this.setTransport(e)},i.prototype.setTransport=function(e){s("setting transport %s",e.name);var t=this;this.transport&&(s("clearing existing transport %s",this.transport.name),this.transport.removeAllListeners()),this.transport=e,e.on("drain",(function(){t.onDrain()})).on("packet",(function(e){t.onPacket(e)})).on("error",(function(e){t.onError(e)})).on("close",(function(){t.onClose("transport close")}))},i.prototype.probe=function(e){function t(){if(u.onlyBinaryUpgrades){var t=!this.supportsBinary&&u.transport.supportsBinary;d=d||t}d||(s('probe transport "%s" opened',e),h.send([{type:"ping",data:"probe"}]),h.once("packet",(function(t){if(!d)if("pong"===t.type&&"probe"===t.data){if(s('probe transport "%s" pong',e),u.upgrading=!0,u.emit("upgrading",h),!h)return;i.priorWebsocketSuccess="websocket"===h.name,s('pausing current transport "%s"',u.transport.name),u.transport.pause((function(){d||"closed"!==u.readyState&&(s("changing transport and sending upgrade packet"),l(),u.setTransport(h),h.send([{type:"upgrade"}]),u.emit("upgrade",h),h=null,u.upgrading=!1,u.flush())}))}else{s('probe transport "%s" failed',e);var n=new Error("probe error");n.transport=h.name,u.emit("upgradeError",n)}})))}function n(){d||(d=!0,l(),h.close(),h=null)}function a(t){var i=new Error("probe error: "+t);i.transport=h.name,n(),s('probe transport "%s" failed because of error: %s',e,t),u.emit("upgradeError",i)}function o(){a("transport closed")}function r(){a("socket closed")}function c(e){h&&e.name!==h.name&&(s('"%s" works - aborting "%s"',e.name,h.name),n())}function l(){h.removeListener("open",t),h.removeListener("error",a),h.removeListener("close",o),u.removeListener("close",r),u.removeListener("upgrading",c)}s('probing transport "%s"',e);var h=this.createTransport(e,{probe:1}),d=!1,u=this;i.priorWebsocketSuccess=!1,h.once("open",t),h.once("error",a),h.once("close",o),this.once("close",r),this.once("upgrading",c),h.open()},i.prototype.onOpen=function(){if(s("socket open"),this.readyState="open",i.priorWebsocketSuccess="websocket"===this.transport.name,this.emit("open"),this.flush(),"open"===this.readyState&&this.upgrade&&this.transport.pause){s("starting upgrade probes");for(var e=0,t=this.upgrades.length;e<t;e++)this.probe(this.upgrades[e])}},i.prototype.onPacket=function(e){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(s('socket receive: type "%s", data "%s"',e.type,e.data),this.emit("packet",e),this.emit("heartbeat"),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"pong":this.setPing(),this.emit("pong");break;case"error":var t=new Error("server error");t.code=e.data,this.onError(t);break;case"message":this.emit("data",e.data),this.emit("message",e.data)}else s('packet received with socket readyState "%s"',this.readyState)},i.prototype.onHandshake=function(e){this.emit("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this.upgrades=this.filterUpgrades(e.upgrades),this.pingInterval=e.pingInterval,this.pingTimeout=e.pingTimeout,this.onOpen(),"closed"!==this.readyState&&(this.setPing(),this.removeListener("heartbeat",this.onHeartbeat),this.on("heartbeat",this.onHeartbeat))},i.prototype.onHeartbeat=function(e){clearTimeout(this.pingTimeoutTimer);var t=this;t.pingTimeoutTimer=setTimeout((function(){"closed"!==t.readyState&&t.onClose("ping timeout")}),e||t.pingInterval+t.pingTimeout)},i.prototype.setPing=function(){var e=this;clearTimeout(e.pingIntervalTimer),e.pingIntervalTimer=setTimeout((function(){s("writing ping packet - expecting pong within %sms",e.pingTimeout),e.ping(),e.onHeartbeat(e.pingTimeout)}),e.pingInterval)},i.prototype.ping=function(){var e=this;this.sendPacket("ping",(function(){e.emit("ping")}))},i.prototype.onDrain=function(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,0===this.writeBuffer.length?this.emit("drain"):this.flush()},i.prototype.flush=function(){"closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length&&(s("flushing %d packets in socket",this.writeBuffer.length),this.transport.send(this.writeBuffer),this.prevBufferLen=this.writeBuffer.length,this.emit("flush"))},i.prototype.write=i.prototype.send=function(e,t,n){return this.sendPacket("message",e,t,n),this},i.prototype.sendPacket=function(e,t,n,i){if("function"==typeof t&&(i=t,t=void 0),"function"==typeof n&&(i=n,n=null),"closing"!==this.readyState&&"closed"!==this.readyState){(n=n||{}).compress=!1!==n.compress;var a={type:e,data:t,options:n};this.emit("packetCreate",a),this.writeBuffer.push(a),i&&this.once("flush",i),this.flush()}},i.prototype.close=function(){function e(){i.onClose("forced close"),s("socket closing - telling transport to close"),i.transport.close()}function t(){i.removeListener("upgrade",t),i.removeListener("upgradeError",t),e()}function n(){i.once("upgrade",t),i.once("upgradeError",t)}if("opening"===this.readyState||"open"===this.readyState){this.readyState="closing";var i=this;this.writeBuffer.length?this.once("drain",(function(){this.upgrading?n():e()})):this.upgrading?n():e()}return this},i.prototype.onError=function(e){s("socket error %j",e),i.priorWebsocketSuccess=!1,this.emit("error",e),this.onClose("transport error",e)},i.prototype.onClose=function(e,t){"opening"!==this.readyState&&"open"!==this.readyState&&"closing"!==this.readyState||(s('socket close with reason: "%s"',e),clearTimeout(this.pingIntervalTimer),clearTimeout(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),this.readyState="closed",this.id=null,this.emit("close",e,t),this.writeBuffer=[],this.prevBufferLen=0)},i.prototype.filterUpgrades=function(e){for(var t=[],n=0,i=e.length;n<i;n++)~r(this.transports,e[n])&&t.push(e[n]);return t}},function(e,t,n){var i=n(19),a=n(21),o=n(35),s=n(36);t.polling=function(e){var t=!1,n=!1,s=!1!==e.jsonp;if("undefined"!=typeof location){var r="https:"===location.protocol,c=location.port;c||(c=r?443:80),t=e.hostname!==location.hostname||c!==e.port,n=e.secure!==r}if(e.xdomain=t,e.xscheme=n,"open"in new i(e)&&!e.forceJSONP)return new a(e);if(!s)throw new Error("JSONP disabled");return new o(e)},t.websocket=s},function(e,t,n){var i=n(20);e.exports=function(e){var t=e.xdomain,n=e.xscheme,a=e.enablesXDR;try{if("undefined"!=typeof XMLHttpRequest&&(!t||i))return new XMLHttpRequest}catch(e){}try{if("undefined"!=typeof XDomainRequest&&!n&&a)return new XDomainRequest}catch(e){}if(!t)try{return new(self[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(e){}}},function(e,t){try{e.exports="undefined"!=typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(t){e.exports=!1}},function(e,t,n){function i(){}function a(e){if(c.call(this,e),this.requestTimeout=e.requestTimeout,this.extraHeaders=e.extraHeaders,"undefined"!=typeof location){var t="https:"===location.protocol,n=location.port;n||(n=t?443:80),this.xd="undefined"!=typeof location&&e.hostname!==location.hostname||n!==e.port,this.xs=e.secure!==t}}function o(e){this.method=e.method||"GET",this.uri=e.uri,this.xd=!!e.xd,this.xs=!!e.xs,this.async=!1!==e.async,this.data=void 0!==e.data?e.data:null,this.agent=e.agent,this.isBinary=e.isBinary,this.supportsBinary=e.supportsBinary,this.enablesXDR=e.enablesXDR,this.withCredentials=e.withCredentials,this.requestTimeout=e.requestTimeout,this.pfx=e.pfx,this.key=e.key,this.passphrase=e.passphrase,this.cert=e.cert,this.ca=e.ca,this.ciphers=e.ciphers,this.rejectUnauthorized=e.rejectUnauthorized,this.extraHeaders=e.extraHeaders,this.create()}function s(){for(var e in o.requests)o.requests.hasOwnProperty(e)&&o.requests[e].abort()}var r=n(19),c=n(22),l=n(11),h=n(33),d=n(3)("engine.io-client:polling-xhr");if(e.exports=a,e.exports.Request=o,h(a,c),a.prototype.supportsBinary=!0,a.prototype.request=function(e){return(e=e||{}).uri=this.uri(),e.xd=this.xd,e.xs=this.xs,e.agent=this.agent||!1,e.supportsBinary=this.supportsBinary,e.enablesXDR=this.enablesXDR,e.withCredentials=this.withCredentials,e.pfx=this.pfx,e.key=this.key,e.passphrase=this.passphrase,e.cert=this.cert,e.ca=this.ca,e.ciphers=this.ciphers,e.rejectUnauthorized=this.rejectUnauthorized,e.requestTimeout=this.requestTimeout,e.extraHeaders=this.extraHeaders,new o(e)},a.prototype.doWrite=function(e,t){var n="string"!=typeof e&&void 0!==e,i=this.request({method:"POST",data:e,isBinary:n}),a=this;i.on("success",t),i.on("error",(function(e){a.onError("xhr post error",e)})),this.sendXhr=i},a.prototype.doPoll=function(){d("xhr poll");var e=this.request(),t=this;e.on("data",(function(e){t.onData(e)})),e.on("error",(function(e){t.onError("xhr poll error",e)})),this.pollXhr=e},l(o.prototype),o.prototype.create=function(){var e={agent:this.agent,xdomain:this.xd,xscheme:this.xs,enablesXDR:this.enablesXDR};e.pfx=this.pfx,e.key=this.key,e.passphrase=this.passphrase,e.cert=this.cert,e.ca=this.ca,e.ciphers=this.ciphers,e.rejectUnauthorized=this.rejectUnauthorized;var t=this.xhr=new r(e),n=this;try{d("xhr open %s: %s",this.method,this.uri),t.open(this.method,this.uri,this.async);try{if(this.extraHeaders)for(var i in t.setDisableHeaderCheck&&t.setDisableHeaderCheck(!0),this.extraHeaders)this.extraHeaders.hasOwnProperty(i)&&t.setRequestHeader(i,this.extraHeaders[i])}catch(e){}if("POST"===this.method)try{this.isBinary?t.setRequestHeader("Content-type","application/octet-stream"):t.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(e){}try{t.setRequestHeader("Accept","*/*")}catch(e){}"withCredentials"in t&&(t.withCredentials=this.withCredentials),this.requestTimeout&&(t.timeout=this.requestTimeout),this.hasXDR()?(t.onload=function(){n.onLoad()},t.onerror=function(){n.onError(t.responseText)}):t.onreadystatechange=function(){if(2===t.readyState)try{var e=t.getResponseHeader("Content-Type");(n.supportsBinary&&"application/octet-stream"===e||"application/octet-stream; charset=UTF-8"===e)&&(t.responseType="arraybuffer")}catch(e){}4===t.readyState&&(200===t.status||1223===t.status?n.onLoad():setTimeout((function(){n.onError("number"==typeof t.status?t.status:0)}),0))},d("xhr data %s",this.data),t.send(this.data)}catch(e){return void setTimeout((function(){n.onError(e)}),0)}"undefined"!=typeof document&&(this.index=o.requestsCount++,o.requests[this.index]=this)},o.prototype.onSuccess=function(){this.emit("success"),this.cleanup()},o.prototype.onData=function(e){this.emit("data",e),this.onSuccess()},o.prototype.onError=function(e){this.emit("error",e),this.cleanup(!0)},o.prototype.cleanup=function(e){if(void 0!==this.xhr&&null!==this.xhr){if(this.hasXDR()?this.xhr.onload=this.xhr.onerror=i:this.xhr.onreadystatechange=i,e)try{this.xhr.abort()}catch(e){}"undefined"!=typeof document&&delete o.requests[this.index],this.xhr=null}},o.prototype.onLoad=function(){var e;try{var t;try{t=this.xhr.getResponseHeader("Content-Type")}catch(e){}e=("application/octet-stream"===t||"application/octet-stream; charset=UTF-8"===t)&&this.xhr.response||this.xhr.responseText}catch(e){this.onError(e)}null!=e&&this.onData(e)},o.prototype.hasXDR=function(){return"undefined"!=typeof XDomainRequest&&!this.xs&&this.enablesXDR},o.prototype.abort=function(){this.cleanup()},o.requestsCount=0,o.requests={},"undefined"!=typeof document)if("function"==typeof attachEvent)attachEvent("onunload",s);else if("function"==typeof addEventListener){var u="onpagehide"in self?"pagehide":"unload";addEventListener(u,s,!1)}},function(e,t,n){function i(e){var t=e&&e.forceBase64;h&&!t||(this.supportsBinary=!1),a.call(this,e)}var a=n(23),o=n(32),s=n(24),r=n(33),c=n(34),l=n(3)("engine.io-client:polling");e.exports=i;var h=null!=new(n(19))({xdomain:!1}).responseType;r(i,a),i.prototype.name="polling",i.prototype.doOpen=function(){this.poll()},i.prototype.pause=function(e){function t(){l("paused"),n.readyState="paused",e()}var n=this;if(this.readyState="pausing",this.polling||!this.writable){var i=0;this.polling&&(l("we are currently polling - waiting to pause"),i++,this.once("pollComplete",(function(){l("pre-pause polling complete"),--i||t()}))),this.writable||(l("we are currently writing - waiting to pause"),i++,this.once("drain",(function(){l("pre-pause writing complete"),--i||t()})))}else t()},i.prototype.poll=function(){l("polling"),this.polling=!0,this.doPoll(),this.emit("poll")},i.prototype.onData=function(e){var t=this;l("polling got data %s",e),s.decodePayload(e,this.socket.binaryType,(function(e,n,i){return"opening"===t.readyState&&t.onOpen(),"close"===e.type?(t.onClose(),!1):void t.onPacket(e)})),"closed"!==this.readyState&&(this.polling=!1,this.emit("pollComplete"),"open"===this.readyState?this.poll():l('ignoring poll - transport state "%s"',this.readyState))},i.prototype.doClose=function(){function e(){l("writing close packet"),t.write([{type:"close"}])}var t=this;"open"===this.readyState?(l("transport open - closing"),e()):(l("transport not open - deferring close"),this.once("open",e))},i.prototype.write=function(e){var t=this;this.writable=!1;var n=function(){t.writable=!0,t.emit("drain")};s.encodePayload(e,this.supportsBinary,(function(e){t.doWrite(e,n)}))},i.prototype.uri=function(){var e=this.query||{},t=this.secure?"https":"http",n="";return!1!==this.timestampRequests&&(e[this.timestampParam]=c()),this.supportsBinary||e.sid||(e.b64=1),e=o.encode(e),this.port&&("https"===t&&443!==Number(this.port)||"http"===t&&80!==Number(this.port))&&(n=":"+this.port),e.length&&(e="?"+e),t+"://"+(-1!==this.hostname.indexOf(":")?"["+this.hostname+"]":this.hostname)+n+this.path+e}},function(e,t,n){function i(e){this.path=e.path,this.hostname=e.hostname,this.port=e.port,this.secure=e.secure,this.query=e.query,this.timestampParam=e.timestampParam,this.timestampRequests=e.timestampRequests,this.readyState="",this.agent=e.agent||!1,this.socket=e.socket,this.enablesXDR=e.enablesXDR,this.withCredentials=e.withCredentials,this.pfx=e.pfx,this.key=e.key,this.passphrase=e.passphrase,this.cert=e.cert,this.ca=e.ca,this.ciphers=e.ciphers,this.rejectUnauthorized=e.rejectUnauthorized,this.forceNode=e.forceNode,this.isReactNative=e.isReactNative,this.extraHeaders=e.extraHeaders,this.localAddress=e.localAddress}var a=n(24),o=n(11);e.exports=i,o(i.prototype),i.prototype.onError=function(e,t){var n=new Error(e);return n.type="TransportError",n.description=t,this.emit("error",n),this},i.prototype.open=function(){return"closed"!==this.readyState&&""!==this.readyState||(this.readyState="opening",this.doOpen()),this},i.prototype.close=function(){return"opening"!==this.readyState&&"open"!==this.readyState||(this.doClose(),this.onClose()),this},i.prototype.send=function(e){if("open"!==this.readyState)throw new Error("Transport not open");this.write(e)},i.prototype.onOpen=function(){this.readyState="open",this.writable=!0,this.emit("open")},i.prototype.onData=function(e){var t=a.decodePacket(e,this.socket.binaryType);this.onPacket(t)},i.prototype.onPacket=function(e){this.emit("packet",e)},i.prototype.onClose=function(){this.readyState="closed",this.emit("close")}},function(e,t,n){function i(e,n){return n("b"+t.packets[e.type]+e.data.data)}function a(e,n,i){if(!n)return t.encodeBase64Packet(e,i);var a=e.data,o=new Uint8Array(a),s=new Uint8Array(1+a.byteLength);s[0]=m[e.type];for(var r=0;r<o.length;r++)s[r+1]=o[r];return i(s.buffer)}function o(e,n,i){if(!n)return t.encodeBase64Packet(e,i);if(g)return function(e,n,i){if(!n)return t.encodeBase64Packet(e,i);var a=new FileReader;return a.onload=function(){t.encodePacket({type:e.type,data:a.result},n,!0,i)},a.readAsArrayBuffer(e.data)}(e,n,i);var a=new Uint8Array(1);return a[0]=m[e.type],i(new y([a.buffer,e.data]))}function s(e,t,n){for(var i=new Array(e.length),a=d(e.length,n),o=function(e,n,a){t(n,(function(t,n){i[e]=n,a(t,i)}))},s=0;s<e.length;s++)o(s,e[s],a)}var r,c=n(25),l=n(26),h=n(27),d=n(28),u=n(29);"undefined"!=typeof ArrayBuffer&&(r=n(30));var f="undefined"!=typeof navigator&&/Android/i.test(navigator.userAgent),p="undefined"!=typeof navigator&&/PhantomJS/i.test(navigator.userAgent),g=f||p;t.protocol=3;var m=t.packets={open:0,close:1,ping:2,pong:3,message:4,upgrade:5,noop:6},_=c(m),C={type:"error",data:"parser error"},y=n(31);t.encodePacket=function(e,t,n,s){"function"==typeof t&&(s=t,t=!1),"function"==typeof n&&(s=n,n=null);var r=void 0===e.data?void 0:e.data.buffer||e.data;if("undefined"!=typeof ArrayBuffer&&r instanceof ArrayBuffer)return a(e,t,s);if(void 0!==y&&r instanceof y)return o(e,t,s);if(r&&r.base64)return i(e,s);var c=m[e.type];return void 0!==e.data&&(c+=n?u.encode(String(e.data),{strict:!1}):String(e.data)),s(""+c)},t.encodeBase64Packet=function(e,n){var i,a="b"+t.packets[e.type];if(void 0!==y&&e.data instanceof y){var o=new FileReader;return o.onload=function(){var e=o.result.split(",")[1];n(a+e)},o.readAsDataURL(e.data)}try{i=String.fromCharCode.apply(null,new Uint8Array(e.data))}catch(t){for(var s=new Uint8Array(e.data),r=new Array(s.length),c=0;c<s.length;c++)r[c]=s[c];i=String.fromCharCode.apply(null,r)}return a+=btoa(i),n(a)},t.decodePacket=function(e,n,i){if(void 0===e)return C;if("string"==typeof e){if("b"===e.charAt(0))return t.decodeBase64Packet(e.substr(1),n);if(i&&!1===(e=function(e){try{e=u.decode(e,{strict:!1})}catch(e){return!1}return e}(e)))return C;var a=e.charAt(0);return Number(a)==a&&_[a]?e.length>1?{type:_[a],data:e.substring(1)}:{type:_[a]}:C}a=new Uint8Array(e)[0];var o=h(e,1);return y&&"blob"===n&&(o=new y([o])),{type:_[a],data:o}},t.decodeBase64Packet=function(e,t){var n=_[e.charAt(0)];if(!r)return{type:n,data:{base64:!0,data:e.substr(1)}};var i=r.decode(e.substr(1));return"blob"===t&&y&&(i=new y([i])),{type:n,data:i}},t.encodePayload=function(e,n,i){"function"==typeof n&&(i=n,n=null);var a=l(e);return n&&a?y&&!g?t.encodePayloadAsBlob(e,i):t.encodePayloadAsArrayBuffer(e,i):e.length?void s(e,(function(e,i){t.encodePacket(e,!!a&&n,!1,(function(e){i(null,function(e){return e.length+":"+e}(e))}))}),(function(e,t){return i(t.join(""))})):i("0:")},t.decodePayload=function(e,n,i){if("string"!=typeof e)return t.decodePayloadAsBinary(e,n,i);var a;if("function"==typeof n&&(i=n,n=null),""===e)return i(C,0,1);for(var o,s,r="",c=0,l=e.length;c<l;c++){var h=e.charAt(c);if(":"===h){if(""===r||r!=(o=Number(r)))return i(C,0,1);if(r!=(s=e.substr(c+1,o)).length)return i(C,0,1);if(s.length){if(a=t.decodePacket(s,n,!1),C.type===a.type&&C.data===a.data)return i(C,0,1);if(!1===i(a,c+o,l))return}c+=o,r=""}else r+=h}return""!==r?i(C,0,1):void 0},t.encodePayloadAsArrayBuffer=function(e,n){return e.length?void s(e,(function(e,n){t.encodePacket(e,!0,!0,(function(e){return n(null,e)}))}),(function(e,t){var i=t.reduce((function(e,t){var n;return e+(n="string"==typeof t?t.length:t.byteLength).toString().length+n+2}),0),a=new Uint8Array(i),o=0;return t.forEach((function(e){var t="string"==typeof e,n=e;if(t){for(var i=new Uint8Array(e.length),s=0;s<e.length;s++)i[s]=e.charCodeAt(s);n=i.buffer}a[o++]=t?0:1;var r=n.byteLength.toString();for(s=0;s<r.length;s++)a[o++]=parseInt(r[s]);for(a[o++]=255,i=new Uint8Array(n),s=0;s<i.length;s++)a[o++]=i[s]})),n(a.buffer)})):n(new ArrayBuffer(0))},t.encodePayloadAsBlob=function(e,n){s(e,(function(e,n){t.encodePacket(e,!0,!0,(function(e){var t=new Uint8Array(1);if(t[0]=1,"string"==typeof e){for(var i=new Uint8Array(e.length),a=0;a<e.length;a++)i[a]=e.charCodeAt(a);e=i.buffer,t[0]=0}var o=(e instanceof ArrayBuffer?e.byteLength:e.size).toString(),s=new Uint8Array(o.length+1);for(a=0;a<o.length;a++)s[a]=parseInt(o[a]);if(s[o.length]=255,y){var r=new y([t.buffer,s.buffer,e]);n(null,r)}}))}),(function(e,t){return n(new y(t))}))},t.decodePayloadAsBinary=function(e,n,i){"function"==typeof n&&(i=n,n=null);for(var a=e,o=[];a.byteLength>0;){for(var s=new Uint8Array(a),r=0===s[0],c="",l=1;255!==s[l];l++){if(c.length>310)return i(C,0,1);c+=s[l]}a=h(a,2+c.length),c=parseInt(c);var d=h(a,0,c);if(r)try{d=String.fromCharCode.apply(null,new Uint8Array(d))}catch(e){var u=new Uint8Array(d);for(d="",l=0;l<u.length;l++)d+=String.fromCharCode(u[l])}o.push(d),a=h(a,c)}var f=o.length;o.forEach((function(e,a){i(t.decodePacket(e,n,!0),a,f)}))}},function(e,t){e.exports=Object.keys||function(e){var t=[],n=Object.prototype.hasOwnProperty;for(var i in e)n.call(e,i)&&t.push(i);return t}},function(e,t,n){var i=n(13),a=Object.prototype.toString,o="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===a.call(Blob),s="function"==typeof File||"undefined"!=typeof File&&"[object FileConstructor]"===a.call(File);e.exports=function e(t){if(!t||"object"!=typeof t)return!1;if(i(t)){for(var n=0,a=t.length;n<a;n++)if(e(t[n]))return!0;return!1}if("function"==typeof Buffer&&Buffer.isBuffer&&Buffer.isBuffer(t)||"function"==typeof ArrayBuffer&&t instanceof ArrayBuffer||o&&t instanceof Blob||s&&t instanceof File)return!0;if(t.toJSON&&"function"==typeof t.toJSON&&1===arguments.length)return e(t.toJSON(),!0);for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)&&e(t[r]))return!0;return!1}},function(e,t){e.exports=function(e,t,n){var i=e.byteLength;if(t=t||0,n=n||i,e.slice)return e.slice(t,n);if(t<0&&(t+=i),n<0&&(n+=i),n>i&&(n=i),t>=i||t>=n||0===i)return new ArrayBuffer(0);for(var a=new Uint8Array(e),o=new Uint8Array(n-t),s=t,r=0;s<n;s++,r++)o[r]=a[s];return o.buffer}},function(e,t){function n(){}e.exports=function(e,t,i){function a(e,n){if(a.count<=0)throw new Error("after called too many times");--a.count,e?(o=!0,t(e),t=i):0!==a.count||o||t(null,n)}var o=!1;return i=i||n,a.count=e,0===e?t():a}},function(e,t){function n(e){for(var t,n,i=[],a=0,o=e.length;a<o;)(t=e.charCodeAt(a++))>=55296&&t<=56319&&a<o?56320==(64512&(n=e.charCodeAt(a++)))?i.push(((1023&t)<<10)+(1023&n)+65536):(i.push(t),a--):i.push(t);return i}function i(e,t){if(e>=55296&&e<=57343){if(t)throw Error("Lone surrogate U+"+e.toString(16).toUpperCase()+" is not a scalar value");return!1}return!0}function a(e,t){return d(e>>t&63|128)}function o(e,t){if(0==(4294967168&e))return d(e);var n="";return 0==(4294965248&e)?n=d(e>>6&31|192):0==(4294901760&e)?(i(e,t)||(e=65533),n=d(e>>12&15|224),n+=a(e,6)):0==(4292870144&e)&&(n=d(e>>18&7|240),n+=a(e,12),n+=a(e,6)),n+d(63&e|128)}function s(){if(h>=l)throw Error("Invalid byte index");var e=255&c[h];if(h++,128==(192&e))return 63&e;throw Error("Invalid continuation byte")}function r(e){var t,n;if(h>l)throw Error("Invalid byte index");if(h==l)return!1;if(t=255&c[h],h++,0==(128&t))return t;if(192==(224&t)){if((n=(31&t)<<6|s())>=128)return n;throw Error("Invalid continuation byte")}if(224==(240&t)){if((n=(15&t)<<12|s()<<6|s())>=2048)return i(n,e)?n:65533;throw Error("Invalid continuation byte")}if(240==(248&t)&&(n=(7&t)<<18|s()<<12|s()<<6|s())>=65536&&n<=1114111)return n;throw Error("Invalid UTF-8 detected")}/*! https://mths.be/utf8js v2.1.2 by @mathias */
var c,l,h,d=String.fromCharCode;e.exports={version:"2.1.2",encode:function(e,t){for(var i=!1!==(t=t||{}).strict,a=n(e),s=a.length,r=-1,c="";++r<s;)c+=o(a[r],i);return c},decode:function(e,t){var i=!1!==(t=t||{}).strict;c=n(e),l=c.length,h=0;for(var a,o=[];!1!==(a=r(i));)o.push(a);return function(e){for(var t,n=e.length,i=-1,a="";++i<n;)(t=e[i])>65535&&(a+=d((t-=65536)>>>10&1023|55296),t=56320|1023&t),a+=d(t);return a}(o)}}},function(e,t){!function(){for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n=new Uint8Array(256),i=0;i<e.length;i++)n[e.charCodeAt(i)]=i;t.encode=function(t){var n,i=new Uint8Array(t),a=i.length,o="";for(n=0;n<a;n+=3)o+=e[i[n]>>2],o+=e[(3&i[n])<<4|i[n+1]>>4],o+=e[(15&i[n+1])<<2|i[n+2]>>6],o+=e[63&i[n+2]];return a%3==2?o=o.substring(0,o.length-1)+"=":a%3==1&&(o=o.substring(0,o.length-2)+"=="),o},t.decode=function(e){var t,i,a,o,s,r=.75*e.length,c=e.length,l=0;"="===e[e.length-1]&&(r--,"="===e[e.length-2]&&r--);var h=new ArrayBuffer(r),d=new Uint8Array(h);for(t=0;t<c;t+=4)i=n[e.charCodeAt(t)],a=n[e.charCodeAt(t+1)],o=n[e.charCodeAt(t+2)],s=n[e.charCodeAt(t+3)],d[l++]=i<<2|a>>4,d[l++]=(15&a)<<4|o>>2,d[l++]=(3&o)<<6|63&s;return h}}()},function(e,t){function n(e){return e.map((function(e){if(e.buffer instanceof ArrayBuffer){var t=e.buffer;if(e.byteLength!==t.byteLength){var n=new Uint8Array(e.byteLength);n.set(new Uint8Array(t,e.byteOffset,e.byteLength)),t=n.buffer}return t}return e}))}function i(e,t){t=t||{};var i=new o;return n(e).forEach((function(e){i.append(e)})),t.type?i.getBlob(t.type):i.getBlob()}function a(e,t){return new Blob(n(e),t||{})}var o=void 0!==o?o:"undefined"!=typeof WebKitBlobBuilder?WebKitBlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder&&MozBlobBuilder,s=function(){try{return 2===new Blob(["hi"]).size}catch(e){return!1}}(),r=s&&function(){try{return 2===new Blob([new Uint8Array([1,2])]).size}catch(e){return!1}}(),c=o&&o.prototype.append&&o.prototype.getBlob;"undefined"!=typeof Blob&&(i.prototype=Blob.prototype,a.prototype=Blob.prototype),e.exports=s?r?Blob:a:c?i:void 0},function(e,t){t.encode=function(e){var t="";for(var n in e)e.hasOwnProperty(n)&&(t.length&&(t+="&"),t+=encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return t},t.decode=function(e){for(var t={},n=e.split("&"),i=0,a=n.length;i<a;i++){var o=n[i].split("=");t[decodeURIComponent(o[0])]=decodeURIComponent(o[1])}return t}},function(e,t){e.exports=function(e,t){var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}},function(e,t){function n(e){var t="";do{t=o[e%s]+t,e=Math.floor(e/s)}while(e>0);return t}function i(){var e=n(+new Date);return e!==a?(c=0,a=e):e+"."+n(c++)}for(var a,o="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),s=64,r={},c=0,l=0;l<s;l++)r[o[l]]=l;i.encode=n,i.decode=function(e){var t=0;for(l=0;l<e.length;l++)t=t*s+r[e.charAt(l)];return t},e.exports=i},function(e,t,n){(function(t){function i(){}function a(){return"undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==t?t:{}}function o(e){if(s.call(this,e),this.query=this.query||{},!c){var t=a();c=t.___eio=t.___eio||[]}this.index=c.length;var n=this;c.push((function(e){n.onData(e)})),this.query.j=this.index,"function"==typeof addEventListener&&addEventListener("beforeunload",(function(){n.script&&(n.script.onerror=i)}),!1)}var s=n(22),r=n(33);e.exports=o;var c,l=/\n/g,h=/\\n/g;r(o,s),o.prototype.supportsBinary=!1,o.prototype.doClose=function(){this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),this.form&&(this.form.parentNode.removeChild(this.form),this.form=null,this.iframe=null),s.prototype.doClose.call(this)},o.prototype.doPoll=function(){var e=this,t=document.createElement("script");this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),t.async=!0,t.src=this.uri(),t.onerror=function(t){e.onError("jsonp poll error",t)};var n=document.getElementsByTagName("script")[0];n?n.parentNode.insertBefore(t,n):(document.head||document.body).appendChild(t),this.script=t,"undefined"!=typeof navigator&&/gecko/i.test(navigator.userAgent)&&setTimeout((function(){var e=document.createElement("iframe");document.body.appendChild(e),document.body.removeChild(e)}),100)},o.prototype.doWrite=function(e,t){function n(){i(),t()}function i(){if(a.iframe)try{a.form.removeChild(a.iframe)}catch(e){a.onError("jsonp polling iframe removal error",e)}try{var e='<iframe src="javascript:0" name="'+a.iframeId+'">';o=document.createElement(e)}catch(e){(o=document.createElement("iframe")).name=a.iframeId,o.src="javascript:0"}o.id=a.iframeId,a.form.appendChild(o),a.iframe=o}var a=this;if(!this.form){var o,s=document.createElement("form"),r=document.createElement("textarea"),c=this.iframeId="eio_iframe_"+this.index;s.className="socketio",s.style.position="absolute",s.style.top="-1000px",s.style.left="-1000px",s.target=c,s.method="POST",s.setAttribute("accept-charset","utf-8"),r.name="d",s.appendChild(r),document.body.appendChild(s),this.form=s,this.area=r}this.form.action=this.uri(),i(),e=e.replace(h,"\\\n"),this.area.value=e.replace(l,"\\n");try{this.form.submit()}catch(e){}this.iframe.attachEvent?this.iframe.onreadystatechange=function(){"complete"===a.iframe.readyState&&n()}:this.iframe.onload=n}}).call(t,function(){return this}())},function(e,t,n){function i(e){e&&e.forceBase64&&(this.supportsBinary=!1),this.perMessageDeflate=e.perMessageDeflate,this.usingBrowserWebSocket=a&&!e.forceNode,this.protocols=e.protocols,this.usingBrowserWebSocket||(u=o),s.call(this,e)}var a,o,s=n(23),r=n(24),c=n(32),l=n(33),h=n(34),d=n(3)("engine.io-client:websocket");if("undefined"!=typeof WebSocket?a=WebSocket:"undefined"!=typeof self&&(a=self.WebSocket||self.MozWebSocket),"undefined"==typeof window)try{o=n(37)}catch(e){}var u=a||o;e.exports=i,l(i,s),i.prototype.name="websocket",i.prototype.supportsBinary=!0,i.prototype.doOpen=function(){if(this.check()){var e=this.uri(),t=this.protocols,n={agent:this.agent,perMessageDeflate:this.perMessageDeflate};n.pfx=this.pfx,n.key=this.key,n.passphrase=this.passphrase,n.cert=this.cert,n.ca=this.ca,n.ciphers=this.ciphers,n.rejectUnauthorized=this.rejectUnauthorized,this.extraHeaders&&(n.headers=this.extraHeaders),this.localAddress&&(n.localAddress=this.localAddress);try{this.ws=this.usingBrowserWebSocket&&!this.isReactNative?t?new u(e,t):new u(e):new u(e,t,n)}catch(e){return this.emit("error",e)}void 0===this.ws.binaryType&&(this.supportsBinary=!1),this.ws.supports&&this.ws.supports.binary?(this.supportsBinary=!0,this.ws.binaryType="nodebuffer"):this.ws.binaryType="arraybuffer",this.addEventListeners()}},i.prototype.addEventListeners=function(){var e=this;this.ws.onopen=function(){e.onOpen()},this.ws.onclose=function(){e.onClose()},this.ws.onmessage=function(t){e.onData(t.data)},this.ws.onerror=function(t){e.onError("websocket error",t)}},i.prototype.write=function(e){var t=this;this.writable=!1;for(var n=e.length,i=0,a=n;i<a;i++)!function(e){r.encodePacket(e,t.supportsBinary,(function(i){if(!t.usingBrowserWebSocket){var a={};e.options&&(a.compress=e.options.compress),t.perMessageDeflate&&("string"==typeof i?Buffer.byteLength(i):i.length)<t.perMessageDeflate.threshold&&(a.compress=!1)}try{t.usingBrowserWebSocket?t.ws.send(i):t.ws.send(i,a)}catch(e){d("websocket closed before onclose event")}--n||(t.emit("flush"),setTimeout((function(){t.writable=!0,t.emit("drain")}),0))}))}(e[i])},i.prototype.onClose=function(){s.prototype.onClose.call(this)},i.prototype.doClose=function(){void 0!==this.ws&&this.ws.close()},i.prototype.uri=function(){var e=this.query||{},t=this.secure?"wss":"ws",n="";return this.port&&("wss"===t&&443!==Number(this.port)||"ws"===t&&80!==Number(this.port))&&(n=":"+this.port),this.timestampRequests&&(e[this.timestampParam]=h()),this.supportsBinary||(e.b64=1),(e=c.encode(e)).length&&(e="?"+e),t+"://"+(-1!==this.hostname.indexOf(":")?"["+this.hostname+"]":this.hostname)+n+this.path+e},i.prototype.check=function(){return!(!u||"__initialize"in u&&this.name===i.prototype.name)}},function(e,t){},function(e,t){var n=[].indexOf;e.exports=function(e,t){if(n)return e.indexOf(t);for(var i=0;i<e.length;++i)if(e[i]===t)return i;return-1}},function(e,t,n){function i(e,t,n){this.io=e,this.nsp=t,this.json=this,this.ids=0,this.acks={},this.receiveBuffer=[],this.sendBuffer=[],this.connected=!1,this.disconnected=!0,this.flags={},n&&n.query&&(this.query=n.query),this.io.autoConnect&&this.open()}var a=n(7),o=n(11),s=n(40),r=n(41),c=n(42),l=n(3)("socket.io-client:socket"),h=n(32),d=n(26);e.exports=i;var u={connect:1,connect_error:1,connect_timeout:1,connecting:1,disconnect:1,error:1,reconnect:1,reconnect_attempt:1,reconnect_failed:1,reconnect_error:1,reconnecting:1,ping:1,pong:1},f=o.prototype.emit;o(i.prototype),i.prototype.subEvents=function(){if(!this.subs){var e=this.io;this.subs=[r(e,"open",c(this,"onopen")),r(e,"packet",c(this,"onpacket")),r(e,"close",c(this,"onclose"))]}},i.prototype.open=i.prototype.connect=function(){return this.connected||(this.subEvents(),this.io.open(),"open"===this.io.readyState&&this.onopen(),this.emit("connecting")),this},i.prototype.send=function(){var e=s(arguments);return e.unshift("message"),this.emit.apply(this,e),this},i.prototype.emit=function(e){if(u.hasOwnProperty(e))return f.apply(this,arguments),this;var t=s(arguments),n={type:(void 0!==this.flags.binary?this.flags.binary:d(t))?a.BINARY_EVENT:a.EVENT,data:t,options:{}};return n.options.compress=!this.flags||!1!==this.flags.compress,"function"==typeof t[t.length-1]&&(l("emitting packet with ack id %d",this.ids),this.acks[this.ids]=t.pop(),n.id=this.ids++),this.connected?this.packet(n):this.sendBuffer.push(n),this.flags={},this},i.prototype.packet=function(e){e.nsp=this.nsp,this.io.packet(e)},i.prototype.onopen=function(){if(l("transport is open - connecting"),"/"!==this.nsp)if(this.query){var e="object"==typeof this.query?h.encode(this.query):this.query;l("sending connect packet with query %s",e),this.packet({type:a.CONNECT,query:e})}else this.packet({type:a.CONNECT})},i.prototype.onclose=function(e){l("close (%s)",e),this.connected=!1,this.disconnected=!0,delete this.id,this.emit("disconnect",e)},i.prototype.onpacket=function(e){var t=e.nsp===this.nsp,n=e.type===a.ERROR&&"/"===e.nsp;if(t||n)switch(e.type){case a.CONNECT:this.onconnect();break;case a.EVENT:case a.BINARY_EVENT:this.onevent(e);break;case a.ACK:case a.BINARY_ACK:this.onack(e);break;case a.DISCONNECT:this.ondisconnect();break;case a.ERROR:this.emit("error",e.data)}},i.prototype.onevent=function(e){var t=e.data||[];l("emitting event %j",t),null!=e.id&&(l("attaching ack callback to event"),t.push(this.ack(e.id))),this.connected?f.apply(this,t):this.receiveBuffer.push(t)},i.prototype.ack=function(e){var t=this,n=!1;return function(){if(!n){n=!0;var i=s(arguments);l("sending ack %j",i),t.packet({type:d(i)?a.BINARY_ACK:a.ACK,id:e,data:i})}}},i.prototype.onack=function(e){var t=this.acks[e.id];"function"==typeof t?(l("calling ack %s with %j",e.id,e.data),t.apply(this,e.data),delete this.acks[e.id]):l("bad ack %s",e.id)},i.prototype.onconnect=function(){this.connected=!0,this.disconnected=!1,this.emit("connect"),this.emitBuffered()},i.prototype.emitBuffered=function(){var e;for(e=0;e<this.receiveBuffer.length;e++)f.apply(this,this.receiveBuffer[e]);for(this.receiveBuffer=[],e=0;e<this.sendBuffer.length;e++)this.packet(this.sendBuffer[e]);this.sendBuffer=[]},i.prototype.ondisconnect=function(){l("server disconnect (%s)",this.nsp),this.destroy(),this.onclose("io server disconnect")},i.prototype.destroy=function(){if(this.subs){for(var e=0;e<this.subs.length;e++)this.subs[e].destroy();this.subs=null}this.io.destroy(this)},i.prototype.close=i.prototype.disconnect=function(){return this.connected&&(l("performing disconnect (%s)",this.nsp),this.packet({type:a.DISCONNECT})),this.destroy(),this.connected&&this.onclose("io client disconnect"),this},i.prototype.compress=function(e){return this.flags.compress=e,this},i.prototype.binary=function(e){return this.flags.binary=e,this}},function(e,t){e.exports=function(e,t){for(var n=[],i=(t=t||0)||0;i<e.length;i++)n[i-t]=e[i];return n}},function(e,t){e.exports=function(e,t,n){return e.on(t,n),{destroy:function(){e.removeListener(t,n)}}}},function(e,t){var n=[].slice;e.exports=function(e,t){if("string"==typeof t&&(t=e[t]),"function"!=typeof t)throw new Error("bind() requires a function");var i=n.call(arguments,2);return function(){return t.apply(e,i.concat(n.call(arguments)))}}},function(e,t){function n(e){e=e||{},this.ms=e.min||100,this.max=e.max||1e4,this.factor=e.factor||2,this.jitter=e.jitter>0&&e.jitter<=1?e.jitter:0,this.attempts=0}e.exports=n,n.prototype.duration=function(){var e=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),n=Math.floor(t*this.jitter*e);e=0==(1&Math.floor(10*t))?e-n:e+n}return 0|Math.min(e,this.max)},n.prototype.reset=function(){this.attempts=0},n.prototype.setMin=function(e){this.ms=e},n.prototype.setMax=function(e){this.max=e},n.prototype.setJitter=function(e){this.jitter=e}}])}));class StartPage{init(e,t,n){this.configStartPage=t.startPage?t.startPage:LadiChat_Config.defaultStartPageConfig,this.storeConfig=t;const i=this.generateHTMLContent();this.token=e,this.doom_element=i,this.socket=n,this.name=LadiChat_Config.SCREEN_NAME.SURVEY}async createConversation(){if(this.storeConfig.user_info.is_complete_survey||!this.configStartPage.survey_enable||0==this.configStartPage.survey_data.length)return void LadiChat.showConversationPage();const e=this.mainDocument.getElementsByClassName("survey-field"),t={};let n=!0;const i=this.mainDocument.getElementById("survey-title-error");for(let a of e){let e=!0;if(""!=a.value&&"email"==a.name&&(e=LadiChat_Helper.validateEmail(a.value),i.innerText="Email chưa đúng định dạng."),""!=a.value&&"phone"==a.name&&(e=LadiChat_Helper.validPhone(a.value),i.innerText="Số điện thoại chưa đúng định dạng."),""==a.value&&"name"==a.name&&(e=!1,i.innerText="Tên không được để trống"),this.configStartPage.survey_require){if(!e){n=!1,a.classList.add("error"),i&&(i.style.display="block");break}a.classList.remove("error"),t[a.name]=a.value}else{if(""!=a.value&&(n=e),!e){a.classList.add("error"),i&&(i.style.display="block");break}a.classList.remove("error"),i.innerText="",i.style.display="none",t[a.name]=a.value}}if(n){const e={"content-type":"application/json","session-key":this.token},n=await LadiChat_Helper.sendPOSTRequest(LadiChat_Static_Config.END_POINT,LadiChat_Config.API_ROUTE.SEND_SURVEY_DATA,t,e);if(200==n.code){let e=n.data;e.screen_name=LadiChat_Config.SCREEN_NAME.MESSENGER_PAGE,e=Object.assign(this.storeConfig.user_info,e),LadiChat_Helper.setCookie(LadiChat_Config.USER_INFO_COOKIE+LadiChat.storeID,JSON.stringify(e),30),LadiChat.showConversationStream()}}}addEvent(e){const t=this;this.mainDocument=e,this.mainDocument.getElementById("button-new-conversation").addEventListener("click",(function(){t.createConversation()}))}generateHeader(){const e=this.configStartPage.logo_img?this.configStartPage.logo_img:LadiChat_Config.defaultLogo;let t="";this.storeConfig.user_info.name?t=`<p>Xin chào ${LadiChat_Helper.capitalize(this.storeConfig.user_info.name)}</p>`:this.storeConfig.user_info.email&&(t=`<p>Xin chào ${LadiChat_Helper.capitalize(this.storeConfig.user_info.email)}</p>`);const n=`<div class="header-welcome">\n        <div class="logo"><img src=${e} ></div>\n        <div class="intro-text">\n            ${t}<p>${this.configStartPage.introduce_text}</p></div>\n                </div>`,i=document.createElement("div");return i.innerHTML=n.trim(),i.firstChild}generateExtraContent(e){const t=document.createElement("div");t.setAttribute("class","module-border-wrap");const n=document.createElement("div");n.setAttribute("class","content-item");const i=document.createElement("div");i.setAttribute("class","item-title"),i.innerText=e.title;const a=document.createElement("div");return a.setAttribute("class","item-article"),a.innerHTML=e.content,n.appendChild(i),n.appendChild(a),t.appendChild(n),t}generateHTMLContent(){const e=this,t=document.createElement("div");t.setAttribute("class","ladichat-startpage");const n=this.generateHeader();t.appendChild(n);const i=document.createElement("div");if(i.setAttribute("class","ladichat-startpage-body"),this.configStartPage.article_enable&&this.configStartPage.list_article.length>0){const t=document.createElement("div");t.setAttribute("class","extra-content"),this.configStartPage.list_article.forEach((function(n){const i=e.generateExtraContent(n);t.appendChild(i)})),i.appendChild(t)}if(this.configStartPage.survey_enable&&!this.storeConfig.user_info.is_complete_survey){const e=document.createElement("div");e.setAttribute("class","survey-form");const t=document.createElement("p");t.setAttribute("class","survey-title"),t.innerText=this.configStartPage.survey_title,e.appendChild(t);const n=this.configStartPage.survey_data;for(var a in n)if(n.hasOwnProperty(a)){var o=n[a];if(o.is_selected){const t=document.createElement("input");t.setAttribute("class","ladichat-input-field survey-field"),t.setAttribute("id","survey-field-"+a),t.setAttribute("name",a),t.setAttribute("placeholder",o.place_holder),"phone"==name&&t.setAttribute("type","number"),e.appendChild(t)}}const s=document.createElement("p");s.setAttribute("class","survey-title error"),s.setAttribute("id","survey-title-error"),s.setAttribute("style","display: none"),this.configStartPage.survey_require&&(s.innerText=this.configStartPage.survey_uncompleted_msg||"Hãy điền đủ thông tin để tiếp tục"),e.appendChild(s),i.appendChild(e)}return this.btnNewConversation=document.createElement("span"),this.btnNewConversation.innerText=this.configStartPage.button_start_conversation||"Bắt đầu chat",this.btnNewConversation.setAttribute("class","button-new-conversation noselect"),this.btnNewConversation.setAttribute("id","button-new-conversation"),i.appendChild(this.btnNewConversation),this.btnNewConversation.addEventListener("click",(function(){e.createConversation()})),t.appendChild(i),t}}function StaticConfig(){this.END_POINT="https://api.ladichat.com",this.CSS_URL="https://w.ladicdn.com/ladichat/app-style.css",this.UPLOAD_ENDPOINT="https://api.files.ladicdn.com/2.0/file/user-upload"}